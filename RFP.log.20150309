2015-03-09 14:00:21,961 [ INFO] (DVRSmain.java:947) - Logger Load Success!
2015-03-09 14:00:22,025 [ INFO] (DVRSmain.java:964) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 14:00:22,574 [ INFO] (DVRSmain.java:2853) - RFP Program Start! Mon Mar 09 14:00:22 CST 2015
2015-03-09 14:00:22,574 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:00:24,734 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:00:24,734 [ INFO] (DVRSmain.java:1018) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 14:00:24,734 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:00:25,579 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:00:25,579 [ INFO] (DVRSmain.java:1059) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 14:00:25,579 [DEBUG] (DVRSmain.java:2861) - connect success!
2015-03-09 14:00:25,579 [ INFO] (DVRSmain.java:1125) - cancelAutoCommit...
2015-03-09 14:00:25,579 [ INFO] (DVRSmain.java:1127) - set AutoCommit false!
2015-03-09 14:00:25,595 [ INFO] (DVRSmain.java:138) - setMonthDate...
2015-03-09 14:00:25,626 [ INFO] (DVRSmain.java:844) - setIMSItoServiceIDMap...
2015-03-09 14:00:25,641 [ INFO] (DVRSmain.java:888) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 14:01:46,842 [ INFO] (DVRSmain.java:2874) - setIMSItoServiceIDMap execute time :81216
2015-03-09 14:01:46,842 [ INFO] (DVRSmain.java:183) - setLastFileID...
2015-03-09 14:01:46,850 [DEBUG] (DVRSmain.java:189) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 14:01:46,897 [ INFO] (DVRSmain.java:195) - Last process file ID :14333
2015-03-09 14:01:46,913 [ INFO] (DVRSmain.java:2879) - setLastFileID execute time :71
2015-03-09 14:01:46,913 [ INFO] (DVRSmain.java:218) - setCurrentMap...
2015-03-09 14:01:46,913 [DEBUG] (DVRSmain.java:227) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 14:01:46,944 [DEBUG] (DVRSmain.java:229) - Set current map...
2015-03-09 14:01:46,960 [ INFO] (DVRSmain.java:282) - setoldChargeMap...
2015-03-09 14:01:46,960 [ INFO] (DVRSmain.java:331) - setCurrentMapDay...
2015-03-09 14:01:46,960 [DEBUG] (DVRSmain.java:337) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 14:01:47,007 [ INFO] (DVRSmain.java:2886) - setCurrentMap execute time :94
2015-03-09 14:01:47,007 [ INFO] (DVRSmain.java:457) - setThreshold...
2015-03-09 14:01:47,007 [DEBUG] (DVRSmain.java:464) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 14:01:47,038 [DEBUG] (DVRSmain.java:467) - Set dataRate map...
2015-03-09 14:01:47,147 [ INFO] (DVRSmain.java:2891) - setThreshold execute time :140
2015-03-09 14:01:47,147 [ INFO] (DVRSmain.java:406) - setDataRate...
2015-03-09 14:01:47,163 [DEBUG] (DVRSmain.java:413) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 14:01:47,178 [DEBUG] (DVRSmain.java:416) - Set dataRate map...
2015-03-09 14:01:48,303 [ INFO] (DVRSmain.java:2896) - setDataRate execute time :1156
2015-03-09 14:01:48,303 [ INFO] (DVRSmain.java:785) - setMsisdnMap...
2015-03-09 14:01:48,304 [ INFO] (DVRSmain.java:808) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 14:02:11,877 [ INFO] (DVRSmain.java:2901) - setMsisdnMap execute time :23574
2015-03-09 14:02:11,893 [DEBUG] (DVRSmain.java:747) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 14:02:11,956 [ INFO] (DVRSmain.java:2907) - setIPtoMccmncList execute time :79
2015-03-09 14:02:11,956 [ INFO] (DVRSmain.java:490) - setSERVICEIDtoVLN...
2015-03-09 14:02:11,972 [DEBUG] (DVRSmain.java:498) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 14:02:23,618 [ INFO] (DVRSmain.java:2912) - setSERVICEIDtoVLN execute time :11662
2015-03-09 14:02:23,618 [ INFO] (DVRSmain.java:526) - setVLNtoTADIG...
2015-03-09 14:02:23,619 [DEBUG] (DVRSmain.java:534) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 14:02:26,604 [ INFO] (DVRSmain.java:2917) - setVLNtoTADIG execute time :2986
2015-03-09 14:02:26,604 [ INFO] (DVRSmain.java:560) - setTADIGtoMCCMNC...
2015-03-09 14:02:26,619 [DEBUG] (DVRSmain.java:567) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 14:02:26,901 [ INFO] (DVRSmain.java:2922) - setTADIGtoMCCMNC execute time :297
2015-03-09 14:02:26,901 [ INFO] (DVRSmain.java:593) - setCostomerNumber...
2015-03-09 14:02:26,917 [DEBUG] (DVRSmain.java:600) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 14:02:26,948 [ INFO] (DVRSmain.java:2927) - setCostomerNumber execute time :47
2015-03-09 14:02:26,948 [ INFO] (DVRSmain.java:703) - setAddonData...
2015-03-09 14:02:26,995 [DEBUG] (DVRSmain.java:709) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 14:02:27,699 [ INFO] (DVRSmain.java:2932) - setAddonData execute time :751
2015-03-09 14:02:27,699 [ INFO] (DVRSmain.java:1236) - charge...
2015-03-09 14:02:27,699 [ INFO] (DVRSmain.java:627) - dataCount...
2015-03-09 14:02:27,763 [DEBUG] (DVRSmain.java:637) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 14:02:27,763 [ INFO] (DVRSmain.java:642) - usage count : 0
2015-03-09 14:02:27,763 [ INFO] (DVRSmain.java:663) - defaultRate...
2015-03-09 14:02:27,763 [ INFO] (DVRSmain.java:692) - defaultRate : 0.011 TWD 
2015-03-09 14:02:27,763 [ INFO] (DVRSmain.java:2937) - charge execute time :64
2015-03-09 14:02:27,763 [ INFO] (DVRSmain.java:1716) - sendAlertSMS...
2015-03-09 14:02:27,779 [DEBUG] (DVRSmain.java:1732) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 14:02:27,810 [ INFO] (DVRSmain.java:1740) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:02:27,810 [ INFO] (DVRSmain.java:1740) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:02:27,810 [ INFO] (DVRSmain.java:1740) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:02:27,810 [ INFO] (DVRSmain.java:1740) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:02:27,810 [ INFO] (DVRSmain.java:1740) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:02:27,810 [ INFO] (DVRSmain.java:1740) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:02:27,826 [DEBUG] (DVRSmain.java:1776) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 14:02:27,872 [DEBUG] (DVRSmain.java:1951) - Total send month alert0 ...
2015-03-09 14:02:27,872 [DEBUG] (DVRSmain.java:1952) - Log to table...executeBatch
2015-03-09 14:02:27,888 [DEBUG] (DVRSmain.java:2247) - Total send volume alert SMS 0 ...
2015-03-09 14:02:27,888 [ INFO] (DVRSmain.java:2942) - sendAlertSMS execute time :125
2015-03-09 14:02:27,904 [ INFO] (DVRSmain.java:1611) - insertCurrentMap...
2015-03-09 14:02:27,904 [ INFO] (DVRSmain.java:1620) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 14:02:27,904 [ INFO] (DVRSmain.java:1658) - insertCurrentMapDay...
2015-03-09 14:02:27,904 [ INFO] (DVRSmain.java:1666) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 14:02:27,904 [ INFO] (DVRSmain.java:1516) - updateCurrentMap...
2015-03-09 14:02:27,904 [ INFO] (DVRSmain.java:1527) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 14:02:27,904 [ INFO] (DVRSmain.java:1555) - Execute updateCurrentMap Batch
2015-03-09 14:02:27,950 [ INFO] (DVRSmain.java:1561) - updateCurrentMapDay...
2015-03-09 14:02:27,950 [ INFO] (DVRSmain.java:1571) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 14:02:27,966 [ INFO] (DVRSmain.java:1598) - Execute updateCurrentMapU Batch
2015-03-09 14:02:28,013 [ INFO] (DVRSmain.java:2968) - insert¡®update execute time :125
2015-03-09 14:02:28,013 [ INFO] (DVRSmain.java:2973) - processSuspendNBR execute time :0
2015-03-09 14:02:28,013 [ INFO] (DVRSmain.java:2978) - Program execute time :122434
2015-03-09 14:02:28,013 [ INFO] (DVRSmain.java:1089) - closeConnect1...
2015-03-09 14:02:28,028 [ INFO] (DVRSmain.java:1106) - closeConnect2...
2015-03-09 14:04:00,844 [ INFO] (DVRSmain.java:947) - Logger Load Success!
2015-03-09 14:04:00,844 [ INFO] (DVRSmain.java:964) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 14:04:01,001 [ INFO] (DVRSmain.java:2853) - RFP Program Start! Mon Mar 09 14:04:01 CST 2015
2015-03-09 14:04:01,001 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:04:01,609 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:04:01,609 [ INFO] (DVRSmain.java:1018) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 14:04:01,609 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:04:02,077 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:04:02,077 [ INFO] (DVRSmain.java:1059) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 14:04:02,077 [DEBUG] (DVRSmain.java:2861) - connect success!
2015-03-09 14:04:02,077 [ INFO] (DVRSmain.java:1125) - cancelAutoCommit...
2015-03-09 14:04:02,077 [ INFO] (DVRSmain.java:1127) - set AutoCommit false!
2015-03-09 14:04:02,078 [ INFO] (DVRSmain.java:138) - setMonthDate...
2015-03-09 14:04:02,109 [ INFO] (DVRSmain.java:844) - setIMSItoServiceIDMap...
2015-03-09 14:04:02,109 [ INFO] (DVRSmain.java:888) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 14:05:14,046 [ INFO] (DVRSmain.java:2874) - setIMSItoServiceIDMap execute time :71937
2015-03-09 14:05:14,062 [ INFO] (DVRSmain.java:183) - setLastFileID...
2015-03-09 14:05:14,062 [DEBUG] (DVRSmain.java:189) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 14:05:14,063 [ INFO] (DVRSmain.java:195) - Last process file ID :14333
2015-03-09 14:05:14,094 [ INFO] (DVRSmain.java:2879) - setLastFileID execute time :32
2015-03-09 14:05:14,094 [ INFO] (DVRSmain.java:218) - setCurrentMap...
2015-03-09 14:05:14,094 [DEBUG] (DVRSmain.java:227) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 14:05:14,125 [DEBUG] (DVRSmain.java:229) - Set current map...
2015-03-09 14:05:14,141 [ INFO] (DVRSmain.java:282) - setoldChargeMap...
2015-03-09 14:05:14,141 [ INFO] (DVRSmain.java:331) - setCurrentMapDay...
2015-03-09 14:05:14,141 [DEBUG] (DVRSmain.java:337) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 14:05:14,172 [ INFO] (DVRSmain.java:2886) - setCurrentMap execute time :78
2015-03-09 14:05:14,172 [ INFO] (DVRSmain.java:457) - setThreshold...
2015-03-09 14:05:14,172 [DEBUG] (DVRSmain.java:464) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 14:05:14,250 [DEBUG] (DVRSmain.java:467) - Set dataRate map...
2015-03-09 14:05:14,359 [ INFO] (DVRSmain.java:2891) - setThreshold execute time :187
2015-03-09 14:05:14,359 [ INFO] (DVRSmain.java:406) - setDataRate...
2015-03-09 14:05:14,359 [DEBUG] (DVRSmain.java:413) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 14:05:14,390 [DEBUG] (DVRSmain.java:416) - Set dataRate map...
2015-03-09 14:05:15,545 [ INFO] (DVRSmain.java:2896) - setDataRate execute time :1186
2015-03-09 14:05:15,545 [ INFO] (DVRSmain.java:785) - setMsisdnMap...
2015-03-09 14:05:15,545 [ INFO] (DVRSmain.java:808) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 14:07:49,300 [ INFO] (DVRSmain.java:974) - Logger Load Success!
2015-03-09 14:07:49,300 [ INFO] (DVRSmain.java:991) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 14:07:49,364 [ INFO] (DVRSmain.java:2880) - RFP Program Start! Mon Mar 09 14:07:49 CST 2015
2015-03-09 14:07:49,364 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:07:49,850 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:07:49,850 [ INFO] (DVRSmain.java:1045) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 14:07:49,850 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:07:50,302 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:07:50,302 [ INFO] (DVRSmain.java:1086) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 14:07:50,302 [DEBUG] (DVRSmain.java:2888) - connect success!
2015-03-09 14:07:50,302 [ INFO] (DVRSmain.java:1152) - cancelAutoCommit...
2015-03-09 14:07:50,302 [ INFO] (DVRSmain.java:1154) - set AutoCommit false!
2015-03-09 14:07:50,302 [ INFO] (DVRSmain.java:138) - setMonthDate...
2015-03-09 14:07:50,303 [ INFO] (DVRSmain.java:844) - setIMSItoServiceIDMap...
2015-03-09 14:07:50,303 [ INFO] (DVRSmain.java:870) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 14:08:55,259 [ INFO] (DVRSmain.java:2901) - setIMSItoServiceIDMap execute time :64956
2015-03-09 14:08:55,259 [ INFO] (DVRSmain.java:890) - setServiceIDtoImsiMap...
2015-03-09 14:08:55,275 [ INFO] (DVRSmain.java:916) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 14:09:48,164 [ INFO] (DVRSmain.java:2906) - setServiceIDtoImsiMap execute time :52905
2015-03-09 14:09:48,164 [ INFO] (DVRSmain.java:183) - setLastFileID...
2015-03-09 14:09:48,164 [DEBUG] (DVRSmain.java:189) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 14:09:48,211 [ INFO] (DVRSmain.java:195) - Last process file ID :14333
2015-03-09 14:09:48,211 [ INFO] (DVRSmain.java:2911) - setLastFileID execute time :47
2015-03-09 14:09:48,211 [ INFO] (DVRSmain.java:218) - setCurrentMap...
2015-03-09 14:09:48,211 [DEBUG] (DVRSmain.java:227) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 14:09:48,243 [DEBUG] (DVRSmain.java:229) - Set current map...
2015-03-09 14:09:48,258 [ INFO] (DVRSmain.java:282) - setoldChargeMap...
2015-03-09 14:09:48,258 [ INFO] (DVRSmain.java:331) - setCurrentMapDay...
2015-03-09 14:09:48,258 [DEBUG] (DVRSmain.java:337) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 14:09:48,289 [ INFO] (DVRSmain.java:2918) - setCurrentMap execute time :78
2015-03-09 14:09:48,305 [ INFO] (DVRSmain.java:457) - setThreshold...
2015-03-09 14:09:48,305 [DEBUG] (DVRSmain.java:464) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 14:09:48,321 [DEBUG] (DVRSmain.java:467) - Set dataRate map...
2015-03-09 14:09:48,414 [ INFO] (DVRSmain.java:2923) - setThreshold execute time :109
2015-03-09 14:09:48,414 [ INFO] (DVRSmain.java:406) - setDataRate...
2015-03-09 14:09:48,430 [DEBUG] (DVRSmain.java:413) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 14:09:48,445 [DEBUG] (DVRSmain.java:416) - Set dataRate map...
2015-03-09 14:09:49,507 [ INFO] (DVRSmain.java:2928) - setDataRate execute time :1093
2015-03-09 14:09:49,507 [ INFO] (DVRSmain.java:785) - setMsisdnMap...
2015-03-09 14:09:49,508 [ INFO] (DVRSmain.java:808) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 14:10:10,222 [ INFO] (DVRSmain.java:2933) - setMsisdnMap execute time :20715
2015-03-09 14:10:10,223 [DEBUG] (DVRSmain.java:747) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 14:10:10,285 [ INFO] (DVRSmain.java:2939) - setIPtoMccmncList execute time :63
2015-03-09 14:10:10,285 [ INFO] (DVRSmain.java:490) - setSERVICEIDtoVLN...
2015-03-09 14:10:10,285 [DEBUG] (DVRSmain.java:498) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 14:10:22,711 [ INFO] (DVRSmain.java:2944) - setSERVICEIDtoVLN execute time :12426
2015-03-09 14:10:22,711 [ INFO] (DVRSmain.java:526) - setVLNtoTADIG...
2015-03-09 14:10:22,711 [DEBUG] (DVRSmain.java:534) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 14:10:24,725 [ INFO] (DVRSmain.java:2949) - setVLNtoTADIG execute time :2014
2015-03-09 14:10:24,725 [ INFO] (DVRSmain.java:560) - setTADIGtoMCCMNC...
2015-03-09 14:10:24,725 [DEBUG] (DVRSmain.java:567) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 14:10:25,038 [ INFO] (DVRSmain.java:2954) - setTADIGtoMCCMNC execute time :313
2015-03-09 14:10:25,038 [ INFO] (DVRSmain.java:593) - setCostomerNumber...
2015-03-09 14:10:25,038 [DEBUG] (DVRSmain.java:600) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 14:10:25,085 [ INFO] (DVRSmain.java:2959) - setCostomerNumber execute time :47
2015-03-09 14:10:25,085 [ INFO] (DVRSmain.java:703) - setAddonData...
2015-03-09 14:10:25,085 [DEBUG] (DVRSmain.java:709) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 14:10:25,787 [ INFO] (DVRSmain.java:2964) - setAddonData execute time :702
2015-03-09 14:10:25,787 [ INFO] (DVRSmain.java:1263) - charge...
2015-03-09 14:10:25,787 [ INFO] (DVRSmain.java:627) - dataCount...
2015-03-09 14:10:25,850 [DEBUG] (DVRSmain.java:637) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 14:10:25,866 [ INFO] (DVRSmain.java:642) - usage count : 0
2015-03-09 14:10:25,866 [ INFO] (DVRSmain.java:663) - defaultRate...
2015-03-09 14:10:25,866 [ INFO] (DVRSmain.java:692) - defaultRate : 0.011 TWD 
2015-03-09 14:10:25,866 [ INFO] (DVRSmain.java:2969) - charge execute time :79
2015-03-09 14:10:25,866 [ INFO] (DVRSmain.java:1743) - sendAlertSMS...
2015-03-09 14:10:25,881 [DEBUG] (DVRSmain.java:1759) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 14:10:25,897 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:10:25,897 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:10:25,897 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:10:25,897 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:10:25,897 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:10:25,897 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:10:25,912 [DEBUG] (DVRSmain.java:1803) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 14:10:25,975 [DEBUG] (DVRSmain.java:1978) - Total send month alert0 ...
2015-03-09 14:10:25,975 [DEBUG] (DVRSmain.java:1979) - Log to table...executeBatch
2015-03-09 14:12:17,824 [ INFO] (DVRSmain.java:974) - Logger Load Success!
2015-03-09 14:12:17,824 [ INFO] (DVRSmain.java:991) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 14:12:17,934 [ INFO] (DVRSmain.java:2880) - RFP Program Start! Mon Mar 09 14:12:17 CST 2015
2015-03-09 14:12:17,934 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:12:18,433 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:12:18,433 [ INFO] (DVRSmain.java:1045) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 14:12:18,433 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:12:18,840 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:12:18,840 [ INFO] (DVRSmain.java:1086) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 14:12:18,840 [DEBUG] (DVRSmain.java:2888) - connect success!
2015-03-09 14:12:18,840 [ INFO] (DVRSmain.java:1152) - cancelAutoCommit...
2015-03-09 14:12:18,840 [ INFO] (DVRSmain.java:1154) - set AutoCommit false!
2015-03-09 14:12:18,840 [ INFO] (DVRSmain.java:138) - setMonthDate...
2015-03-09 14:12:18,840 [ INFO] (DVRSmain.java:844) - setIMSItoServiceIDMap...
2015-03-09 14:12:18,841 [ INFO] (DVRSmain.java:870) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 14:13:27,441 [ INFO] (DVRSmain.java:2901) - setIMSItoServiceIDMap execute time :68601
2015-03-09 14:13:27,441 [ INFO] (DVRSmain.java:890) - setServiceIDtoImsiMap...
2015-03-09 14:13:27,441 [ INFO] (DVRSmain.java:916) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 14:14:16,364 [ INFO] (DVRSmain.java:2906) - setServiceIDtoImsiMap execute time :48923
2015-03-09 14:14:16,364 [ INFO] (DVRSmain.java:183) - setLastFileID...
2015-03-09 14:14:16,365 [DEBUG] (DVRSmain.java:189) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 14:14:16,396 [ INFO] (DVRSmain.java:195) - Last process file ID :14333
2015-03-09 14:14:16,412 [ INFO] (DVRSmain.java:2911) - setLastFileID execute time :48
2015-03-09 14:14:16,412 [ INFO] (DVRSmain.java:218) - setCurrentMap...
2015-03-09 14:14:16,412 [DEBUG] (DVRSmain.java:227) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 14:14:16,443 [DEBUG] (DVRSmain.java:229) - Set current map...
2015-03-09 14:14:16,458 [ INFO] (DVRSmain.java:282) - setoldChargeMap...
2015-03-09 14:14:16,458 [ INFO] (DVRSmain.java:331) - setCurrentMapDay...
2015-03-09 14:14:16,458 [DEBUG] (DVRSmain.java:337) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 14:14:16,505 [ INFO] (DVRSmain.java:2918) - setCurrentMap execute time :93
2015-03-09 14:14:16,505 [ INFO] (DVRSmain.java:457) - setThreshold...
2015-03-09 14:14:16,521 [DEBUG] (DVRSmain.java:464) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 14:14:16,568 [DEBUG] (DVRSmain.java:467) - Set dataRate map...
2015-03-09 14:14:16,661 [ INFO] (DVRSmain.java:2923) - setThreshold execute time :156
2015-03-09 14:14:16,661 [ INFO] (DVRSmain.java:406) - setDataRate...
2015-03-09 14:14:16,677 [DEBUG] (DVRSmain.java:413) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 14:14:16,692 [DEBUG] (DVRSmain.java:416) - Set dataRate map...
2015-03-09 14:14:17,770 [ INFO] (DVRSmain.java:2928) - setDataRate execute time :1109
2015-03-09 14:14:17,770 [ INFO] (DVRSmain.java:785) - setMsisdnMap...
2015-03-09 14:14:17,770 [ INFO] (DVRSmain.java:808) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 14:14:48,826 [ INFO] (DVRSmain.java:2933) - setMsisdnMap execute time :31056
2015-03-09 14:14:48,827 [DEBUG] (DVRSmain.java:747) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 14:14:48,890 [ INFO] (DVRSmain.java:2939) - setIPtoMccmncList execute time :64
2015-03-09 14:14:48,890 [ INFO] (DVRSmain.java:490) - setSERVICEIDtoVLN...
2015-03-09 14:14:48,890 [DEBUG] (DVRSmain.java:498) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 14:14:59,924 [ INFO] (DVRSmain.java:2944) - setSERVICEIDtoVLN execute time :11034
2015-03-09 14:14:59,924 [ INFO] (DVRSmain.java:526) - setVLNtoTADIG...
2015-03-09 14:14:59,924 [DEBUG] (DVRSmain.java:534) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 14:15:02,062 [ INFO] (DVRSmain.java:2949) - setVLNtoTADIG execute time :2138
2015-03-09 14:15:02,062 [ INFO] (DVRSmain.java:560) - setTADIGtoMCCMNC...
2015-03-09 14:15:02,062 [DEBUG] (DVRSmain.java:567) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 14:15:02,375 [ INFO] (DVRSmain.java:2954) - setTADIGtoMCCMNC execute time :313
2015-03-09 14:15:02,375 [ INFO] (DVRSmain.java:593) - setCostomerNumber...
2015-03-09 14:15:02,390 [DEBUG] (DVRSmain.java:600) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 14:15:02,437 [ INFO] (DVRSmain.java:2959) - setCostomerNumber execute time :62
2015-03-09 14:15:02,437 [ INFO] (DVRSmain.java:703) - setAddonData...
2015-03-09 14:15:02,437 [DEBUG] (DVRSmain.java:709) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 14:15:03,186 [ INFO] (DVRSmain.java:2964) - setAddonData execute time :749
2015-03-09 14:15:03,186 [ INFO] (DVRSmain.java:1263) - charge...
2015-03-09 14:15:03,186 [ INFO] (DVRSmain.java:627) - dataCount...
2015-03-09 14:15:03,266 [DEBUG] (DVRSmain.java:637) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 14:15:03,266 [ INFO] (DVRSmain.java:642) - usage count : 0
2015-03-09 14:15:03,281 [ INFO] (DVRSmain.java:663) - defaultRate...
2015-03-09 14:15:03,281 [ INFO] (DVRSmain.java:692) - defaultRate : 0.011 TWD 
2015-03-09 14:15:03,281 [ INFO] (DVRSmain.java:2969) - charge execute time :95
2015-03-09 14:15:03,281 [ INFO] (DVRSmain.java:1743) - sendAlertSMS...
2015-03-09 14:15:03,281 [DEBUG] (DVRSmain.java:1759) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 14:15:03,297 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:15:03,297 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:15:03,313 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:15:03,313 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:15:03,313 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:15:03,313 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:15:03,328 [DEBUG] (DVRSmain.java:1803) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 14:15:03,375 [DEBUG] (DVRSmain.java:1978) - Total send month alert0 ...
2015-03-09 14:15:03,375 [DEBUG] (DVRSmain.java:1979) - Log to table...executeBatch
2015-03-09 14:15:30,322 [ERROR] (DVRSmain.java:2466) - Can't send email without receiver!
2015-03-09 14:15:30,322 [DEBUG] (DVRSmain.java:2194) - The serviceid:40705 can't find msisdn to send 102! 
2015-03-09 14:15:30,322 [DEBUG] (DVRSmain.java:2274) - Total send volume alert SMS 0 ...
2015-03-09 14:15:30,330 [ INFO] (DVRSmain.java:2974) - sendAlertSMS execute time :27049
2015-03-09 14:15:30,377 [ INFO] (DVRSmain.java:1638) - insertCurrentMap...
2015-03-09 14:15:30,377 [ INFO] (DVRSmain.java:1647) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 14:15:30,377 [ INFO] (DVRSmain.java:1685) - insertCurrentMapDay...
2015-03-09 14:15:30,377 [ INFO] (DVRSmain.java:1693) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 14:15:30,377 [ INFO] (DVRSmain.java:1543) - updateCurrentMap...
2015-03-09 14:15:30,377 [ INFO] (DVRSmain.java:1554) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 14:15:30,377 [ INFO] (DVRSmain.java:1582) - Execute updateCurrentMap Batch
2015-03-09 14:15:30,392 [ INFO] (DVRSmain.java:1588) - updateCurrentMapDay...
2015-03-09 14:15:30,392 [ INFO] (DVRSmain.java:1598) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 14:15:30,408 [ INFO] (DVRSmain.java:1625) - Execute updateCurrentMapU Batch
2015-03-09 14:15:30,439 [ INFO] (DVRSmain.java:3000) - insert¡®update execute time :109
2015-03-09 14:15:30,439 [ INFO] (DVRSmain.java:3005) - processSuspendNBR execute time :0
2015-03-09 14:15:30,439 [ INFO] (DVRSmain.java:3010) - Program execute time :191599
2015-03-09 14:15:30,439 [ INFO] (DVRSmain.java:1116) - closeConnect1...
2015-03-09 14:15:30,439 [ INFO] (DVRSmain.java:1133) - closeConnect2...
2015-03-09 14:16:43,532 [ INFO] (DVRSmain.java:974) - Logger Load Success!
2015-03-09 14:16:43,532 [ INFO] (DVRSmain.java:991) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 14:16:43,658 [ INFO] (DVRSmain.java:2881) - RFP Program Start! Mon Mar 09 14:16:43 CST 2015
2015-03-09 14:16:43,658 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:16:44,251 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:16:44,251 [ INFO] (DVRSmain.java:1045) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 14:16:44,251 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:16:44,750 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:16:44,750 [ INFO] (DVRSmain.java:1086) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 14:16:44,750 [DEBUG] (DVRSmain.java:2889) - connect success!
2015-03-09 14:16:44,750 [ INFO] (DVRSmain.java:1152) - cancelAutoCommit...
2015-03-09 14:16:44,750 [ INFO] (DVRSmain.java:1154) - set AutoCommit false!
2015-03-09 14:16:44,766 [ INFO] (DVRSmain.java:138) - setMonthDate...
2015-03-09 14:16:44,766 [ INFO] (DVRSmain.java:844) - setIMSItoServiceIDMap...
2015-03-09 14:16:44,766 [ INFO] (DVRSmain.java:870) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 14:17:52,680 [ INFO] (DVRSmain.java:2902) - setIMSItoServiceIDMap execute time :67914
2015-03-09 14:17:52,680 [ INFO] (DVRSmain.java:890) - setServiceIDtoImsiMap...
2015-03-09 14:17:52,681 [ INFO] (DVRSmain.java:916) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 14:18:41,813 [ INFO] (DVRSmain.java:2907) - setServiceIDtoImsiMap execute time :49133
2015-03-09 14:18:41,813 [ INFO] (DVRSmain.java:183) - setLastFileID...
2015-03-09 14:18:41,813 [DEBUG] (DVRSmain.java:189) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 14:18:41,845 [ INFO] (DVRSmain.java:195) - Last process file ID :14333
2015-03-09 14:18:41,845 [ INFO] (DVRSmain.java:2912) - setLastFileID execute time :32
2015-03-09 14:18:41,845 [ INFO] (DVRSmain.java:218) - setCurrentMap...
2015-03-09 14:18:41,845 [DEBUG] (DVRSmain.java:227) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 14:18:41,876 [DEBUG] (DVRSmain.java:229) - Set current map...
2015-03-09 14:18:41,892 [ INFO] (DVRSmain.java:282) - setoldChargeMap...
2015-03-09 14:18:41,892 [ INFO] (DVRSmain.java:331) - setCurrentMapDay...
2015-03-09 14:18:41,892 [DEBUG] (DVRSmain.java:337) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 14:18:41,923 [ INFO] (DVRSmain.java:2919) - setCurrentMap execute time :78
2015-03-09 14:18:41,923 [ INFO] (DVRSmain.java:457) - setThreshold...
2015-03-09 14:18:41,939 [DEBUG] (DVRSmain.java:464) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 14:18:41,970 [DEBUG] (DVRSmain.java:467) - Set dataRate map...
2015-03-09 14:18:42,064 [ INFO] (DVRSmain.java:2924) - setThreshold execute time :141
2015-03-09 14:18:42,064 [ INFO] (DVRSmain.java:406) - setDataRate...
2015-03-09 14:18:42,064 [DEBUG] (DVRSmain.java:413) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 14:18:42,095 [DEBUG] (DVRSmain.java:416) - Set dataRate map...
2015-03-09 14:18:43,190 [ INFO] (DVRSmain.java:2929) - setDataRate execute time :1126
2015-03-09 14:18:43,190 [ INFO] (DVRSmain.java:785) - setMsisdnMap...
2015-03-09 14:18:43,190 [ INFO] (DVRSmain.java:808) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 14:19:11,594 [ INFO] (DVRSmain.java:2934) - setMsisdnMap execute time :28404
2015-03-09 14:19:11,594 [DEBUG] (DVRSmain.java:747) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 14:19:11,642 [ INFO] (DVRSmain.java:2940) - setIPtoMccmncList execute time :48
2015-03-09 14:19:11,642 [ INFO] (DVRSmain.java:490) - setSERVICEIDtoVLN...
2015-03-09 14:19:11,658 [DEBUG] (DVRSmain.java:498) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 14:19:24,327 [ INFO] (DVRSmain.java:2945) - setSERVICEIDtoVLN execute time :12685
2015-03-09 14:19:24,327 [ INFO] (DVRSmain.java:526) - setVLNtoTADIG...
2015-03-09 14:19:24,328 [DEBUG] (DVRSmain.java:534) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 14:19:26,622 [ INFO] (DVRSmain.java:2950) - setVLNtoTADIG execute time :2295
2015-03-09 14:19:26,622 [ INFO] (DVRSmain.java:560) - setTADIGtoMCCMNC...
2015-03-09 14:19:26,623 [DEBUG] (DVRSmain.java:567) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 14:19:26,919 [ INFO] (DVRSmain.java:2955) - setTADIGtoMCCMNC execute time :297
2015-03-09 14:19:26,919 [ INFO] (DVRSmain.java:593) - setCostomerNumber...
2015-03-09 14:19:26,935 [DEBUG] (DVRSmain.java:600) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 14:19:26,966 [ INFO] (DVRSmain.java:2960) - setCostomerNumber execute time :47
2015-03-09 14:19:26,966 [ INFO] (DVRSmain.java:703) - setAddonData...
2015-03-09 14:19:26,966 [DEBUG] (DVRSmain.java:709) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 14:19:27,724 [ INFO] (DVRSmain.java:2965) - setAddonData execute time :758
2015-03-09 14:19:27,724 [ INFO] (DVRSmain.java:1263) - charge...
2015-03-09 14:19:27,724 [ INFO] (DVRSmain.java:627) - dataCount...
2015-03-09 14:19:27,815 [DEBUG] (DVRSmain.java:637) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 14:19:27,830 [ INFO] (DVRSmain.java:642) - usage count : 0
2015-03-09 14:19:27,830 [ INFO] (DVRSmain.java:663) - defaultRate...
2015-03-09 14:19:27,830 [ INFO] (DVRSmain.java:692) - defaultRate : 0.011 TWD 
2015-03-09 14:19:27,830 [ INFO] (DVRSmain.java:2970) - charge execute time :106
2015-03-09 14:19:27,830 [ INFO] (DVRSmain.java:1743) - sendAlertSMS...
2015-03-09 14:19:27,846 [DEBUG] (DVRSmain.java:1759) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 14:19:27,862 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:19:27,862 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:19:27,862 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:19:27,862 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:19:27,862 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:19:27,862 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:19:27,877 [DEBUG] (DVRSmain.java:1803) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 14:19:27,940 [DEBUG] (DVRSmain.java:1978) - Total send month alert0 ...
2015-03-09 14:19:27,940 [DEBUG] (DVRSmain.java:1979) - Log to table...executeBatch
2015-03-09 14:20:35,903 [ INFO] (DVRSmain.java:2220) - For 40705 send 2.0GB decrease speed  message !
2015-03-09 14:20:35,919 [ INFO] (Jatool.java:67) - get Properites!
2015-03-09 14:20:35,919 [ INFO] (Jatool.java:67) - Connect to Host : 106.186.120.118
2015-03-09 14:20:35,919 [ INFO] (Jatool.java:67) - port : null
2015-03-09 14:20:35,919 [ INFO] (Jatool.java:67) - use authority : true
2015-03-09 14:20:35,919 [ERROR] (Jatool.java:71) - sender is not equals to UserName !
2015-03-09 14:20:35,919 [DEBUG] (DVRSmain.java:2267) - execute SQL : INSERT INTO HUR_SMS_LOG(ID,SEND_NUMBER,MSG,SEND_DATE,RESULT,CREATE_DATE) VALUES(DVRS_SMS_ID.NEXTVAL,'k1988242001@gmail.com','?iHKNet Oneness SIM ???????q?q???j?L¡Pq??HKNet Oneness SIM????¡Óz?n?A¡Óz?b???????j?¢X?????????q?w?F2GB?A???????qFUP?W?d???????q?H128kbps?????A¢X??A??????¢X_???_???t?C¡Pq??¡Âd¡PN?C¡PP??¡Óz????HKNet?A???A????????%2b85266404204?C

Dear HKNet Oneness SIM customer, please be informed that your HK + China mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact HKNet Oneness SIM service hotline: %2b85266404204 if any queries.

',TO_DATE('2015/03/09 14:20:35','yyyy/MM/dd HH24:mi:ss'),'success',SYSDATE)
2015-03-09 14:20:35,919 [DEBUG] (DVRSmain.java:2275) - Total send volume alert SMS 1 ...
2015-03-09 14:20:35,951 [ INFO] (DVRSmain.java:2975) - sendAlertSMS execute time :68121
2015-03-09 14:20:35,967 [ INFO] (DVRSmain.java:1638) - insertCurrentMap...
2015-03-09 14:20:35,967 [ INFO] (DVRSmain.java:1647) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 14:20:35,967 [ INFO] (DVRSmain.java:1685) - insertCurrentMapDay...
2015-03-09 14:20:35,967 [ INFO] (DVRSmain.java:1693) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 14:20:35,967 [ INFO] (DVRSmain.java:1543) - updateCurrentMap...
2015-03-09 14:20:35,967 [ INFO] (DVRSmain.java:1554) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 14:20:35,982 [ INFO] (DVRSmain.java:1582) - Execute updateCurrentMap Batch
2015-03-09 14:20:35,982 [ INFO] (DVRSmain.java:1588) - updateCurrentMapDay...
2015-03-09 14:20:35,982 [ INFO] (DVRSmain.java:1598) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 14:20:35,998 [ INFO] (DVRSmain.java:1625) - Execute updateCurrentMapU Batch
2015-03-09 14:20:36,029 [ INFO] (DVRSmain.java:3001) - insert¡®update execute time :78
2015-03-09 14:20:36,029 [ INFO] (DVRSmain.java:3006) - processSuspendNBR execute time :0
2015-03-09 14:20:36,029 [ INFO] (DVRSmain.java:3011) - Program execute time :231279
2015-03-09 14:20:36,029 [ INFO] (DVRSmain.java:1116) - closeConnect1...
2015-03-09 14:20:36,045 [ INFO] (DVRSmain.java:1133) - closeConnect2...
2015-03-09 14:23:10,507 [ INFO] (DVRSmain.java:974) - Logger Load Success!
2015-03-09 14:23:10,513 [ INFO] (DVRSmain.java:991) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 14:23:10,619 [ INFO] (DVRSmain.java:2881) - RFP Program Start! Mon Mar 09 14:23:10 CST 2015
2015-03-09 14:23:10,619 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:23:11,341 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:23:11,341 [ INFO] (DVRSmain.java:1045) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 14:23:11,341 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:23:11,922 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:23:11,922 [ INFO] (DVRSmain.java:1086) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 14:23:11,922 [DEBUG] (DVRSmain.java:2889) - connect success!
2015-03-09 14:23:11,922 [ INFO] (DVRSmain.java:1152) - cancelAutoCommit...
2015-03-09 14:23:11,922 [ INFO] (DVRSmain.java:1154) - set AutoCommit false!
2015-03-09 14:23:11,928 [ INFO] (DVRSmain.java:138) - setMonthDate...
2015-03-09 14:23:11,929 [ INFO] (DVRSmain.java:844) - setIMSItoServiceIDMap...
2015-03-09 14:23:11,935 [ INFO] (DVRSmain.java:870) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 14:24:24,309 [ INFO] (DVRSmain.java:2902) - setIMSItoServiceIDMap execute time :72380
2015-03-09 14:24:24,309 [ INFO] (DVRSmain.java:890) - setServiceIDtoImsiMap...
2015-03-09 14:24:24,310 [ INFO] (DVRSmain.java:916) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 14:25:17,156 [ INFO] (DVRSmain.java:2907) - setServiceIDtoImsiMap execute time :52847
2015-03-09 14:25:17,156 [ INFO] (DVRSmain.java:183) - setLastFileID...
2015-03-09 14:25:17,157 [DEBUG] (DVRSmain.java:189) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 14:25:17,204 [ INFO] (DVRSmain.java:195) - Last process file ID :14333
2015-03-09 14:25:17,204 [ INFO] (DVRSmain.java:2912) - setLastFileID execute time :48
2015-03-09 14:25:17,204 [ INFO] (DVRSmain.java:218) - setCurrentMap...
2015-03-09 14:25:17,220 [DEBUG] (DVRSmain.java:227) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 14:25:17,235 [DEBUG] (DVRSmain.java:229) - Set current map...
2015-03-09 14:25:17,251 [ INFO] (DVRSmain.java:282) - setoldChargeMap...
2015-03-09 14:25:17,251 [ INFO] (DVRSmain.java:331) - setCurrentMapDay...
2015-03-09 14:25:17,251 [DEBUG] (DVRSmain.java:337) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 14:25:17,298 [ INFO] (DVRSmain.java:2919) - setCurrentMap execute time :94
2015-03-09 14:25:17,298 [ INFO] (DVRSmain.java:457) - setThreshold...
2015-03-09 14:25:17,298 [DEBUG] (DVRSmain.java:464) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 14:25:17,329 [DEBUG] (DVRSmain.java:467) - Set dataRate map...
2015-03-09 14:25:17,422 [ INFO] (DVRSmain.java:2924) - setThreshold execute time :124
2015-03-09 14:25:17,422 [ INFO] (DVRSmain.java:406) - setDataRate...
2015-03-09 14:25:17,422 [DEBUG] (DVRSmain.java:413) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 14:25:17,454 [DEBUG] (DVRSmain.java:416) - Set dataRate map...
2015-03-09 14:25:18,624 [ INFO] (DVRSmain.java:2929) - setDataRate execute time :1202
2015-03-09 14:25:18,624 [ INFO] (DVRSmain.java:785) - setMsisdnMap...
2015-03-09 14:25:18,624 [ INFO] (DVRSmain.java:808) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 14:25:46,580 [ INFO] (DVRSmain.java:2934) - setMsisdnMap execute time :27956
2015-03-09 14:25:46,580 [DEBUG] (DVRSmain.java:747) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 14:25:46,643 [ INFO] (DVRSmain.java:2940) - setIPtoMccmncList execute time :63
2015-03-09 14:25:46,643 [ INFO] (DVRSmain.java:490) - setSERVICEIDtoVLN...
2015-03-09 14:25:46,659 [DEBUG] (DVRSmain.java:498) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 14:25:58,577 [ INFO] (DVRSmain.java:2945) - setSERVICEIDtoVLN execute time :11934
2015-03-09 14:25:58,577 [ INFO] (DVRSmain.java:526) - setVLNtoTADIG...
2015-03-09 14:25:58,578 [DEBUG] (DVRSmain.java:534) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 14:26:00,710 [ INFO] (DVRSmain.java:2950) - setVLNtoTADIG execute time :2133
2015-03-09 14:26:00,710 [ INFO] (DVRSmain.java:560) - setTADIGtoMCCMNC...
2015-03-09 14:26:00,710 [DEBUG] (DVRSmain.java:567) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 14:26:01,008 [ INFO] (DVRSmain.java:2955) - setTADIGtoMCCMNC execute time :298
2015-03-09 14:26:01,008 [ INFO] (DVRSmain.java:593) - setCostomerNumber...
2015-03-09 14:26:01,008 [DEBUG] (DVRSmain.java:600) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 14:26:01,055 [ INFO] (DVRSmain.java:2960) - setCostomerNumber execute time :47
2015-03-09 14:26:01,055 [ INFO] (DVRSmain.java:703) - setAddonData...
2015-03-09 14:26:01,055 [DEBUG] (DVRSmain.java:709) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 14:26:01,822 [ INFO] (DVRSmain.java:2965) - setAddonData execute time :767
2015-03-09 14:26:01,822 [ INFO] (DVRSmain.java:1263) - charge...
2015-03-09 14:26:01,822 [ INFO] (DVRSmain.java:627) - dataCount...
2015-03-09 14:26:01,870 [DEBUG] (DVRSmain.java:637) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 14:26:01,870 [ INFO] (DVRSmain.java:642) - usage count : 0
2015-03-09 14:26:01,886 [ INFO] (DVRSmain.java:663) - defaultRate...
2015-03-09 14:26:01,886 [ INFO] (DVRSmain.java:692) - defaultRate : 0.011 TWD 
2015-03-09 14:26:01,886 [ INFO] (DVRSmain.java:2970) - charge execute time :64
2015-03-09 14:26:01,886 [ INFO] (DVRSmain.java:1743) - sendAlertSMS...
2015-03-09 14:26:01,886 [DEBUG] (DVRSmain.java:1759) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 14:26:01,901 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:26:01,901 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:26:01,901 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:26:01,901 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:26:01,901 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:26:01,901 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:26:01,917 [DEBUG] (DVRSmain.java:1803) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 14:26:01,979 [DEBUG] (DVRSmain.java:1978) - Total send month alert0 ...
2015-03-09 14:26:01,979 [DEBUG] (DVRSmain.java:1979) - Log to table...executeBatch
2015-03-09 14:26:01,995 [DEBUG] (DVRSmain.java:2275) - Total send volume alert SMS 0 ...
2015-03-09 14:26:01,995 [ INFO] (DVRSmain.java:2975) - sendAlertSMS execute time :109
2015-03-09 14:26:02,011 [ INFO] (DVRSmain.java:1638) - insertCurrentMap...
2015-03-09 14:26:02,011 [ INFO] (DVRSmain.java:1647) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 14:26:02,011 [ INFO] (DVRSmain.java:1685) - insertCurrentMapDay...
2015-03-09 14:26:02,011 [ INFO] (DVRSmain.java:1693) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 14:26:02,011 [ INFO] (DVRSmain.java:1543) - updateCurrentMap...
2015-03-09 14:26:02,011 [ INFO] (DVRSmain.java:1554) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 14:26:02,011 [ INFO] (DVRSmain.java:1582) - Execute updateCurrentMap Batch
2015-03-09 14:26:02,042 [ INFO] (DVRSmain.java:1588) - updateCurrentMapDay...
2015-03-09 14:26:02,042 [ INFO] (DVRSmain.java:1598) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 14:26:02,057 [ INFO] (DVRSmain.java:1625) - Execute updateCurrentMapU Batch
2015-03-09 14:26:02,089 [ INFO] (DVRSmain.java:3001) - insert¡®update execute time :94
2015-03-09 14:26:02,089 [ INFO] (DVRSmain.java:3006) - processSuspendNBR execute time :0
2015-03-09 14:26:02,089 [ INFO] (DVRSmain.java:3011) - Program execute time :170167
2015-03-09 14:26:02,089 [ INFO] (DVRSmain.java:1116) - closeConnect1...
2015-03-09 14:26:02,120 [ INFO] (DVRSmain.java:1133) - closeConnect2...
2015-03-09 14:27:02,318 [ INFO] (DVRSmain.java:974) - Logger Load Success!
2015-03-09 14:27:02,318 [ INFO] (DVRSmain.java:991) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 14:27:02,412 [ INFO] (DVRSmain.java:2881) - RFP Program Start! Mon Mar 09 14:27:02 CST 2015
2015-03-09 14:27:02,412 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:27:02,989 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:27:02,989 [ INFO] (DVRSmain.java:1045) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 14:27:02,989 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:27:03,302 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:27:03,302 [ INFO] (DVRSmain.java:1086) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 14:27:03,302 [DEBUG] (DVRSmain.java:2889) - connect success!
2015-03-09 14:27:03,302 [ INFO] (DVRSmain.java:1152) - cancelAutoCommit...
2015-03-09 14:27:03,302 [ INFO] (DVRSmain.java:1154) - set AutoCommit false!
2015-03-09 14:27:03,302 [ INFO] (DVRSmain.java:138) - setMonthDate...
2015-03-09 14:27:03,302 [ INFO] (DVRSmain.java:844) - setIMSItoServiceIDMap...
2015-03-09 14:27:03,318 [ INFO] (DVRSmain.java:870) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 14:28:16,237 [ INFO] (DVRSmain.java:2902) - setIMSItoServiceIDMap execute time :72935
2015-03-09 14:28:16,237 [ INFO] (DVRSmain.java:890) - setServiceIDtoImsiMap...
2015-03-09 14:28:16,237 [ INFO] (DVRSmain.java:916) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 14:29:10,135 [ INFO] (DVRSmain.java:2907) - setServiceIDtoImsiMap execute time :53898
2015-03-09 14:29:10,135 [ INFO] (DVRSmain.java:183) - setLastFileID...
2015-03-09 14:29:10,150 [DEBUG] (DVRSmain.java:189) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 14:29:10,151 [ INFO] (DVRSmain.java:195) - Last process file ID :14333
2015-03-09 14:29:10,183 [ INFO] (DVRSmain.java:2912) - setLastFileID execute time :48
2015-03-09 14:29:10,183 [ INFO] (DVRSmain.java:218) - setCurrentMap...
2015-03-09 14:29:10,183 [DEBUG] (DVRSmain.java:227) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 14:29:10,276 [DEBUG] (DVRSmain.java:229) - Set current map...
2015-03-09 14:29:10,307 [ INFO] (DVRSmain.java:282) - setoldChargeMap...
2015-03-09 14:29:10,307 [ INFO] (DVRSmain.java:331) - setCurrentMapDay...
2015-03-09 14:29:10,307 [DEBUG] (DVRSmain.java:337) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 14:29:10,370 [ INFO] (DVRSmain.java:2919) - setCurrentMap execute time :187
2015-03-09 14:29:10,370 [ INFO] (DVRSmain.java:457) - setThreshold...
2015-03-09 14:29:10,370 [DEBUG] (DVRSmain.java:464) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 14:29:10,401 [DEBUG] (DVRSmain.java:467) - Set dataRate map...
2015-03-09 14:29:10,511 [ INFO] (DVRSmain.java:2924) - setThreshold execute time :141
2015-03-09 14:29:10,511 [ INFO] (DVRSmain.java:406) - setDataRate...
2015-03-09 14:29:10,527 [DEBUG] (DVRSmain.java:413) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 14:29:10,558 [DEBUG] (DVRSmain.java:416) - Set dataRate map...
2015-03-09 14:29:11,727 [ INFO] (DVRSmain.java:2929) - setDataRate execute time :1216
2015-03-09 14:29:11,727 [ INFO] (DVRSmain.java:785) - setMsisdnMap...
2015-03-09 14:29:11,728 [ INFO] (DVRSmain.java:808) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 14:29:41,825 [ INFO] (DVRSmain.java:2934) - setMsisdnMap execute time :30098
2015-03-09 14:29:41,826 [DEBUG] (DVRSmain.java:747) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 14:29:41,888 [ INFO] (DVRSmain.java:2940) - setIPtoMccmncList execute time :63
2015-03-09 14:29:41,888 [ INFO] (DVRSmain.java:490) - setSERVICEIDtoVLN...
2015-03-09 14:29:41,888 [DEBUG] (DVRSmain.java:498) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 14:29:52,816 [ INFO] (DVRSmain.java:2945) - setSERVICEIDtoVLN execute time :10928
2015-03-09 14:29:52,816 [ INFO] (DVRSmain.java:526) - setVLNtoTADIG...
2015-03-09 14:29:52,816 [DEBUG] (DVRSmain.java:534) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 14:29:54,919 [ INFO] (DVRSmain.java:2950) - setVLNtoTADIG execute time :2103
2015-03-09 14:29:54,919 [ INFO] (DVRSmain.java:560) - setTADIGtoMCCMNC...
2015-03-09 14:29:54,920 [DEBUG] (DVRSmain.java:567) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 14:29:55,248 [ INFO] (DVRSmain.java:2955) - setTADIGtoMCCMNC execute time :329
2015-03-09 14:29:55,248 [ INFO] (DVRSmain.java:593) - setCostomerNumber...
2015-03-09 14:29:55,264 [DEBUG] (DVRSmain.java:600) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 14:29:55,295 [ INFO] (DVRSmain.java:2960) - setCostomerNumber execute time :47
2015-03-09 14:29:55,295 [ INFO] (DVRSmain.java:703) - setAddonData...
2015-03-09 14:29:55,310 [DEBUG] (DVRSmain.java:709) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 14:29:56,089 [ INFO] (DVRSmain.java:2965) - setAddonData execute time :794
2015-03-09 14:29:56,089 [ INFO] (DVRSmain.java:1263) - charge...
2015-03-09 14:29:56,089 [ INFO] (DVRSmain.java:627) - dataCount...
2015-03-09 14:29:56,105 [DEBUG] (DVRSmain.java:637) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 14:29:56,111 [ INFO] (DVRSmain.java:642) - usage count : 0
2015-03-09 14:29:56,117 [ INFO] (DVRSmain.java:663) - defaultRate...
2015-03-09 14:29:56,118 [ INFO] (DVRSmain.java:692) - defaultRate : 0.011 TWD 
2015-03-09 14:29:56,118 [ INFO] (DVRSmain.java:2970) - charge execute time :29
2015-03-09 14:29:56,118 [ INFO] (DVRSmain.java:1743) - sendAlertSMS...
2015-03-09 14:29:56,123 [DEBUG] (DVRSmain.java:1759) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 14:29:56,144 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:29:56,153 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:29:56,154 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:29:56,154 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:29:56,154 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:29:56,154 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:29:56,185 [DEBUG] (DVRSmain.java:1803) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 14:29:56,248 [DEBUG] (DVRSmain.java:1978) - Total send month alert0 ...
2015-03-09 14:29:56,248 [DEBUG] (DVRSmain.java:1979) - Log to table...executeBatch
2015-03-09 14:30:06,402 [ INFO] (DVRSmain.java:2220) - For 40705 send 2.0GB decrease speed  message !
2015-03-09 14:32:02,389 [ INFO] (DVRSmain.java:974) - Logger Load Success!
2015-03-09 14:32:02,389 [ INFO] (DVRSmain.java:991) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 14:32:02,467 [ INFO] (DVRSmain.java:2885) - RFP Program Start! Mon Mar 09 14:32:02 CST 2015
2015-03-09 14:32:02,467 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:32:02,966 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:32:02,966 [ INFO] (DVRSmain.java:1045) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 14:32:02,966 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:32:03,372 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:32:03,372 [ INFO] (DVRSmain.java:1086) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 14:32:03,372 [DEBUG] (DVRSmain.java:2893) - connect success!
2015-03-09 14:32:03,372 [ INFO] (DVRSmain.java:1152) - cancelAutoCommit...
2015-03-09 14:32:03,372 [ INFO] (DVRSmain.java:1154) - set AutoCommit false!
2015-03-09 14:32:03,372 [ INFO] (DVRSmain.java:138) - setMonthDate...
2015-03-09 14:32:03,372 [ INFO] (DVRSmain.java:844) - setIMSItoServiceIDMap...
2015-03-09 14:32:03,388 [ INFO] (DVRSmain.java:870) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 14:32:55,197 [ INFO] (DVRSmain.java:974) - Logger Load Success!
2015-03-09 14:32:55,198 [ INFO] (DVRSmain.java:991) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 14:32:55,627 [ INFO] (DVRSmain.java:2885) - RFP Program Start! Mon Mar 09 14:32:55 CST 2015
2015-03-09 14:32:55,627 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:32:57,696 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:32:57,696 [ INFO] (DVRSmain.java:1045) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 14:32:57,696 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:32:58,586 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:32:58,586 [ INFO] (DVRSmain.java:1086) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 14:32:58,586 [DEBUG] (DVRSmain.java:2893) - connect success!
2015-03-09 14:32:58,586 [ INFO] (DVRSmain.java:1152) - cancelAutoCommit...
2015-03-09 14:32:58,586 [ INFO] (DVRSmain.java:1154) - set AutoCommit false!
2015-03-09 14:32:58,648 [ INFO] (DVRSmain.java:138) - setMonthDate...
2015-03-09 14:32:58,664 [ INFO] (DVRSmain.java:844) - setIMSItoServiceIDMap...
2015-03-09 14:32:58,664 [ INFO] (DVRSmain.java:870) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 14:34:20,117 [ INFO] (DVRSmain.java:2906) - setIMSItoServiceIDMap execute time :81453
2015-03-09 14:34:20,117 [ INFO] (DVRSmain.java:890) - setServiceIDtoImsiMap...
2015-03-09 14:34:20,118 [ INFO] (DVRSmain.java:916) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 14:35:12,154 [ INFO] (DVRSmain.java:2911) - setServiceIDtoImsiMap execute time :52037
2015-03-09 14:35:12,154 [ INFO] (DVRSmain.java:183) - setLastFileID...
2015-03-09 14:35:12,154 [DEBUG] (DVRSmain.java:189) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 14:35:12,172 [ INFO] (DVRSmain.java:195) - Last process file ID :14333
2015-03-09 14:35:12,172 [ INFO] (DVRSmain.java:2916) - setLastFileID execute time :18
2015-03-09 14:35:12,172 [ INFO] (DVRSmain.java:218) - setCurrentMap...
2015-03-09 14:35:12,203 [DEBUG] (DVRSmain.java:227) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 14:35:12,208 [DEBUG] (DVRSmain.java:229) - Set current map...
2015-03-09 14:35:12,226 [ INFO] (DVRSmain.java:282) - setoldChargeMap...
2015-03-09 14:35:12,226 [ INFO] (DVRSmain.java:331) - setCurrentMapDay...
2015-03-09 14:35:12,226 [DEBUG] (DVRSmain.java:337) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 14:35:12,266 [ INFO] (DVRSmain.java:2923) - setCurrentMap execute time :94
2015-03-09 14:35:12,266 [ INFO] (DVRSmain.java:457) - setThreshold...
2015-03-09 14:35:12,271 [DEBUG] (DVRSmain.java:464) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 14:35:12,321 [DEBUG] (DVRSmain.java:467) - Set dataRate map...
2015-03-09 14:35:12,430 [ INFO] (DVRSmain.java:2928) - setThreshold execute time :164
2015-03-09 14:35:12,430 [ INFO] (DVRSmain.java:406) - setDataRate...
2015-03-09 14:35:12,446 [DEBUG] (DVRSmain.java:413) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 14:35:12,461 [DEBUG] (DVRSmain.java:416) - Set dataRate map...
2015-03-09 14:35:13,771 [ INFO] (DVRSmain.java:2933) - setDataRate execute time :1341
2015-03-09 14:35:13,771 [ INFO] (DVRSmain.java:785) - setMsisdnMap...
2015-03-09 14:35:13,772 [ INFO] (DVRSmain.java:808) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 14:35:35,271 [ INFO] (DVRSmain.java:2938) - setMsisdnMap execute time :21500
2015-03-09 14:35:35,272 [DEBUG] (DVRSmain.java:747) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 14:35:35,350 [ INFO] (DVRSmain.java:2944) - setIPtoMccmncList execute time :79
2015-03-09 14:35:35,350 [ INFO] (DVRSmain.java:490) - setSERVICEIDtoVLN...
2015-03-09 14:35:35,350 [DEBUG] (DVRSmain.java:498) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 14:35:46,556 [ INFO] (DVRSmain.java:2949) - setSERVICEIDtoVLN execute time :11206
2015-03-09 14:35:46,556 [ INFO] (DVRSmain.java:526) - setVLNtoTADIG...
2015-03-09 14:35:46,564 [DEBUG] (DVRSmain.java:534) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 14:35:48,491 [ INFO] (DVRSmain.java:2954) - setVLNtoTADIG execute time :1935
2015-03-09 14:35:48,491 [ INFO] (DVRSmain.java:560) - setTADIGtoMCCMNC...
2015-03-09 14:35:48,492 [DEBUG] (DVRSmain.java:567) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 14:35:48,851 [ INFO] (DVRSmain.java:2959) - setTADIGtoMCCMNC execute time :360
2015-03-09 14:35:48,851 [ INFO] (DVRSmain.java:593) - setCostomerNumber...
2015-03-09 14:35:48,851 [DEBUG] (DVRSmain.java:600) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 14:35:48,898 [ INFO] (DVRSmain.java:2964) - setCostomerNumber execute time :47
2015-03-09 14:35:48,898 [ INFO] (DVRSmain.java:703) - setAddonData...
2015-03-09 14:35:48,898 [DEBUG] (DVRSmain.java:709) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 14:35:49,583 [ INFO] (DVRSmain.java:2969) - setAddonData execute time :685
2015-03-09 14:35:49,583 [ INFO] (DVRSmain.java:1263) - charge...
2015-03-09 14:35:49,583 [ INFO] (DVRSmain.java:627) - dataCount...
2015-03-09 14:35:49,646 [DEBUG] (DVRSmain.java:637) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 14:35:49,646 [ INFO] (DVRSmain.java:642) - usage count : 0
2015-03-09 14:35:49,646 [ INFO] (DVRSmain.java:663) - defaultRate...
2015-03-09 14:35:49,646 [ INFO] (DVRSmain.java:692) - defaultRate : 0.011 TWD 
2015-03-09 14:35:49,646 [ INFO] (DVRSmain.java:2974) - charge execute time :63
2015-03-09 14:35:49,646 [ INFO] (DVRSmain.java:1743) - sendAlertSMS...
2015-03-09 14:35:49,647 [DEBUG] (DVRSmain.java:1759) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 14:35:49,657 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:35:49,658 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:35:49,658 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:35:49,658 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:35:49,658 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:35:49,658 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:35:49,675 [DEBUG] (DVRSmain.java:1803) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 14:35:49,753 [DEBUG] (DVRSmain.java:1978) - Total send month alert0 ...
2015-03-09 14:35:49,753 [DEBUG] (DVRSmain.java:1979) - Log to table...executeBatch
2015-03-09 14:35:49,753 [ INFO] (DVRSmain.java:2220) - For 40705 send 2.0GB decrease speed  message !
2015-03-09 14:35:49,784 [ INFO] (Jatool.java:67) - get Properites!
2015-03-09 14:35:49,784 [ INFO] (Jatool.java:67) - Connect to Host : 106.186.120.118
2015-03-09 14:35:49,784 [ INFO] (Jatool.java:67) - port : null
2015-03-09 14:35:49,784 [ INFO] (Jatool.java:67) - use authority : true
2015-03-09 14:35:49,784 [DEBUG] (Jatool.java:69) - Creat mail Session!
2015-03-09 14:35:49,862 [DEBUG] (Jatool.java:69) - set mail content!
2015-03-09 14:35:52,609 [ INFO] (Jatool.java:67) - sending mail from HKNet@sim2travel.com to k1988242001@gmail.com
<br>Subject : Notification on FUP 100% 2GB
<br>Content : <html><body>?iHKNet Oneness SIM ???????q?q???j?L¡Pq??HKNet Oneness SIM????¡Óz?n?A¡Óz?b???????j?¢X?????????q?w?F2GB?A???????qFUP?W?d???????q?H128kbps?????A¢X??A??????¢X_???_???t?C¡Pq??¡Âd¡PN?C¡PP??¡Óz????HKNet?A???A????????%2b85266404204?C

Dear HKNet Oneness SIM customer, please be informed that your HK + China mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact HKNet Oneness SIM service hotline: %2b85266404204 if any queries.

</body></html>
<br>SendDate: Mon Mar 09 14:35:49 CST 2015
2015-03-09 14:35:52,609 [DEBUG] (DVRSmain.java:2267) - execute SQL : INSERT INTO HUR_SMS_LOG(ID,SEND_NUMBER,MSG,SEND_DATE,RESULT,CREATE_DATE) VALUES(DVRS_SMS_ID.NEXTVAL,'k1988242001@gmail.com','?iHKNet Oneness SIM ???????q?q???j?L¡Pq??HKNet Oneness SIM????¡Óz?n?A¡Óz?b???????j?¢X?????????q?w?F2GB?A???????qFUP?W?d???????q?H128kbps?????A¢X??A??????¢X_???_???t?C¡Pq??¡Âd¡PN?C¡PP??¡Óz????HKNet?A???A????????%2b85266404204?C

Dear HKNet Oneness SIM customer, please be informed that your HK + China mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact HKNet Oneness SIM service hotline: %2b85266404204 if any queries.

',TO_DATE('2015/03/09 14:35:52','yyyy/MM/dd HH24:mi:ss'),'success',SYSDATE)
2015-03-09 14:35:52,609 [DEBUG] (DVRSmain.java:2275) - Total send volume alert SMS 1 ...
2015-03-09 14:35:52,673 [ INFO] (DVRSmain.java:2979) - sendAlertSMS execute time :3027
2015-03-09 14:35:52,688 [ INFO] (DVRSmain.java:1638) - insertCurrentMap...
2015-03-09 14:35:52,688 [ INFO] (DVRSmain.java:1647) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 14:35:52,688 [ INFO] (DVRSmain.java:1685) - insertCurrentMapDay...
2015-03-09 14:35:52,688 [ INFO] (DVRSmain.java:1693) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 14:35:52,688 [ INFO] (DVRSmain.java:1543) - updateCurrentMap...
2015-03-09 14:35:52,688 [ INFO] (DVRSmain.java:1554) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 14:35:52,688 [ INFO] (DVRSmain.java:1582) - Execute updateCurrentMap Batch
2015-03-09 14:35:52,704 [ INFO] (DVRSmain.java:1588) - updateCurrentMapDay...
2015-03-09 14:35:52,704 [ INFO] (DVRSmain.java:1598) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 14:35:52,720 [ INFO] (DVRSmain.java:1625) - Execute updateCurrentMapU Batch
2015-03-09 14:35:52,766 [ INFO] (DVRSmain.java:3005) - insert¡®update execute time :93
2015-03-09 14:35:52,766 [ INFO] (DVRSmain.java:3010) - processSuspendNBR execute time :0
2015-03-09 14:35:52,766 [ INFO] (DVRSmain.java:3015) - Program execute time :174180
2015-03-09 14:35:52,766 [ INFO] (DVRSmain.java:1116) - closeConnect1...
2015-03-09 14:35:52,800 [ INFO] (DVRSmain.java:1133) - closeConnect2...
2015-03-09 14:40:49,138 [ INFO] (DVRSmain.java:975) - Logger Load Success!
2015-03-09 14:40:49,153 [ INFO] (DVRSmain.java:992) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 14:40:49,249 [ INFO] (DVRSmain.java:2898) - RFP Program Start! Mon Mar 09 14:40:49 CST 2015
2015-03-09 14:40:49,249 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:40:49,826 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:40:49,826 [ INFO] (DVRSmain.java:1046) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 14:40:49,826 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:40:50,325 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:40:50,325 [ INFO] (DVRSmain.java:1087) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 14:40:50,325 [DEBUG] (DVRSmain.java:2906) - connect success!
2015-03-09 14:40:50,325 [ INFO] (DVRSmain.java:1153) - cancelAutoCommit...
2015-03-09 14:40:50,325 [ INFO] (DVRSmain.java:1155) - set AutoCommit false!
2015-03-09 14:40:50,326 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 14:40:50,326 [ INFO] (DVRSmain.java:845) - setIMSItoServiceIDMap...
2015-03-09 14:40:50,326 [ INFO] (DVRSmain.java:871) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 14:41:57,622 [ INFO] (DVRSmain.java:2919) - setIMSItoServiceIDMap execute time :67296
2015-03-09 14:41:57,622 [ INFO] (DVRSmain.java:891) - setServiceIDtoImsiMap...
2015-03-09 14:41:57,622 [ INFO] (DVRSmain.java:917) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 14:42:51,319 [ INFO] (DVRSmain.java:2924) - setServiceIDtoImsiMap execute time :53697
2015-03-09 14:42:51,320 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 14:42:51,334 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 14:42:51,371 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 14:42:51,378 [ INFO] (DVRSmain.java:2929) - setLastFileID execute time :58
2015-03-09 14:42:51,378 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 14:42:51,388 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 14:42:51,421 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 14:42:51,445 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 14:42:51,445 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 14:42:51,445 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 14:42:51,510 [ INFO] (DVRSmain.java:2936) - setCurrentMap execute time :132
2015-03-09 14:42:51,510 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 14:42:51,523 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 14:42:51,558 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 14:42:51,721 [ INFO] (DVRSmain.java:2941) - setThreshold execute time :211
2015-03-09 14:42:51,721 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 14:42:51,732 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 14:42:51,768 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 14:42:53,256 [ INFO] (DVRSmain.java:2946) - setDataRate execute time :1535
2015-03-09 14:42:53,256 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 14:42:53,269 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 14:43:14,858 [ INFO] (DVRSmain.java:2951) - setMsisdnMap execute time :21602
2015-03-09 14:43:14,872 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 14:43:14,926 [ INFO] (DVRSmain.java:2957) - setIPtoMccmncList execute time :68
2015-03-09 14:43:14,926 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 14:43:14,932 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 14:43:27,646 [ INFO] (DVRSmain.java:2962) - setSERVICEIDtoVLN execute time :12720
2015-03-09 14:43:27,647 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 14:43:27,670 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 14:43:30,088 [ INFO] (DVRSmain.java:2967) - setVLNtoTADIG execute time :2441
2015-03-09 14:43:30,088 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 14:43:30,100 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 14:43:30,445 [ INFO] (DVRSmain.java:2972) - setTADIGtoMCCMNC execute time :357
2015-03-09 14:43:30,445 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 14:43:30,458 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 14:43:30,503 [ INFO] (DVRSmain.java:2977) - setCostomerNumber execute time :58
2015-03-09 14:43:30,503 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 14:43:30,520 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 14:43:31,310 [ INFO] (DVRSmain.java:2982) - setAddonData execute time :807
2015-03-09 14:43:31,310 [ INFO] (DVRSmain.java:1264) - charge...
2015-03-09 14:43:31,310 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 14:43:31,354 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 14:43:31,359 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 14:43:31,365 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 14:43:31,365 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 14:43:31,366 [ INFO] (DVRSmain.java:2987) - charge execute time :56
2015-03-09 14:43:31,366 [ INFO] (DVRSmain.java:1745) - sendAlertSMS...
2015-03-09 14:43:31,371 [DEBUG] (DVRSmain.java:1761) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 14:43:31,392 [ INFO] (DVRSmain.java:1769) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:43:31,392 [ INFO] (DVRSmain.java:1769) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:43:31,393 [ INFO] (DVRSmain.java:1769) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:43:31,393 [ INFO] (DVRSmain.java:1769) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:43:31,393 [ INFO] (DVRSmain.java:1769) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:43:31,393 [ INFO] (DVRSmain.java:1769) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:43:31,411 [DEBUG] (DVRSmain.java:1805) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 14:43:31,559 [DEBUG] (DVRSmain.java:1980) - Total send month alert0 ...
2015-03-09 14:43:31,559 [DEBUG] (DVRSmain.java:1981) - Log to table...executeBatch
2015-03-09 14:43:31,571 [ INFO] (DVRSmain.java:2222) - For 40705 send 2.0GB decrease speed  message !
2015-03-09 14:43:31,595 [ INFO] (Jatool.java:67) - get Properites!
2015-03-09 14:43:31,595 [ INFO] (Jatool.java:67) - Connect to Host : 106.186.120.118
2015-03-09 14:43:31,595 [ INFO] (Jatool.java:67) - port : null
2015-03-09 14:43:31,595 [ INFO] (Jatool.java:67) - use authority : true
2015-03-09 14:43:31,596 [DEBUG] (Jatool.java:69) - Creat mail Session!
2015-03-09 14:43:31,637 [DEBUG] (Jatool.java:69) - set mail content!
2015-03-09 14:43:32,885 [ INFO] (Jatool.java:67) - sending mail from HKNet@sim2travel.com to k1988242001@gmail.com
<br>Subject : Notification on FUP 100% 2GB
<br>Content : <html><body>Notification on FUP 100% 2GB</body></html>
<br>SendDate: Mon Mar 09 14:43:31 CST 2015
2015-03-09 14:43:32,885 [DEBUG] (DVRSmain.java:2272) - execute SQL : INSERT INTO HUR_SMS_LOG(ID,SEND_NUMBER,MSG,SEND_DATE,RESULT,CREATE_DATE) VALUES(DVRS_SMS_ID.NEXTVAL,'k1988242001@gmail.com','Notification on FUP 100% 2GB',TO_DATE('2015/03/09 14:43:32','yyyy/MM/dd HH24:mi:ss'),'success',SYSDATE)
2015-03-09 14:43:32,885 [DEBUG] (DVRSmain.java:2280) - Total send volume alert SMS 1 ...
2015-03-09 14:43:32,913 [ INFO] (DVRSmain.java:2992) - sendAlertSMS execute time :1547
2015-03-09 14:43:32,933 [ INFO] (DVRSmain.java:1639) - insertCurrentMap...
2015-03-09 14:43:32,933 [ INFO] (DVRSmain.java:1648) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 14:43:32,933 [ INFO] (DVRSmain.java:1686) - insertCurrentMapDay...
2015-03-09 14:43:32,933 [ INFO] (DVRSmain.java:1694) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 14:43:32,933 [ INFO] (DVRSmain.java:1544) - updateCurrentMap...
2015-03-09 14:43:32,933 [ INFO] (DVRSmain.java:1555) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 14:43:32,939 [ INFO] (DVRSmain.java:1583) - Execute updateCurrentMap Batch
2015-03-09 14:43:32,956 [ INFO] (DVRSmain.java:1589) - updateCurrentMapDay...
2015-03-09 14:43:32,957 [ INFO] (DVRSmain.java:1599) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 14:43:32,963 [ INFO] (DVRSmain.java:1626) - Execute updateCurrentMapU Batch
2015-03-09 14:43:32,991 [ INFO] (DVRSmain.java:3018) - insert¡®update execute time :77
2015-03-09 14:43:32,991 [ INFO] (DVRSmain.java:3023) - processSuspendNBR execute time :0
2015-03-09 14:43:32,991 [ INFO] (DVRSmain.java:3028) - Program execute time :162666
2015-03-09 14:43:32,991 [ INFO] (DVRSmain.java:1117) - closeConnect1...
2015-03-09 14:43:33,003 [ INFO] (DVRSmain.java:1134) - closeConnect2...
2015-03-09 14:44:17,280 [ INFO] (DVRSmain.java:975) - Logger Load Success!
2015-03-09 14:44:17,283 [ INFO] (DVRSmain.java:992) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 14:44:17,359 [ INFO] (DVRSmain.java:2898) - RFP Program Start! Mon Mar 09 14:44:17 CST 2015
2015-03-09 14:44:17,359 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:44:17,867 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:44:17,867 [ INFO] (DVRSmain.java:1046) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 14:44:17,867 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:44:18,276 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:44:18,277 [ INFO] (DVRSmain.java:1087) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 14:44:18,277 [DEBUG] (DVRSmain.java:2906) - connect success!
2015-03-09 14:44:18,277 [ INFO] (DVRSmain.java:1153) - cancelAutoCommit...
2015-03-09 14:44:18,277 [ INFO] (DVRSmain.java:1155) - set AutoCommit false!
2015-03-09 14:44:18,283 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 14:44:18,284 [ INFO] (DVRSmain.java:845) - setIMSItoServiceIDMap...
2015-03-09 14:44:18,289 [ INFO] (DVRSmain.java:871) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 14:45:28,503 [ INFO] (DVRSmain.java:2919) - setIMSItoServiceIDMap execute time :70219
2015-03-09 14:45:28,504 [ INFO] (DVRSmain.java:891) - setServiceIDtoImsiMap...
2015-03-09 14:45:28,509 [ INFO] (DVRSmain.java:917) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 14:46:25,535 [ INFO] (DVRSmain.java:2924) - setServiceIDtoImsiMap execute time :57031
2015-03-09 14:46:25,535 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 14:46:25,536 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 14:46:25,582 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 14:46:25,598 [ INFO] (DVRSmain.java:2929) - setLastFileID execute time :63
2015-03-09 14:46:25,598 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 14:46:25,614 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 14:46:25,629 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 14:46:25,645 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 14:46:25,645 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 14:46:25,645 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 14:46:25,692 [ INFO] (DVRSmain.java:2936) - setCurrentMap execute time :94
2015-03-09 14:46:25,692 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 14:46:25,692 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 14:46:25,723 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 14:46:25,816 [ INFO] (DVRSmain.java:2941) - setThreshold execute time :124
2015-03-09 14:46:25,816 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 14:46:25,816 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 14:46:25,848 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 14:46:27,096 [ INFO] (DVRSmain.java:2946) - setDataRate execute time :1280
2015-03-09 14:46:27,096 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 14:46:27,097 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 14:46:49,280 [ INFO] (DVRSmain.java:2951) - setMsisdnMap execute time :22184
2015-03-09 14:46:49,296 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 14:46:49,359 [ INFO] (DVRSmain.java:2957) - setIPtoMccmncList execute time :79
2015-03-09 14:46:49,359 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 14:46:49,375 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 14:47:00,549 [ INFO] (DVRSmain.java:2962) - setSERVICEIDtoVLN execute time :11190
2015-03-09 14:47:00,549 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 14:47:00,550 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 14:47:02,580 [ INFO] (DVRSmain.java:2967) - setVLNtoTADIG execute time :2031
2015-03-09 14:47:02,580 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 14:47:02,581 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 14:47:02,924 [ INFO] (DVRSmain.java:2972) - setTADIGtoMCCMNC execute time :344
2015-03-09 14:47:02,924 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 14:47:02,924 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 14:47:02,986 [ INFO] (DVRSmain.java:2977) - setCostomerNumber execute time :62
2015-03-09 14:47:02,986 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 14:47:03,002 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 14:47:03,704 [ INFO] (DVRSmain.java:2982) - setAddonData execute time :718
2015-03-09 14:47:03,704 [ INFO] (DVRSmain.java:1264) - charge...
2015-03-09 14:47:03,704 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 14:47:03,752 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 14:47:03,752 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 14:47:03,767 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 14:47:03,767 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 14:47:03,767 [ INFO] (DVRSmain.java:2987) - charge execute time :63
2015-03-09 14:47:03,767 [ INFO] (DVRSmain.java:1745) - sendAlertSMS...
2015-03-09 14:47:03,767 [DEBUG] (DVRSmain.java:1761) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 14:47:03,783 [ INFO] (DVRSmain.java:1769) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:47:03,783 [ INFO] (DVRSmain.java:1769) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:47:03,783 [ INFO] (DVRSmain.java:1769) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:47:03,783 [ INFO] (DVRSmain.java:1769) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:47:03,783 [ INFO] (DVRSmain.java:1769) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:47:03,783 [ INFO] (DVRSmain.java:1769) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:47:03,799 [DEBUG] (DVRSmain.java:1805) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 14:47:03,861 [DEBUG] (DVRSmain.java:1980) - Total send month alert0 ...
2015-03-09 14:47:03,861 [DEBUG] (DVRSmain.java:1981) - Log to table...executeBatch
2015-03-09 14:47:03,877 [ INFO] (DVRSmain.java:2222) - For 40705 send 2.0GB decrease speed  message !
2015-03-09 14:47:03,877 [ INFO] (Jatool.java:67) - get Properites!
2015-03-09 14:47:03,877 [ INFO] (Jatool.java:67) - Connect to Host : 106.186.120.118
2015-03-09 14:47:03,877 [ INFO] (Jatool.java:67) - port : null
2015-03-09 14:47:03,877 [ INFO] (Jatool.java:67) - use authority : true
2015-03-09 14:47:03,877 [DEBUG] (Jatool.java:69) - Creat mail Session!
2015-03-09 14:47:03,908 [DEBUG] (Jatool.java:69) - set mail content!
2015-03-09 14:47:05,686 [ INFO] (Jatool.java:67) - sending mail from HKNet@sim2travel.com to k1988242001@gmail.com
<br>Subject : Notification on FUP 100% 2GB
<br>Content : <html><body>¡iHKNet Oneness SIM ¼Æ¾Ú¥Î¶q³qª¾¡j´L·qªºHKNet Oneness SIM¥Î¤á±z¦n¡A±z¦b­»´ä¤Î¤j³°ªº¼Æ¾Ú¥Î¶q¤w¹F2GB¡A«ö¥»¤½¥qFUP³W½d¼Æ¾Ú¥Î¶q¥H128kbps´£¨ÑªA°È¡A¦Ü¦¸¤ë°_«ì´_¥þ³t¡C·q½Ð¯d·N¡C·PÁÂ±z¨Ï¥ÎHKNet¡A«ÈªA¿Ô¸ß½Ð¬¢%2b85266404204¡C

<br><br>Dear HKNet Oneness SIM customer, please be informed that your HK + China mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact HKNet Oneness SIM service hotline: %2b85266404204 if any queries.

<br><br></body></html>
<br>SendDate: Mon Mar 09 14:47:03 CST 2015
2015-03-09 14:47:05,686 [DEBUG] (DVRSmain.java:2272) - execute SQL : INSERT INTO HUR_SMS_LOG(ID,SEND_NUMBER,MSG,SEND_DATE,RESULT,CREATE_DATE) VALUES(DVRS_SMS_ID.NEXTVAL,'k1988242001@gmail.com','¡iHKNet Oneness SIM ¼Æ¾Ú¥Î¶q³qª¾¡j´L·qªºHKNet Oneness SIM¥Î¤á±z¦n¡A±z¦b­»´ä¤Î¤j³°ªº¼Æ¾Ú¥Î¶q¤w¹F2GB¡A«ö¥»¤½¥qFUP³W½d¼Æ¾Ú¥Î¶q¥H128kbps´£¨ÑªA°È¡A¦Ü¦¸¤ë°_«ì´_¥þ³t¡C·q½Ð¯d·N¡C·PÁÂ±z¨Ï¥ÎHKNet¡A«ÈªA¿Ô¸ß½Ð¬¢%2b85266404204¡C

<br><br>Dear HKNet Oneness SIM customer, please be informed that your HK + China mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact HKNet Oneness SIM service hotline: %2b85266404204 if any queries.

<br><br>',TO_DATE('2015/03/09 14:47:05','yyyy/MM/dd HH24:mi:ss'),'success',SYSDATE)
2015-03-09 14:47:05,686 [DEBUG] (DVRSmain.java:2280) - Total send volume alert SMS 1 ...
2015-03-09 14:47:05,796 [ERROR] (DVRSmain.java:2285) - At sendDayAlertSMS occur SQLException error!
java.sql.BatchUpdateException: §å¦¸§@·~®Éµo¥Í¿ù»~: ORA-00917: missing comma

	at oracle.jdbc.dbaccess.DBError.throwBatchUpdateException(DBError.java:571)
	at oracle.jdbc.dbaccess.DBError.throwBatchUpdateException(DBError.java:626)
	at oracle.jdbc.driver.OracleStatement.executeBatch(OracleStatement.java:6841)
	at program.DVRSmain.sendAlertSMS(DVRSmain.java:2281)
	at program.DVRSmain.process(DVRSmain.java:2991)
	at program.DVRSmain.execute(DVRSmain.java:2878)
	at org.quartz.core.JobRunShell.run(JobRunShell.java:202)
	at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573)
2015-03-09 14:47:05,796 [ERROR] (DVRSmain.java:2480) - Can't send email without receiver!
2015-03-09 14:47:05,796 [ INFO] (DVRSmain.java:2992) - sendAlertSMS execute time :2029
2015-03-09 14:47:05,827 [ INFO] (DVRSmain.java:1639) - insertCurrentMap...
2015-03-09 14:47:05,827 [ INFO] (DVRSmain.java:1648) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 14:47:05,827 [ INFO] (DVRSmain.java:1686) - insertCurrentMapDay...
2015-03-09 14:47:05,827 [ INFO] (DVRSmain.java:1694) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 14:47:05,827 [ INFO] (DVRSmain.java:1544) - updateCurrentMap...
2015-03-09 14:47:05,827 [ INFO] (DVRSmain.java:1555) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 14:47:05,827 [ INFO] (DVRSmain.java:1583) - Execute updateCurrentMap Batch
2015-03-09 14:47:05,843 [ INFO] (DVRSmain.java:1589) - updateCurrentMapDay...
2015-03-09 14:47:05,843 [ INFO] (DVRSmain.java:1599) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 14:47:05,859 [ INFO] (DVRSmain.java:1626) - Execute updateCurrentMapU Batch
2015-03-09 14:47:05,890 [ INFO] (DVRSmain.java:3018) - insert¡®update execute time :94
2015-03-09 14:47:05,890 [ INFO] (DVRSmain.java:3023) - processSuspendNBR execute time :0
2015-03-09 14:47:05,890 [ INFO] (DVRSmain.java:3028) - Program execute time :167613
2015-03-09 14:47:05,890 [ INFO] (DVRSmain.java:1117) - closeConnect1...
2015-03-09 14:47:05,905 [ INFO] (DVRSmain.java:1134) - closeConnect2...
2015-03-09 14:53:14,385 [ INFO] (DVRSmain.java:975) - Logger Load Success!
2015-03-09 14:53:14,406 [ INFO] (DVRSmain.java:992) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 14:53:14,573 [ INFO] (DVRSmain.java:2898) - RFP Program Start! Mon Mar 09 14:53:14 CST 2015
2015-03-09 14:53:14,574 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:53:15,825 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:53:15,825 [ INFO] (DVRSmain.java:1046) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 14:53:15,826 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 14:53:16,237 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 14:53:16,238 [ INFO] (DVRSmain.java:1087) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 14:53:16,238 [DEBUG] (DVRSmain.java:2906) - connect success!
2015-03-09 14:53:16,238 [ INFO] (DVRSmain.java:1153) - cancelAutoCommit...
2015-03-09 14:53:16,238 [ INFO] (DVRSmain.java:1155) - set AutoCommit false!
2015-03-09 14:53:16,247 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 14:53:16,264 [ INFO] (DVRSmain.java:845) - setIMSItoServiceIDMap...
2015-03-09 14:53:16,271 [ INFO] (DVRSmain.java:871) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 14:54:27,044 [ INFO] (DVRSmain.java:2919) - setIMSItoServiceIDMap execute time :70780
2015-03-09 14:54:27,045 [ INFO] (DVRSmain.java:891) - setServiceIDtoImsiMap...
2015-03-09 14:54:27,051 [ INFO] (DVRSmain.java:917) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 14:55:17,979 [ INFO] (DVRSmain.java:2924) - setServiceIDtoImsiMap execute time :50934
2015-03-09 14:55:17,979 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 14:55:17,985 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 14:55:18,010 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 14:55:18,016 [ INFO] (DVRSmain.java:2929) - setLastFileID execute time :37
2015-03-09 14:55:18,017 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 14:55:18,022 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 14:55:18,046 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 14:55:18,083 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 14:55:18,084 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 14:55:18,084 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 14:55:18,123 [ INFO] (DVRSmain.java:2936) - setCurrentMap execute time :106
2015-03-09 14:55:18,123 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 14:55:18,128 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 14:55:18,148 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 14:55:18,248 [ INFO] (DVRSmain.java:2941) - setThreshold execute time :125
2015-03-09 14:55:18,249 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 14:55:18,254 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 14:55:18,277 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 14:55:19,390 [ INFO] (DVRSmain.java:2946) - setDataRate execute time :1141
2015-03-09 14:55:19,391 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 14:55:19,402 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 14:55:43,931 [ INFO] (DVRSmain.java:2951) - setMsisdnMap execute time :24540
2015-03-09 14:55:43,941 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 14:55:43,996 [ INFO] (DVRSmain.java:2957) - setIPtoMccmncList execute time :65
2015-03-09 14:55:43,997 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 14:55:44,003 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 14:55:56,145 [ INFO] (DVRSmain.java:2962) - setSERVICEIDtoVLN execute time :12148
2015-03-09 14:55:56,145 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 14:55:56,158 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 14:55:58,231 [ INFO] (DVRSmain.java:2967) - setVLNtoTADIG execute time :2086
2015-03-09 14:55:58,232 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 14:55:58,244 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 14:55:58,927 [ INFO] (DVRSmain.java:2972) - setTADIGtoMCCMNC execute time :695
2015-03-09 14:55:58,927 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 14:55:58,940 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 14:55:58,981 [ INFO] (DVRSmain.java:2977) - setCostomerNumber execute time :54
2015-03-09 14:55:58,982 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 14:55:58,988 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 14:55:59,708 [ INFO] (DVRSmain.java:2982) - setAddonData execute time :726
2015-03-09 14:55:59,708 [ INFO] (DVRSmain.java:1264) - charge...
2015-03-09 14:55:59,708 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 14:55:59,751 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 14:55:59,758 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 14:55:59,765 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 14:55:59,765 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 14:55:59,765 [ INFO] (DVRSmain.java:2987) - charge execute time :57
2015-03-09 14:55:59,765 [ INFO] (DVRSmain.java:1745) - sendAlertSMS...
2015-03-09 14:55:59,771 [DEBUG] (DVRSmain.java:1761) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 14:55:59,793 [ INFO] (DVRSmain.java:1769) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:55:59,793 [ INFO] (DVRSmain.java:1769) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 14:55:59,794 [ INFO] (DVRSmain.java:1769) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:55:59,794 [ INFO] (DVRSmain.java:1769) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 14:55:59,794 [ INFO] (DVRSmain.java:1769) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:55:59,794 [ INFO] (DVRSmain.java:1769) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 14:55:59,811 [DEBUG] (DVRSmain.java:1805) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 14:55:59,862 [DEBUG] (DVRSmain.java:1980) - Total send month alert0 ...
2015-03-09 14:55:59,862 [DEBUG] (DVRSmain.java:1981) - Log to table...executeBatch
2015-03-09 14:55:59,874 [ INFO] (DVRSmain.java:2222) - For 40705 send 2.0GB decrease speed  message !
2015-03-09 14:55:59,905 [ INFO] (Jatool.java:67) - get Properites!
2015-03-09 14:55:59,906 [ INFO] (Jatool.java:67) - Connect to Host : 106.186.120.118
2015-03-09 14:55:59,906 [ INFO] (Jatool.java:67) - port : null
2015-03-09 14:55:59,906 [ INFO] (Jatool.java:67) - use authority : true
2015-03-09 14:55:59,906 [DEBUG] (Jatool.java:69) - Creat mail Session!
2015-03-09 14:56:00,005 [DEBUG] (Jatool.java:69) - set mail content!
2015-03-09 14:56:02,101 [ INFO] (Jatool.java:67) - sending mail from HKNet@sim2travel.com to k1988242001@gmail.com
<br>Subject : Notification on FUP 100% 2GB
<br>Content : <html><body>¡iHKNet Oneness SIM ¼Æ¾Ú¥Î¶q³qª¾¡j´L·qªºHKNet Oneness SIM¥Î¤á±z¦n¡A±z¦b­»´ä¤Î¤j³°ªº¼Æ¾Ú¥Î¶q¤w¹F2GB¡A«ö¥»¤½¥qFUP³W½d¼Æ¾Ú¥Î¶q¥H128kbps´£¨ÑªA°È¡A¦Ü¦¸¤ë°_«ì´_¥þ³t¡C·q½Ð¯d·N¡C·PÁÂ±z¨Ï¥ÎHKNet¡A«ÈªA¿Ô¸ß½Ð¬¢+85266404204¡C<br><br>Dear HKNet Oneness SIM customer, please be informed that your HK + China mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact HKNet Oneness SIM service hotline: +85266404204 if any queries.<br><br></body></html>
<br>SendDate: Mon Mar 09 14:56:00 CST 2015
2015-03-09 14:56:02,101 [DEBUG] (DVRSmain.java:2272) - execute SQL : INSERT INTO HUR_SMS_LOG(ID,SEND_NUMBER,MSG,SEND_DATE,RESULT,CREATE_DATE) VALUES(DVRS_SMS_ID.NEXTVAL,'k1988242001@gmail.com','¡iHKNet Oneness SIM ¼Æ¾Ú¥Î¶q³qª¾¡j´L·qªºHKNet Oneness SIM¥Î¤á±z¦n¡A±z¦b­»´ä¤Î¤j³°ªº¼Æ¾Ú¥Î¶q¤w¹F2GB¡A«ö¥»¤½¥qFUP³W½d¼Æ¾Ú¥Î¶q¥H128kbps´£¨ÑªA°È¡A¦Ü¦¸¤ë°_«ì´_¥þ³t¡C·q½Ð¯d·N¡C·PÁÂ±z¨Ï¥ÎHKNet¡A«ÈªA¿Ô¸ß½Ð¬¢+85266404204¡C<br><br>Dear HKNet Oneness SIM customer, please be informed that your HK + China mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact HKNet Oneness SIM service hotline: +85266404204 if any queries.<br><br>',TO_DATE('2015/03/09 14:56:02','yyyy/MM/dd HH24:mi:ss'),'success',SYSDATE)
2015-03-09 14:56:02,101 [DEBUG] (DVRSmain.java:2280) - Total send volume alert SMS 1 ...
2015-03-09 14:56:02,128 [ERROR] (DVRSmain.java:2285) - At sendDayAlertSMS occur SQLException error!
java.sql.BatchUpdateException: §å¦¸§@·~®Éµo¥Í¿ù»~: ORA-00917: missing comma

	at oracle.jdbc.dbaccess.DBError.throwBatchUpdateException(DBError.java:571)
	at oracle.jdbc.dbaccess.DBError.throwBatchUpdateException(DBError.java:626)
	at oracle.jdbc.driver.OracleStatement.executeBatch(OracleStatement.java:6841)
	at program.DVRSmain.sendAlertSMS(DVRSmain.java:2281)
	at program.DVRSmain.process(DVRSmain.java:2991)
	at program.DVRSmain.execute(DVRSmain.java:2878)
	at org.quartz.core.JobRunShell.run(JobRunShell.java:202)
	at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573)
2015-03-09 14:56:02,129 [ERROR] (DVRSmain.java:2480) - Can't send email without receiver!
2015-03-09 14:56:02,130 [ INFO] (DVRSmain.java:2992) - sendAlertSMS execute time :2365
2015-03-09 14:56:02,143 [ INFO] (DVRSmain.java:1639) - insertCurrentMap...
2015-03-09 14:56:02,144 [ INFO] (DVRSmain.java:1648) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 14:56:02,144 [ INFO] (DVRSmain.java:1686) - insertCurrentMapDay...
2015-03-09 14:56:02,144 [ INFO] (DVRSmain.java:1694) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 14:56:02,144 [ INFO] (DVRSmain.java:1544) - updateCurrentMap...
2015-03-09 14:56:02,145 [ INFO] (DVRSmain.java:1555) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 14:56:02,151 [ INFO] (DVRSmain.java:1583) - Execute updateCurrentMap Batch
2015-03-09 14:56:02,167 [ INFO] (DVRSmain.java:1589) - updateCurrentMapDay...
2015-03-09 14:56:02,168 [ INFO] (DVRSmain.java:1599) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 14:56:02,174 [ INFO] (DVRSmain.java:1626) - Execute updateCurrentMapU Batch
2015-03-09 14:56:02,212 [ INFO] (DVRSmain.java:3018) - insert¡®update execute time :82
2015-03-09 14:56:02,212 [ INFO] (DVRSmain.java:3023) - processSuspendNBR execute time :0
2015-03-09 14:56:02,212 [ INFO] (DVRSmain.java:3028) - Program execute time :165974
2015-03-09 14:56:02,212 [ INFO] (DVRSmain.java:1117) - closeConnect1...
2015-03-09 14:56:02,231 [ INFO] (DVRSmain.java:1134) - closeConnect2...
2015-03-09 15:00:22,757 [ INFO] (DVRSmain.java:2853) - RFP Program Start! Mon Mar 09 15:00:22 CST 2015
2015-03-09 15:00:22,882 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 15:00:23,820 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 15:00:23,820 [ INFO] (DVRSmain.java:1018) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 15:00:23,820 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 15:00:24,741 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 15:00:24,741 [ INFO] (DVRSmain.java:1059) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 15:00:24,741 [DEBUG] (DVRSmain.java:2861) - connect success!
2015-03-09 15:00:24,741 [ INFO] (DVRSmain.java:1125) - cancelAutoCommit...
2015-03-09 15:00:24,741 [ INFO] (DVRSmain.java:1127) - set AutoCommit false!
2015-03-09 15:00:24,742 [ INFO] (DVRSmain.java:138) - setMonthDate...
2015-03-09 15:00:24,742 [ INFO] (DVRSmain.java:844) - setIMSItoServiceIDMap...
2015-03-09 15:00:24,742 [ INFO] (DVRSmain.java:888) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 15:00:35,677 [ INFO] (DVRSmain.java:975) - Logger Load Success!
2015-03-09 15:00:35,833 [ INFO] (DVRSmain.java:992) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 15:00:36,036 [ INFO] (DVRSmain.java:2898) - RFP Program Start! Mon Mar 09 15:00:36 CST 2015
2015-03-09 15:00:36,036 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 15:00:37,136 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 15:00:37,136 [ INFO] (DVRSmain.java:1046) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 15:00:37,136 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 15:00:37,497 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 15:00:37,497 [ INFO] (DVRSmain.java:1087) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 15:00:37,497 [DEBUG] (DVRSmain.java:2906) - connect success!
2015-03-09 15:00:37,497 [ INFO] (DVRSmain.java:1153) - cancelAutoCommit...
2015-03-09 15:00:37,497 [ INFO] (DVRSmain.java:1155) - set AutoCommit false!
2015-03-09 15:00:37,497 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 15:00:37,610 [ INFO] (DVRSmain.java:845) - setIMSItoServiceIDMap...
2015-03-09 15:00:37,610 [ INFO] (DVRSmain.java:871) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 15:01:54,061 [ INFO] (DVRSmain.java:2874) - setIMSItoServiceIDMap execute time :89319
2015-03-09 15:01:54,061 [ INFO] (DVRSmain.java:183) - setLastFileID...
2015-03-09 15:01:54,077 [DEBUG] (DVRSmain.java:189) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 15:01:54,109 [ INFO] (DVRSmain.java:195) - Last process file ID :14333
2015-03-09 15:01:54,124 [ INFO] (DVRSmain.java:2879) - setLastFileID execute time :63
2015-03-09 15:01:54,124 [ INFO] (DVRSmain.java:282) - setoldChargeMap...
2015-03-09 15:01:54,140 [ INFO] (DVRSmain.java:2886) - setCurrentMap execute time :16
2015-03-09 15:01:54,140 [ INFO] (DVRSmain.java:457) - setThreshold...
2015-03-09 15:01:54,140 [DEBUG] (DVRSmain.java:464) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 15:01:54,157 [DEBUG] (DVRSmain.java:467) - Set dataRate map...
2015-03-09 15:01:54,275 [ INFO] (DVRSmain.java:2891) - setThreshold execute time :135
2015-03-09 15:01:54,275 [ INFO] (DVRSmain.java:406) - setDataRate...
2015-03-09 15:01:54,290 [DEBUG] (DVRSmain.java:413) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 15:01:54,306 [DEBUG] (DVRSmain.java:416) - Set dataRate map...
2015-03-09 15:01:55,871 [ INFO] (DVRSmain.java:2896) - setDataRate execute time :1596
2015-03-09 15:01:55,871 [ INFO] (DVRSmain.java:785) - setMsisdnMap...
2015-03-09 15:01:55,872 [ INFO] (DVRSmain.java:808) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 15:02:03,564 [ INFO] (DVRSmain.java:2919) - setIMSItoServiceIDMap execute time :85954
2015-03-09 15:02:03,564 [ INFO] (DVRSmain.java:891) - setServiceIDtoImsiMap...
2015-03-09 15:02:03,564 [ INFO] (DVRSmain.java:917) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 15:02:20,488 [ INFO] (DVRSmain.java:2901) - setMsisdnMap execute time :24617
2015-03-09 15:02:20,489 [DEBUG] (DVRSmain.java:747) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 15:02:20,551 [ INFO] (DVRSmain.java:2907) - setIPtoMccmncList execute time :63
2015-03-09 15:02:20,551 [ INFO] (DVRSmain.java:490) - setSERVICEIDtoVLN...
2015-03-09 15:02:20,567 [DEBUG] (DVRSmain.java:498) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 15:02:32,685 [ INFO] (DVRSmain.java:2912) - setSERVICEIDtoVLN execute time :12134
2015-03-09 15:02:32,685 [ INFO] (DVRSmain.java:526) - setVLNtoTADIG...
2015-03-09 15:02:32,686 [DEBUG] (DVRSmain.java:534) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 15:02:34,930 [ INFO] (DVRSmain.java:2917) - setVLNtoTADIG execute time :2245
2015-03-09 15:02:34,930 [ INFO] (DVRSmain.java:560) - setTADIGtoMCCMNC...
2015-03-09 15:02:34,962 [DEBUG] (DVRSmain.java:567) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 15:02:35,352 [ INFO] (DVRSmain.java:2922) - setTADIGtoMCCMNC execute time :422
2015-03-09 15:02:35,352 [ INFO] (DVRSmain.java:593) - setCostomerNumber...
2015-03-09 15:02:35,368 [DEBUG] (DVRSmain.java:600) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 15:02:35,416 [ INFO] (DVRSmain.java:2927) - setCostomerNumber execute time :64
2015-03-09 15:02:35,416 [ INFO] (DVRSmain.java:703) - setAddonData...
2015-03-09 15:02:35,432 [DEBUG] (DVRSmain.java:709) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 15:02:36,151 [ INFO] (DVRSmain.java:2932) - setAddonData execute time :735
2015-03-09 15:02:36,151 [ INFO] (DVRSmain.java:1236) - charge...
2015-03-09 15:02:36,151 [ INFO] (DVRSmain.java:627) - dataCount...
2015-03-09 15:02:36,183 [DEBUG] (DVRSmain.java:637) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 15:02:36,198 [ INFO] (DVRSmain.java:642) - usage count : 0
2015-03-09 15:02:36,214 [ INFO] (DVRSmain.java:663) - defaultRate...
2015-03-09 15:02:36,214 [ INFO] (DVRSmain.java:692) - defaultRate : 0.011 TWD 
2015-03-09 15:02:36,214 [ INFO] (DVRSmain.java:2937) - charge execute time :63
2015-03-09 15:02:36,214 [ INFO] (DVRSmain.java:1716) - sendAlertSMS...
2015-03-09 15:02:36,214 [DEBUG] (DVRSmain.java:1732) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 15:02:36,230 [ INFO] (DVRSmain.java:1740) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 15:02:36,230 [ INFO] (DVRSmain.java:1740) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 15:02:36,230 [ INFO] (DVRSmain.java:1740) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 15:02:36,245 [ INFO] (DVRSmain.java:1740) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 15:02:36,245 [ INFO] (DVRSmain.java:1740) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 15:02:36,245 [ INFO] (DVRSmain.java:1740) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 15:02:36,261 [DEBUG] (DVRSmain.java:1776) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 15:02:36,308 [DEBUG] (DVRSmain.java:1951) - Total send month alert0 ...
2015-03-09 15:02:36,308 [DEBUG] (DVRSmain.java:1952) - Log to table...executeBatch
2015-03-09 15:02:36,323 [DEBUG] (DVRSmain.java:2247) - Total send volume alert SMS 0 ...
2015-03-09 15:02:36,323 [ INFO] (DVRSmain.java:2942) - sendAlertSMS execute time :109
2015-03-09 15:02:36,339 [ INFO] (DVRSmain.java:1611) - insertCurrentMap...
2015-03-09 15:02:36,339 [ INFO] (DVRSmain.java:1620) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 15:02:36,339 [ INFO] (DVRSmain.java:1658) - insertCurrentMapDay...
2015-03-09 15:02:36,339 [ INFO] (DVRSmain.java:1666) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 15:02:36,339 [ INFO] (DVRSmain.java:1516) - updateCurrentMap...
2015-03-09 15:02:36,339 [ INFO] (DVRSmain.java:1527) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 15:02:36,354 [ INFO] (DVRSmain.java:1555) - Execute updateCurrentMap Batch
2015-03-09 15:02:36,370 [ INFO] (DVRSmain.java:1561) - updateCurrentMapDay...
2015-03-09 15:02:36,370 [ INFO] (DVRSmain.java:1571) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 15:02:36,370 [ INFO] (DVRSmain.java:1598) - Execute updateCurrentMapU Batch
2015-03-09 15:02:36,413 [ INFO] (DVRSmain.java:2968) - insert¡®update execute time :90
2015-03-09 15:02:36,413 [ INFO] (DVRSmain.java:2973) - processSuspendNBR execute time :0
2015-03-09 15:02:36,413 [ INFO] (DVRSmain.java:2978) - Program execute time :131672
2015-03-09 15:02:36,413 [ INFO] (DVRSmain.java:1089) - closeConnect1...
2015-03-09 15:02:36,429 [ INFO] (DVRSmain.java:1106) - closeConnect2...
2015-03-09 15:03:10,431 [ INFO] (DVRSmain.java:2924) - setServiceIDtoImsiMap execute time :66867
2015-03-09 15:03:10,431 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 15:03:10,432 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 15:03:10,463 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 15:03:10,478 [ INFO] (DVRSmain.java:2929) - setLastFileID execute time :47
2015-03-09 15:03:10,478 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 15:03:10,494 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 15:03:10,510 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 15:03:10,525 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 15:03:10,525 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 15:03:10,525 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 15:03:10,557 [ INFO] (DVRSmain.java:2936) - setCurrentMap execute time :79
2015-03-09 15:03:10,557 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 15:03:10,557 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 15:03:10,594 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 15:03:10,734 [ INFO] (DVRSmain.java:2941) - setThreshold execute time :177
2015-03-09 15:03:10,734 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 15:03:10,734 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 15:03:10,765 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 15:03:11,942 [ INFO] (DVRSmain.java:2946) - setDataRate execute time :1208
2015-03-09 15:03:11,942 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 15:03:11,958 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 15:03:36,365 [ INFO] (DVRSmain.java:2951) - setMsisdnMap execute time :24423
2015-03-09 15:03:36,366 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 15:03:36,444 [ INFO] (DVRSmain.java:2957) - setIPtoMccmncList execute time :79
2015-03-09 15:03:36,444 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 15:03:36,460 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 15:03:47,531 [ INFO] (DVRSmain.java:2962) - setSERVICEIDtoVLN execute time :11087
2015-03-09 15:03:47,531 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 15:03:47,531 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 15:03:51,639 [ INFO] (DVRSmain.java:2967) - setVLNtoTADIG execute time :4108
2015-03-09 15:03:51,639 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 15:03:51,654 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 15:03:51,952 [ INFO] (DVRSmain.java:2972) - setTADIGtoMCCMNC execute time :313
2015-03-09 15:03:51,952 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 15:03:51,968 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 15:03:51,999 [ INFO] (DVRSmain.java:2977) - setCostomerNumber execute time :47
2015-03-09 15:03:51,999 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 15:03:52,015 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 15:03:52,721 [ INFO] (DVRSmain.java:2982) - setAddonData execute time :722
2015-03-09 15:03:52,721 [ INFO] (DVRSmain.java:1264) - charge...
2015-03-09 15:03:52,721 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 15:03:52,769 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 15:03:52,769 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 15:03:52,784 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 15:03:52,784 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 15:03:52,784 [ INFO] (DVRSmain.java:2987) - charge execute time :63
2015-03-09 15:03:52,784 [ INFO] (DVRSmain.java:1745) - sendAlertSMS...
2015-03-09 15:03:52,784 [DEBUG] (DVRSmain.java:1761) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 15:03:52,800 [ INFO] (DVRSmain.java:1769) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 15:03:52,800 [ INFO] (DVRSmain.java:1769) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 15:03:52,800 [ INFO] (DVRSmain.java:1769) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 15:03:52,801 [ INFO] (DVRSmain.java:1769) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 15:03:52,801 [ INFO] (DVRSmain.java:1769) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 15:03:52,801 [ INFO] (DVRSmain.java:1769) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 15:03:52,803 [DEBUG] (DVRSmain.java:1805) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 15:03:52,881 [DEBUG] (DVRSmain.java:1980) - Total send month alert0 ...
2015-03-09 15:03:52,881 [DEBUG] (DVRSmain.java:1981) - Log to table...executeBatch
2015-03-09 15:03:52,881 [ INFO] (DVRSmain.java:2222) - For 40705 send 2.0GB decrease speed  message !
2015-03-09 15:03:52,896 [ INFO] (Jatool.java:67) - get Properites!
2015-03-09 15:03:52,896 [ INFO] (Jatool.java:67) - Connect to Host : 106.186.120.118
2015-03-09 15:03:52,896 [ INFO] (Jatool.java:67) - port : null
2015-03-09 15:03:52,896 [ INFO] (Jatool.java:67) - use authority : true
2015-03-09 15:03:52,896 [DEBUG] (Jatool.java:69) - Creat mail Session!
2015-03-09 15:03:52,928 [DEBUG] (Jatool.java:69) - set mail content!
2015-03-09 15:03:54,763 [ INFO] (Jatool.java:67) - sending mail from HKNet@sim2travel.com to k1988242001@gmail.com
<br>Subject : Notification on FUP 100% 2GB
<br>Content : <html><body>¡iHKNet Oneness SIM ¼Æ¾Ú¥Î¶q³qª¾¡j´L·qªºHKNet Oneness SIM¥Î¤á±z¦n¡A±z¦b­»´ä¤Î¤j³°ªº¼Æ¾Ú¥Î¶q¤w¹F2GB¡A«ö¥»¤½¥qFUP³W½d¼Æ¾Ú¥Î¶q¥H128kbps´£¨ÑªA°È¡A¦Ü¦¸¤ë°_«ì´_¥þ³t¡C·q½Ð¯d·N¡C·PÁÂ±z¨Ï¥ÎHKNet¡A«ÈªA¿Ô¸ß½Ð¬¢+85266404204¡C<br><br>Dear HKNet Oneness SIM customer, please be informed that your HK + China mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact HKNet Oneness SIM service hotline: +85266404204 if any queries.<br><br></body></html>
<br>SendDate: Mon Mar 09 15:03:52 CST 2015
2015-03-09 15:03:54,764 [ERROR] (DVRSmain.java:2285) - At sendDayAlertSMS occur SQLException error!
java.sql.SQLException: ORA-00917: missing comma

	at oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:134)
	at oracle.jdbc.ttc7.TTIoer.processError(TTIoer.java:289)
	at oracle.jdbc.ttc7.Oall7.receive(Oall7.java:573)
	at oracle.jdbc.ttc7.TTC7Protocol.doOall7(TTC7Protocol.java:1891)
	at oracle.jdbc.ttc7.TTC7Protocol.parseExecuteFetch(TTC7Protocol.java:1093)
	at oracle.jdbc.driver.OracleStatement.executeNonQuery(OracleStatement.java:2047)
	at oracle.jdbc.driver.OracleStatement.doExecuteOther(OracleStatement.java:1940)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:2709)
	at oracle.jdbc.driver.OracleStatement.executeUpdate(OracleStatement.java:796)
	at program.DVRSmain.sendAlertSMS(DVRSmain.java:2271)
	at program.DVRSmain.process(DVRSmain.java:2991)
	at program.DVRSmain.execute(DVRSmain.java:2878)
	at org.quartz.core.JobRunShell.run(JobRunShell.java:202)
	at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573)
2015-03-09 15:03:54,764 [ERROR] (DVRSmain.java:2480) - Can't send email without receiver!
2015-03-09 15:03:54,764 [ INFO] (DVRSmain.java:2992) - sendAlertSMS execute time :1980
2015-03-09 15:03:54,796 [ INFO] (DVRSmain.java:1639) - insertCurrentMap...
2015-03-09 15:03:54,796 [ INFO] (DVRSmain.java:1648) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 15:03:54,796 [ INFO] (DVRSmain.java:1686) - insertCurrentMapDay...
2015-03-09 15:03:54,796 [ INFO] (DVRSmain.java:1694) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 15:03:54,796 [ INFO] (DVRSmain.java:1544) - updateCurrentMap...
2015-03-09 15:03:54,796 [ INFO] (DVRSmain.java:1555) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 15:03:54,796 [ INFO] (DVRSmain.java:1583) - Execute updateCurrentMap Batch
2015-03-09 15:03:54,812 [ INFO] (DVRSmain.java:1589) - updateCurrentMapDay...
2015-03-09 15:03:54,812 [ INFO] (DVRSmain.java:1599) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 15:03:54,813 [ INFO] (DVRSmain.java:1626) - Execute updateCurrentMapU Batch
2015-03-09 15:03:54,861 [ INFO] (DVRSmain.java:3018) - insert¡®update execute time :97
2015-03-09 15:03:54,861 [ INFO] (DVRSmain.java:3023) - processSuspendNBR execute time :0
2015-03-09 15:03:54,861 [ INFO] (DVRSmain.java:3028) - Program execute time :197364
2015-03-09 15:03:54,861 [ INFO] (DVRSmain.java:1117) - closeConnect1...
2015-03-09 15:03:54,893 [ INFO] (DVRSmain.java:1134) - closeConnect2...
2015-03-09 15:22:39,627 [ INFO] (DVRSmain.java:975) - Logger Load Success!
2015-03-09 15:22:39,643 [ INFO] (DVRSmain.java:992) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 15:22:39,770 [ INFO] (DVRSmain.java:2897) - RFP Program Start! Mon Mar 09 15:22:39 CST 2015
2015-03-09 15:22:39,770 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 15:22:40,701 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 15:22:40,701 [ INFO] (DVRSmain.java:1046) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 15:22:40,701 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 15:22:41,063 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 15:22:41,063 [ INFO] (DVRSmain.java:1087) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 15:22:41,063 [DEBUG] (DVRSmain.java:2905) - connect success!
2015-03-09 15:22:41,063 [ INFO] (DVRSmain.java:1153) - cancelAutoCommit...
2015-03-09 15:22:41,063 [ INFO] (DVRSmain.java:1155) - set AutoCommit false!
2015-03-09 15:22:41,063 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 15:22:41,110 [ INFO] (DVRSmain.java:845) - setIMSItoServiceIDMap...
2015-03-09 15:22:41,110 [ INFO] (DVRSmain.java:871) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 15:23:10,810 [ INFO] (DVRSmain.java:2881) - RFP Program Start! Mon Mar 09 15:23:10 CST 2015
2015-03-09 15:23:10,999 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 15:23:11,548 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 15:23:11,548 [ INFO] (DVRSmain.java:1045) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 15:23:11,548 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 15:23:12,190 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 15:23:12,190 [ INFO] (DVRSmain.java:1086) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 15:23:12,190 [DEBUG] (DVRSmain.java:2889) - connect success!
2015-03-09 15:23:12,190 [ INFO] (DVRSmain.java:1152) - cancelAutoCommit...
2015-03-09 15:23:12,190 [ INFO] (DVRSmain.java:1154) - set AutoCommit false!
2015-03-09 15:23:12,191 [ INFO] (DVRSmain.java:138) - setMonthDate...
2015-03-09 15:23:12,191 [ INFO] (DVRSmain.java:844) - setIMSItoServiceIDMap...
2015-03-09 15:23:12,191 [ INFO] (DVRSmain.java:870) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 15:23:50,718 [ INFO] (DVRSmain.java:2918) - setIMSItoServiceIDMap execute time :69608
2015-03-09 15:23:50,718 [ INFO] (DVRSmain.java:891) - setServiceIDtoImsiMap...
2015-03-09 15:23:50,718 [ INFO] (DVRSmain.java:917) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 15:24:26,917 [ INFO] (DVRSmain.java:2902) - setIMSItoServiceIDMap execute time :74726
2015-03-09 15:24:26,917 [ INFO] (DVRSmain.java:890) - setServiceIDtoImsiMap...
2015-03-09 15:24:26,918 [ INFO] (DVRSmain.java:916) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 15:24:47,087 [ INFO] (DVRSmain.java:2923) - setServiceIDtoImsiMap execute time :56369
2015-03-09 15:24:47,087 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 15:24:47,088 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 15:24:47,119 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 15:24:47,134 [ INFO] (DVRSmain.java:2928) - setLastFileID execute time :47
2015-03-09 15:24:47,134 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 15:24:47,134 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 15:24:47,166 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 15:24:47,198 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 15:24:47,198 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 15:24:47,198 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 15:24:47,245 [ INFO] (DVRSmain.java:2935) - setCurrentMap execute time :111
2015-03-09 15:24:47,245 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 15:24:47,260 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 15:24:47,276 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 15:24:47,370 [ INFO] (DVRSmain.java:2940) - setThreshold execute time :125
2015-03-09 15:24:47,370 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 15:24:47,386 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 15:24:47,402 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 15:24:48,521 [ INFO] (DVRSmain.java:2945) - setDataRate execute time :1151
2015-03-09 15:24:48,521 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 15:24:48,522 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 15:25:12,723 [ INFO] (DVRSmain.java:2950) - setMsisdnMap execute time :24202
2015-03-09 15:25:12,731 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 15:25:12,808 [ INFO] (DVRSmain.java:2956) - setIPtoMccmncList execute time :85
2015-03-09 15:25:12,808 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 15:25:12,823 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 15:25:21,478 [ INFO] (DVRSmain.java:2907) - setServiceIDtoImsiMap execute time :54561
2015-03-09 15:25:21,478 [ INFO] (DVRSmain.java:183) - setLastFileID...
2015-03-09 15:25:21,478 [DEBUG] (DVRSmain.java:189) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 15:25:21,510 [ INFO] (DVRSmain.java:195) - Last process file ID :14333
2015-03-09 15:25:21,526 [ INFO] (DVRSmain.java:2912) - setLastFileID execute time :48
2015-03-09 15:25:21,526 [ INFO] (DVRSmain.java:282) - setoldChargeMap...
2015-03-09 15:25:21,526 [ INFO] (DVRSmain.java:2919) - setCurrentMap execute time :0
2015-03-09 15:25:21,526 [ INFO] (DVRSmain.java:457) - setThreshold...
2015-03-09 15:25:21,526 [DEBUG] (DVRSmain.java:464) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 15:25:21,557 [DEBUG] (DVRSmain.java:467) - Set dataRate map...
2015-03-09 15:25:21,650 [ INFO] (DVRSmain.java:2924) - setThreshold execute time :124
2015-03-09 15:25:21,650 [ INFO] (DVRSmain.java:406) - setDataRate...
2015-03-09 15:25:21,650 [DEBUG] (DVRSmain.java:413) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 15:25:21,682 [DEBUG] (DVRSmain.java:416) - Set dataRate map...
2015-03-09 15:25:23,060 [ INFO] (DVRSmain.java:2929) - setDataRate execute time :1410
2015-03-09 15:25:23,060 [ INFO] (DVRSmain.java:785) - setMsisdnMap...
2015-03-09 15:25:23,060 [ INFO] (DVRSmain.java:808) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 15:25:25,350 [ INFO] (DVRSmain.java:2961) - setSERVICEIDtoVLN execute time :12542
2015-03-09 15:25:25,350 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 15:25:25,350 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 15:25:27,989 [ INFO] (DVRSmain.java:2966) - setVLNtoTADIG execute time :2639
2015-03-09 15:25:27,989 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 15:25:27,989 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 15:25:28,339 [ INFO] (DVRSmain.java:2971) - setTADIGtoMCCMNC execute time :350
2015-03-09 15:25:28,339 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 15:25:28,355 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 15:25:28,403 [ INFO] (DVRSmain.java:2976) - setCostomerNumber execute time :64
2015-03-09 15:25:28,403 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 15:25:28,403 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 15:25:29,304 [ INFO] (DVRSmain.java:2981) - setAddonData execute time :901
2015-03-09 15:25:29,304 [ INFO] (DVRSmain.java:1264) - charge...
2015-03-09 15:25:29,304 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 15:25:29,623 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 15:25:29,638 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 15:25:29,654 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 15:25:29,654 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 15:25:29,654 [ INFO] (DVRSmain.java:2986) - charge execute time :350
2015-03-09 15:25:29,654 [ INFO] (DVRSmain.java:1745) - sendAlertSMS...
2015-03-09 15:25:29,654 [DEBUG] (DVRSmain.java:1761) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 15:25:29,685 [ INFO] (DVRSmain.java:1769) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 15:25:29,685 [ INFO] (DVRSmain.java:1769) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 15:25:29,685 [ INFO] (DVRSmain.java:1769) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 15:25:29,685 [ INFO] (DVRSmain.java:1769) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 15:25:29,685 [ INFO] (DVRSmain.java:1769) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 15:25:29,685 [ INFO] (DVRSmain.java:1769) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 15:25:29,701 [DEBUG] (DVRSmain.java:1805) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 15:25:29,748 [DEBUG] (DVRSmain.java:1980) - Total send month alert0 ...
2015-03-09 15:25:29,748 [DEBUG] (DVRSmain.java:1981) - Log to table...executeBatch
2015-03-09 15:25:29,763 [ INFO] (DVRSmain.java:2222) - For 40705 send 2.0GB decrease speed  message !
2015-03-09 15:25:29,794 [ INFO] (Jatool.java:67) - get Properites!
2015-03-09 15:25:29,794 [ INFO] (Jatool.java:67) - Connect to Host : 106.186.120.118
2015-03-09 15:25:29,794 [ INFO] (Jatool.java:67) - port : null
2015-03-09 15:25:29,794 [ INFO] (Jatool.java:67) - use authority : true
2015-03-09 15:25:29,794 [DEBUG] (Jatool.java:69) - Creat mail Session!
2015-03-09 15:25:29,857 [DEBUG] (Jatool.java:69) - set mail content!
2015-03-09 15:25:33,001 [ INFO] (Jatool.java:67) - sending mail from HKNet@sim2travel.com to k1988242001@gmail.com
<br>Subject : Notification on FUP 100% 2GB
<br>Content : <html><body>¡iHKNet Oneness SIM ¼Æ¾Ú¥Î¶q³qª¾¡j´L·qªºHKNet Oneness SIM¥Î¤á±z¦n¡A±z¦b­»´ä¤Î¤j³°ªº¼Æ¾Ú¥Î¶q¤w¹F2GB¡A«ö¥»¤½¥qFUP³W½d¼Æ¾Ú¥Î¶q¥H128kbps´£¨ÑªA°È¡A¦Ü¦¸¤ë°_«ì´_¥þ³t¡C·q½Ð¯d·N¡C·PÁÂ±z¨Ï¥ÎHKNet¡A«ÈªA¿Ô¸ß½Ð¬¢+85266404204¡C<br><br>Dear HKNet Oneness SIM customer, please be informed that your HK + China mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact HKNet Oneness SIM service hotline: +85266404204 if any queries.<br><br></body></html>
<br>SendDate: Mon Mar 09 15:25:29 CST 2015
2015-03-09 15:25:33,080 [DEBUG] (DVRSmain.java:2271) - execute SQL : INSERT INTO HUR_SMS_LOG(ID,SEND_NUMBER,MSG,SEND_DATE,RESULT,CREATE_DATE) VALUES(DVRS_SMS_ID.NEXTVAL,'k1988242001@gmail.com','?iHKNet Oneness SIM ???????q?q???j?L¡Pq??HKNet Oneness SIM????¡Óz?n?A¡Óz?b???????j?¢X?????????q?w?F2GB?A???????qFUP?W?d???????q?H128kbps?????A¢X??A??????¢X_???_???t?C¡Pq??¡Âd¡PN?C¡PP??¡Óz????HKNet?A???A????????%2b85266404204?C<br><br>Dear HKNet Oneness SIM customer, please be informed that your HK + China mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact HKNet Oneness SIM service hotline: %2b85266404204 if any queries.<br><br>',TO_DATE('2015/03/09 15:25:33','yyyy/MM/dd HH24:mi:ss'),'success',SYSDATE)
2015-03-09 15:25:33,080 [DEBUG] (DVRSmain.java:2279) - Total send volume alert SMS 1 ...
2015-03-09 15:25:33,080 [ INFO] (DVRSmain.java:2991) - sendAlertSMS execute time :3426
2015-03-09 15:25:33,111 [ INFO] (DVRSmain.java:1639) - insertCurrentMap...
2015-03-09 15:25:33,111 [ INFO] (DVRSmain.java:1648) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 15:25:33,111 [ INFO] (DVRSmain.java:1686) - insertCurrentMapDay...
2015-03-09 15:25:33,111 [ INFO] (DVRSmain.java:1694) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 15:25:33,111 [ INFO] (DVRSmain.java:1544) - updateCurrentMap...
2015-03-09 15:25:33,111 [ INFO] (DVRSmain.java:1555) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 15:25:33,111 [ INFO] (DVRSmain.java:1583) - Execute updateCurrentMap Batch
2015-03-09 15:25:33,142 [ INFO] (DVRSmain.java:1589) - updateCurrentMapDay...
2015-03-09 15:25:33,142 [ INFO] (DVRSmain.java:1599) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 15:25:33,158 [ INFO] (DVRSmain.java:1626) - Execute updateCurrentMapU Batch
2015-03-09 15:25:33,189 [ INFO] (DVRSmain.java:3017) - insert¡®update execute time :109
2015-03-09 15:25:33,189 [ INFO] (DVRSmain.java:3022) - processSuspendNBR execute time :0
2015-03-09 15:25:33,189 [ INFO] (DVRSmain.java:3027) - Program execute time :172126
2015-03-09 15:25:33,189 [ INFO] (DVRSmain.java:1117) - closeConnect1...
2015-03-09 15:25:33,205 [ INFO] (DVRSmain.java:1134) - closeConnect2...
2015-03-09 15:25:45,256 [ INFO] (DVRSmain.java:2934) - setMsisdnMap execute time :22196
2015-03-09 15:25:45,271 [DEBUG] (DVRSmain.java:747) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 15:25:45,319 [ INFO] (DVRSmain.java:2940) - setIPtoMccmncList execute time :63
2015-03-09 15:25:45,319 [ INFO] (DVRSmain.java:490) - setSERVICEIDtoVLN...
2015-03-09 15:25:45,335 [DEBUG] (DVRSmain.java:498) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 15:25:56,379 [ INFO] (DVRSmain.java:2945) - setSERVICEIDtoVLN execute time :11060
2015-03-09 15:25:56,379 [ INFO] (DVRSmain.java:526) - setVLNtoTADIG...
2015-03-09 15:25:56,380 [DEBUG] (DVRSmain.java:534) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 15:25:58,323 [ INFO] (DVRSmain.java:2950) - setVLNtoTADIG execute time :1944
2015-03-09 15:25:58,323 [ INFO] (DVRSmain.java:560) - setTADIGtoMCCMNC...
2015-03-09 15:25:58,339 [DEBUG] (DVRSmain.java:567) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 15:25:58,719 [ INFO] (DVRSmain.java:2955) - setTADIGtoMCCMNC execute time :396
2015-03-09 15:25:58,719 [ INFO] (DVRSmain.java:593) - setCostomerNumber...
2015-03-09 15:25:58,719 [DEBUG] (DVRSmain.java:600) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 15:25:58,766 [ INFO] (DVRSmain.java:2960) - setCostomerNumber execute time :47
2015-03-09 15:25:58,766 [ INFO] (DVRSmain.java:703) - setAddonData...
2015-03-09 15:25:58,766 [DEBUG] (DVRSmain.java:709) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 15:25:59,475 [ INFO] (DVRSmain.java:2965) - setAddonData execute time :709
2015-03-09 15:25:59,475 [ INFO] (DVRSmain.java:1263) - charge...
2015-03-09 15:25:59,475 [ INFO] (DVRSmain.java:627) - dataCount...
2015-03-09 15:25:59,506 [DEBUG] (DVRSmain.java:637) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 15:25:59,506 [ INFO] (DVRSmain.java:642) - usage count : 0
2015-03-09 15:25:59,522 [ INFO] (DVRSmain.java:663) - defaultRate...
2015-03-09 15:25:59,522 [ INFO] (DVRSmain.java:692) - defaultRate : 0.011 TWD 
2015-03-09 15:25:59,522 [ INFO] (DVRSmain.java:2970) - charge execute time :47
2015-03-09 15:25:59,522 [ INFO] (DVRSmain.java:1743) - sendAlertSMS...
2015-03-09 15:25:59,522 [DEBUG] (DVRSmain.java:1759) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 15:25:59,538 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 15:25:59,538 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 15:25:59,538 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 15:25:59,538 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 15:25:59,538 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 15:25:59,538 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 15:25:59,569 [DEBUG] (DVRSmain.java:1803) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 15:25:59,616 [DEBUG] (DVRSmain.java:1978) - Total send month alert0 ...
2015-03-09 15:25:59,616 [DEBUG] (DVRSmain.java:1979) - Log to table...executeBatch
2015-03-09 15:25:59,631 [DEBUG] (DVRSmain.java:2275) - Total send volume alert SMS 0 ...
2015-03-09 15:25:59,631 [ INFO] (DVRSmain.java:2975) - sendAlertSMS execute time :109
2015-03-09 15:25:59,647 [ INFO] (DVRSmain.java:1638) - insertCurrentMap...
2015-03-09 15:25:59,647 [ INFO] (DVRSmain.java:1647) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 15:25:59,647 [ INFO] (DVRSmain.java:1685) - insertCurrentMapDay...
2015-03-09 15:25:59,647 [ INFO] (DVRSmain.java:1693) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 15:25:59,647 [ INFO] (DVRSmain.java:1543) - updateCurrentMap...
2015-03-09 15:25:59,647 [ INFO] (DVRSmain.java:1554) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 15:25:59,647 [ INFO] (DVRSmain.java:1582) - Execute updateCurrentMap Batch
2015-03-09 15:25:59,662 [ INFO] (DVRSmain.java:1588) - updateCurrentMapDay...
2015-03-09 15:25:59,662 [ INFO] (DVRSmain.java:1598) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 15:25:59,662 [ INFO] (DVRSmain.java:1625) - Execute updateCurrentMapU Batch
2015-03-09 15:25:59,741 [ INFO] (DVRSmain.java:3001) - insert¡®update execute time :110
2015-03-09 15:25:59,741 [ INFO] (DVRSmain.java:3006) - processSuspendNBR execute time :0
2015-03-09 15:25:59,741 [ INFO] (DVRSmain.java:3011) - Program execute time :167551
2015-03-09 15:25:59,741 [ INFO] (DVRSmain.java:1116) - closeConnect1...
2015-03-09 15:25:59,773 [ INFO] (DVRSmain.java:1133) - closeConnect2...
2015-03-09 15:32:55,805 [ INFO] (DVRSmain.java:2885) - RFP Program Start! Mon Mar 09 15:32:55 CST 2015
2015-03-09 15:32:55,914 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 15:32:56,692 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 15:32:56,693 [ INFO] (DVRSmain.java:1045) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 15:32:56,693 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 15:32:57,751 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 15:32:57,751 [ INFO] (DVRSmain.java:1086) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 15:32:57,751 [DEBUG] (DVRSmain.java:2893) - connect success!
2015-03-09 15:32:57,751 [ INFO] (DVRSmain.java:1152) - cancelAutoCommit...
2015-03-09 15:32:57,751 [ INFO] (DVRSmain.java:1154) - set AutoCommit false!
2015-03-09 15:32:57,752 [ INFO] (DVRSmain.java:138) - setMonthDate...
2015-03-09 15:32:57,783 [ INFO] (DVRSmain.java:844) - setIMSItoServiceIDMap...
2015-03-09 15:32:57,799 [ INFO] (DVRSmain.java:870) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 15:34:18,590 [ INFO] (DVRSmain.java:2906) - setIMSItoServiceIDMap execute time :80838
2015-03-09 15:34:18,590 [ INFO] (DVRSmain.java:890) - setServiceIDtoImsiMap...
2015-03-09 15:34:18,590 [ INFO] (DVRSmain.java:916) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 15:35:15,691 [ INFO] (DVRSmain.java:2911) - setServiceIDtoImsiMap execute time :57101
2015-03-09 15:35:15,691 [ INFO] (DVRSmain.java:183) - setLastFileID...
2015-03-09 15:35:15,697 [DEBUG] (DVRSmain.java:189) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 15:35:15,721 [ INFO] (DVRSmain.java:195) - Last process file ID :14333
2015-03-09 15:35:15,726 [ INFO] (DVRSmain.java:2916) - setLastFileID execute time :35
2015-03-09 15:35:15,727 [ INFO] (DVRSmain.java:282) - setoldChargeMap...
2015-03-09 15:35:15,739 [ INFO] (DVRSmain.java:2923) - setCurrentMap execute time :12
2015-03-09 15:35:15,739 [ INFO] (DVRSmain.java:457) - setThreshold...
2015-03-09 15:35:15,745 [DEBUG] (DVRSmain.java:464) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 15:35:15,764 [DEBUG] (DVRSmain.java:467) - Set dataRate map...
2015-03-09 15:35:15,860 [ INFO] (DVRSmain.java:2928) - setThreshold execute time :121
2015-03-09 15:35:15,860 [ INFO] (DVRSmain.java:406) - setDataRate...
2015-03-09 15:35:15,866 [DEBUG] (DVRSmain.java:413) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 15:35:15,887 [DEBUG] (DVRSmain.java:416) - Set dataRate map...
2015-03-09 15:35:17,037 [ INFO] (DVRSmain.java:2933) - setDataRate execute time :1177
2015-03-09 15:35:17,037 [ INFO] (DVRSmain.java:785) - setMsisdnMap...
2015-03-09 15:35:17,056 [ INFO] (DVRSmain.java:808) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 15:35:43,620 [ INFO] (DVRSmain.java:2938) - setMsisdnMap execute time :26583
2015-03-09 15:35:43,626 [DEBUG] (DVRSmain.java:747) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 15:35:43,679 [ INFO] (DVRSmain.java:2944) - setIPtoMccmncList execute time :59
2015-03-09 15:35:43,679 [ INFO] (DVRSmain.java:490) - setSERVICEIDtoVLN...
2015-03-09 15:35:43,686 [DEBUG] (DVRSmain.java:498) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 15:35:56,455 [ INFO] (DVRSmain.java:2949) - setSERVICEIDtoVLN execute time :12776
2015-03-09 15:35:56,456 [ INFO] (DVRSmain.java:526) - setVLNtoTADIG...
2015-03-09 15:35:56,462 [DEBUG] (DVRSmain.java:534) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 15:35:58,462 [ INFO] (DVRSmain.java:2954) - setVLNtoTADIG execute time :2005
2015-03-09 15:35:58,462 [ INFO] (DVRSmain.java:560) - setTADIGtoMCCMNC...
2015-03-09 15:35:58,468 [DEBUG] (DVRSmain.java:567) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 15:35:58,766 [ INFO] (DVRSmain.java:2959) - setTADIGtoMCCMNC execute time :304
2015-03-09 15:35:58,766 [ INFO] (DVRSmain.java:593) - setCostomerNumber...
2015-03-09 15:35:58,772 [DEBUG] (DVRSmain.java:600) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 15:35:58,811 [ INFO] (DVRSmain.java:2964) - setCostomerNumber execute time :45
2015-03-09 15:35:58,811 [ INFO] (DVRSmain.java:703) - setAddonData...
2015-03-09 15:35:58,816 [DEBUG] (DVRSmain.java:709) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 15:35:59,540 [ INFO] (DVRSmain.java:2969) - setAddonData execute time :729
2015-03-09 15:35:59,540 [ INFO] (DVRSmain.java:1263) - charge...
2015-03-09 15:35:59,540 [ INFO] (DVRSmain.java:627) - dataCount...
2015-03-09 15:35:59,566 [DEBUG] (DVRSmain.java:637) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 15:35:59,572 [ INFO] (DVRSmain.java:642) - usage count : 0
2015-03-09 15:35:59,578 [ INFO] (DVRSmain.java:663) - defaultRate...
2015-03-09 15:35:59,578 [ INFO] (DVRSmain.java:692) - defaultRate : 0.011 TWD 
2015-03-09 15:35:59,578 [ INFO] (DVRSmain.java:2974) - charge execute time :38
2015-03-09 15:35:59,578 [ INFO] (DVRSmain.java:1743) - sendAlertSMS...
2015-03-09 15:35:59,584 [DEBUG] (DVRSmain.java:1759) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 15:35:59,603 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 15:35:59,603 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 15:35:59,604 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 15:35:59,604 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 15:35:59,604 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 15:35:59,604 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 15:35:59,620 [DEBUG] (DVRSmain.java:1803) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 15:35:59,672 [DEBUG] (DVRSmain.java:1978) - Total send month alert0 ...
2015-03-09 15:35:59,672 [DEBUG] (DVRSmain.java:1979) - Log to table...executeBatch
2015-03-09 15:35:59,688 [DEBUG] (DVRSmain.java:2275) - Total send volume alert SMS 0 ...
2015-03-09 15:35:59,711 [ INFO] (DVRSmain.java:2979) - sendAlertSMS execute time :133
2015-03-09 15:35:59,725 [ INFO] (DVRSmain.java:1638) - insertCurrentMap...
2015-03-09 15:35:59,725 [ INFO] (DVRSmain.java:1647) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 15:35:59,725 [ INFO] (DVRSmain.java:1685) - insertCurrentMapDay...
2015-03-09 15:35:59,725 [ INFO] (DVRSmain.java:1693) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 15:35:59,725 [ INFO] (DVRSmain.java:1543) - updateCurrentMap...
2015-03-09 15:35:59,725 [ INFO] (DVRSmain.java:1554) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 15:35:59,731 [ INFO] (DVRSmain.java:1582) - Execute updateCurrentMap Batch
2015-03-09 15:35:59,751 [ INFO] (DVRSmain.java:1588) - updateCurrentMapDay...
2015-03-09 15:35:59,752 [ INFO] (DVRSmain.java:1598) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 15:35:59,759 [ INFO] (DVRSmain.java:1625) - Execute updateCurrentMapU Batch
2015-03-09 15:35:59,848 [ INFO] (DVRSmain.java:3005) - insert¡®update execute time :137
2015-03-09 15:35:59,849 [ INFO] (DVRSmain.java:3010) - processSuspendNBR execute time :0
2015-03-09 15:35:59,849 [ INFO] (DVRSmain.java:3015) - Program execute time :182098
2015-03-09 15:35:59,849 [ INFO] (DVRSmain.java:1116) - closeConnect1...
2015-03-09 15:35:59,860 [ INFO] (DVRSmain.java:1133) - closeConnect2...
2015-03-09 15:44:19,347 [ INFO] (DVRSmain.java:2898) - RFP Program Start! Mon Mar 09 15:44:19 CST 2015
2015-03-09 15:44:21,574 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 15:44:24,087 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 15:44:24,119 [ INFO] (DVRSmain.java:1046) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 15:44:24,120 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 15:44:25,244 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 15:44:25,245 [ INFO] (DVRSmain.java:1087) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 15:44:25,245 [DEBUG] (DVRSmain.java:2906) - connect success!
2015-03-09 15:44:25,245 [ INFO] (DVRSmain.java:1153) - cancelAutoCommit...
2015-03-09 15:44:25,245 [ INFO] (DVRSmain.java:1155) - set AutoCommit false!
2015-03-09 15:44:25,252 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 15:44:25,252 [ INFO] (DVRSmain.java:845) - setIMSItoServiceIDMap...
2015-03-09 15:44:25,258 [ INFO] (DVRSmain.java:871) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 15:45:37,850 [ INFO] (DVRSmain.java:2919) - setIMSItoServiceIDMap execute time :72598
2015-03-09 15:45:37,850 [ INFO] (DVRSmain.java:891) - setServiceIDtoImsiMap...
2015-03-09 15:45:37,850 [ INFO] (DVRSmain.java:917) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 15:46:57,865 [ INFO] (DVRSmain.java:2924) - setServiceIDtoImsiMap execute time :80015
2015-03-09 15:46:57,865 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 15:46:57,865 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 15:46:57,897 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 15:46:57,897 [ INFO] (DVRSmain.java:2929) - setLastFileID execute time :32
2015-03-09 15:46:57,897 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 15:46:57,913 [ INFO] (DVRSmain.java:2936) - setCurrentMap execute time :16
2015-03-09 15:46:57,913 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 15:46:57,928 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 15:46:57,944 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 15:46:58,069 [ INFO] (DVRSmain.java:2941) - setThreshold execute time :156
2015-03-09 15:46:58,069 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 15:46:58,084 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 15:46:58,100 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 15:46:59,146 [ INFO] (DVRSmain.java:2946) - setDataRate execute time :1077
2015-03-09 15:46:59,147 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 15:46:59,147 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 15:47:21,145 [ INFO] (DVRSmain.java:2951) - setMsisdnMap execute time :21999
2015-03-09 15:47:21,145 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 15:47:21,193 [ INFO] (DVRSmain.java:2957) - setIPtoMccmncList execute time :48
2015-03-09 15:47:21,193 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 15:47:21,209 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 15:47:32,518 [ INFO] (DVRSmain.java:2962) - setSERVICEIDtoVLN execute time :11325
2015-03-09 15:47:32,518 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 15:47:32,533 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 15:47:34,476 [ INFO] (DVRSmain.java:2967) - setVLNtoTADIG execute time :1958
2015-03-09 15:47:34,476 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 15:47:34,476 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 15:47:34,774 [ INFO] (DVRSmain.java:2972) - setTADIGtoMCCMNC execute time :298
2015-03-09 15:47:34,774 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 15:47:34,774 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 15:47:34,821 [ INFO] (DVRSmain.java:2977) - setCostomerNumber execute time :47
2015-03-09 15:47:34,821 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 15:47:34,821 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 15:47:35,492 [ INFO] (DVRSmain.java:2982) - setAddonData execute time :671
2015-03-09 15:47:35,492 [ INFO] (DVRSmain.java:1264) - charge...
2015-03-09 15:47:35,492 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 15:47:35,524 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 15:47:35,524 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 15:47:35,524 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 15:47:35,524 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 15:47:35,524 [ INFO] (DVRSmain.java:2987) - charge execute time :32
2015-03-09 15:47:35,524 [ INFO] (DVRSmain.java:1745) - sendAlertSMS...
2015-03-09 15:47:35,539 [DEBUG] (DVRSmain.java:1761) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 15:47:35,555 [ INFO] (DVRSmain.java:1769) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 15:47:35,555 [ INFO] (DVRSmain.java:1769) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 15:47:35,555 [ INFO] (DVRSmain.java:1769) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 15:47:35,555 [ INFO] (DVRSmain.java:1769) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 15:47:35,555 [ INFO] (DVRSmain.java:1769) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 15:47:35,555 [ INFO] (DVRSmain.java:1769) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 15:47:35,571 [DEBUG] (DVRSmain.java:1805) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 15:47:35,617 [DEBUG] (DVRSmain.java:1980) - Total send month alert0 ...
2015-03-09 15:47:35,617 [DEBUG] (DVRSmain.java:1981) - Log to table...executeBatch
2015-03-09 15:47:35,633 [DEBUG] (DVRSmain.java:2280) - Total send volume alert SMS 0 ...
2015-03-09 15:47:35,633 [ INFO] (DVRSmain.java:2992) - sendAlertSMS execute time :109
2015-03-09 15:47:35,649 [ INFO] (DVRSmain.java:1639) - insertCurrentMap...
2015-03-09 15:47:35,649 [ INFO] (DVRSmain.java:1648) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 15:47:35,649 [ INFO] (DVRSmain.java:1686) - insertCurrentMapDay...
2015-03-09 15:47:35,649 [ INFO] (DVRSmain.java:1694) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 15:47:35,649 [ INFO] (DVRSmain.java:1544) - updateCurrentMap...
2015-03-09 15:47:35,649 [ INFO] (DVRSmain.java:1555) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 15:47:35,649 [ INFO] (DVRSmain.java:1583) - Execute updateCurrentMap Batch
2015-03-09 15:47:35,664 [ INFO] (DVRSmain.java:1589) - updateCurrentMapDay...
2015-03-09 15:47:35,664 [ INFO] (DVRSmain.java:1599) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 15:47:35,680 [ INFO] (DVRSmain.java:1626) - Execute updateCurrentMapU Batch
2015-03-09 15:47:35,711 [ INFO] (DVRSmain.java:3018) - insert¡®update execute time :78
2015-03-09 15:47:35,711 [ INFO] (DVRSmain.java:3023) - processSuspendNBR execute time :0
2015-03-09 15:47:35,711 [ INFO] (DVRSmain.java:3028) - Program execute time :190466
2015-03-09 15:47:35,711 [ INFO] (DVRSmain.java:1117) - closeConnect1...
2015-03-09 15:47:35,727 [ INFO] (DVRSmain.java:1134) - closeConnect2...
2015-03-09 15:53:14,760 [ INFO] (DVRSmain.java:2898) - RFP Program Start! Mon Mar 09 15:53:14 CST 2015
2015-03-09 15:53:15,182 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 15:53:16,752 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 15:53:16,752 [ INFO] (DVRSmain.java:1046) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 15:53:16,752 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 15:53:17,342 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 15:53:17,342 [ INFO] (DVRSmain.java:1087) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 15:53:17,342 [DEBUG] (DVRSmain.java:2906) - connect success!
2015-03-09 15:53:17,342 [ INFO] (DVRSmain.java:1153) - cancelAutoCommit...
2015-03-09 15:53:17,342 [ INFO] (DVRSmain.java:1155) - set AutoCommit false!
2015-03-09 15:53:17,359 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 15:53:17,368 [ INFO] (DVRSmain.java:845) - setIMSItoServiceIDMap...
2015-03-09 15:53:17,378 [ INFO] (DVRSmain.java:871) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 15:54:32,751 [ INFO] (DVRSmain.java:2919) - setIMSItoServiceIDMap execute time :75388
2015-03-09 15:54:32,752 [ INFO] (DVRSmain.java:891) - setServiceIDtoImsiMap...
2015-03-09 15:54:32,764 [ INFO] (DVRSmain.java:917) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 15:55:26,156 [ INFO] (DVRSmain.java:2924) - setServiceIDtoImsiMap execute time :53405
2015-03-09 15:55:26,156 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 15:55:26,157 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 15:55:26,188 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 15:55:26,203 [ INFO] (DVRSmain.java:2929) - setLastFileID execute time :47
2015-03-09 15:55:26,203 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 15:55:26,203 [ INFO] (DVRSmain.java:2936) - setCurrentMap execute time :0
2015-03-09 15:55:26,203 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 15:55:26,203 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 15:55:26,235 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 15:55:26,328 [ INFO] (DVRSmain.java:2941) - setThreshold execute time :125
2015-03-09 15:55:26,328 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 15:55:26,328 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 15:55:26,344 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 15:55:27,425 [ INFO] (DVRSmain.java:2946) - setDataRate execute time :1097
2015-03-09 15:55:27,425 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 15:55:27,426 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 15:55:50,903 [ INFO] (DVRSmain.java:2951) - setMsisdnMap execute time :23478
2015-03-09 15:55:50,903 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 15:55:50,966 [ INFO] (DVRSmain.java:2957) - setIPtoMccmncList execute time :63
2015-03-09 15:55:50,966 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 15:55:50,981 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 15:56:02,241 [ INFO] (DVRSmain.java:2962) - setSERVICEIDtoVLN execute time :11275
2015-03-09 15:56:02,241 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 15:56:02,241 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 15:56:04,244 [ INFO] (DVRSmain.java:2967) - setVLNtoTADIG execute time :2003
2015-03-09 15:56:04,244 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 15:56:04,244 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 15:56:04,604 [ INFO] (DVRSmain.java:2972) - setTADIGtoMCCMNC execute time :360
2015-03-09 15:56:04,605 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 15:56:04,611 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 15:56:04,650 [ INFO] (DVRSmain.java:2977) - setCostomerNumber execute time :45
2015-03-09 15:56:04,650 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 15:56:04,655 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 15:56:05,421 [ INFO] (DVRSmain.java:2982) - setAddonData execute time :771
2015-03-09 15:56:05,421 [ INFO] (DVRSmain.java:1264) - charge...
2015-03-09 15:56:05,421 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 15:56:05,422 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 15:56:05,453 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 15:56:05,453 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 15:56:05,453 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 15:56:05,453 [ INFO] (DVRSmain.java:2987) - charge execute time :32
2015-03-09 15:56:05,453 [ INFO] (DVRSmain.java:1745) - sendAlertSMS...
2015-03-09 15:56:05,453 [DEBUG] (DVRSmain.java:1761) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 15:56:05,484 [ INFO] (DVRSmain.java:1769) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 15:56:05,484 [ INFO] (DVRSmain.java:1769) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 15:56:05,484 [ INFO] (DVRSmain.java:1769) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 15:56:05,484 [ INFO] (DVRSmain.java:1769) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 15:56:05,484 [ INFO] (DVRSmain.java:1769) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 15:56:05,484 [ INFO] (DVRSmain.java:1769) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 15:56:05,515 [DEBUG] (DVRSmain.java:1805) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 15:56:05,562 [DEBUG] (DVRSmain.java:1980) - Total send month alert0 ...
2015-03-09 15:56:05,562 [DEBUG] (DVRSmain.java:1981) - Log to table...executeBatch
2015-03-09 15:56:05,593 [DEBUG] (DVRSmain.java:2280) - Total send volume alert SMS 0 ...
2015-03-09 15:56:05,593 [ INFO] (DVRSmain.java:2992) - sendAlertSMS execute time :140
2015-03-09 15:56:05,609 [ INFO] (DVRSmain.java:1639) - insertCurrentMap...
2015-03-09 15:56:05,609 [ INFO] (DVRSmain.java:1648) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 15:56:05,609 [ INFO] (DVRSmain.java:1686) - insertCurrentMapDay...
2015-03-09 15:56:05,609 [ INFO] (DVRSmain.java:1694) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 15:56:05,609 [ INFO] (DVRSmain.java:1544) - updateCurrentMap...
2015-03-09 15:56:05,609 [ INFO] (DVRSmain.java:1555) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 15:56:05,625 [ INFO] (DVRSmain.java:1583) - Execute updateCurrentMap Batch
2015-03-09 15:56:05,625 [ INFO] (DVRSmain.java:1589) - updateCurrentMapDay...
2015-03-09 15:56:05,626 [ INFO] (DVRSmain.java:1599) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 15:56:05,626 [ INFO] (DVRSmain.java:1626) - Execute updateCurrentMapU Batch
2015-03-09 15:56:05,673 [ INFO] (DVRSmain.java:3018) - insert¡®update execute time :80
2015-03-09 15:56:05,673 [ INFO] (DVRSmain.java:3023) - processSuspendNBR execute time :0
2015-03-09 15:56:05,673 [ INFO] (DVRSmain.java:3028) - Program execute time :168331
2015-03-09 15:56:05,673 [ INFO] (DVRSmain.java:1117) - closeConnect1...
2015-03-09 15:56:05,689 [ INFO] (DVRSmain.java:1134) - closeConnect2...
2015-03-09 16:00:23,382 [ INFO] (DVRSmain.java:2853) - RFP Program Start! Mon Mar 09 16:00:23 CST 2015
2015-03-09 16:00:23,666 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:00:25,112 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:00:25,128 [ INFO] (DVRSmain.java:1018) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 16:00:25,128 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:00:26,254 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:00:26,254 [ INFO] (DVRSmain.java:1059) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 16:00:26,254 [DEBUG] (DVRSmain.java:2861) - connect success!
2015-03-09 16:00:26,255 [ INFO] (DVRSmain.java:1125) - cancelAutoCommit...
2015-03-09 16:00:26,255 [ INFO] (DVRSmain.java:1127) - set AutoCommit false!
2015-03-09 16:00:26,286 [ INFO] (DVRSmain.java:138) - setMonthDate...
2015-03-09 16:00:26,286 [ INFO] (DVRSmain.java:844) - setIMSItoServiceIDMap...
2015-03-09 16:00:26,308 [ INFO] (DVRSmain.java:888) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 16:00:36,855 [ INFO] (DVRSmain.java:2898) - RFP Program Start! Mon Mar 09 16:00:36 CST 2015
2015-03-09 16:00:37,495 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:00:38,671 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:00:38,671 [ INFO] (DVRSmain.java:1046) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 16:00:38,672 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:00:39,766 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:00:39,766 [ INFO] (DVRSmain.java:1087) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 16:00:39,766 [DEBUG] (DVRSmain.java:2906) - connect success!
2015-03-09 16:00:39,766 [ INFO] (DVRSmain.java:1153) - cancelAutoCommit...
2015-03-09 16:00:39,766 [ INFO] (DVRSmain.java:1155) - set AutoCommit false!
2015-03-09 16:00:39,767 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 16:00:39,815 [ INFO] (DVRSmain.java:845) - setIMSItoServiceIDMap...
2015-03-09 16:00:39,815 [ INFO] (DVRSmain.java:871) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 16:02:54,749 [ INFO] (DVRSmain.java:2874) - setIMSItoServiceIDMap execute time :148463
2015-03-09 16:02:54,780 [ INFO] (DVRSmain.java:183) - setLastFileID...
2015-03-09 16:02:54,796 [DEBUG] (DVRSmain.java:189) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 16:02:55,265 [ INFO] (DVRSmain.java:195) - Last process file ID :14333
2015-03-09 16:02:55,265 [ INFO] (DVRSmain.java:2879) - setLastFileID execute time :516
2015-03-09 16:02:55,265 [ INFO] (DVRSmain.java:282) - setoldChargeMap...
2015-03-09 16:02:55,311 [ INFO] (DVRSmain.java:2886) - setCurrentMap execute time :46
2015-03-09 16:02:55,311 [ INFO] (DVRSmain.java:457) - setThreshold...
2015-03-09 16:02:55,327 [DEBUG] (DVRSmain.java:464) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 16:02:55,374 [DEBUG] (DVRSmain.java:467) - Set dataRate map...
2015-03-09 16:02:55,577 [ INFO] (DVRSmain.java:2891) - setThreshold execute time :266
2015-03-09 16:02:55,577 [ INFO] (DVRSmain.java:406) - setDataRate...
2015-03-09 16:02:55,592 [DEBUG] (DVRSmain.java:413) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 16:02:55,639 [DEBUG] (DVRSmain.java:416) - Set dataRate map...
2015-03-09 16:02:57,558 [ INFO] (DVRSmain.java:2896) - setDataRate execute time :1981
2015-03-09 16:02:57,559 [ INFO] (DVRSmain.java:785) - setMsisdnMap...
2015-03-09 16:02:57,590 [ INFO] (DVRSmain.java:808) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 16:02:58,885 [ INFO] (DVRSmain.java:2919) - setIMSItoServiceIDMap execute time :139071
2015-03-09 16:02:58,932 [ INFO] (DVRSmain.java:891) - setServiceIDtoImsiMap...
2015-03-09 16:02:58,933 [ INFO] (DVRSmain.java:917) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 16:03:54,461 [ INFO] (DVRSmain.java:2901) - setMsisdnMap execute time :56903
2015-03-09 16:03:54,477 [DEBUG] (DVRSmain.java:747) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 16:03:54,525 [ INFO] (DVRSmain.java:2907) - setIPtoMccmncList execute time :64
2015-03-09 16:03:54,525 [ INFO] (DVRSmain.java:490) - setSERVICEIDtoVLN...
2015-03-09 16:03:54,540 [DEBUG] (DVRSmain.java:498) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 16:04:03,623 [ INFO] (DVRSmain.java:2924) - setServiceIDtoImsiMap execute time :64691
2015-03-09 16:04:03,623 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 16:04:03,624 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 16:04:03,687 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 16:04:03,687 [ INFO] (DVRSmain.java:2929) - setLastFileID execute time :64
2015-03-09 16:04:03,687 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 16:04:03,702 [ INFO] (DVRSmain.java:2936) - setCurrentMap execute time :15
2015-03-09 16:04:03,702 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 16:04:03,702 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 16:04:03,734 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 16:04:03,843 [ INFO] (DVRSmain.java:2941) - setThreshold execute time :141
2015-03-09 16:04:03,843 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 16:04:03,843 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 16:04:03,874 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 16:04:05,060 [ INFO] (DVRSmain.java:2946) - setDataRate execute time :1217
2015-03-09 16:04:05,060 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 16:04:05,061 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 16:04:06,964 [ INFO] (DVRSmain.java:2912) - setSERVICEIDtoVLN execute time :12439
2015-03-09 16:04:06,964 [ INFO] (DVRSmain.java:526) - setVLNtoTADIG...
2015-03-09 16:04:06,965 [DEBUG] (DVRSmain.java:534) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 16:04:09,106 [ INFO] (DVRSmain.java:2917) - setVLNtoTADIG execute time :2142
2015-03-09 16:04:09,106 [ INFO] (DVRSmain.java:560) - setTADIGtoMCCMNC...
2015-03-09 16:04:09,106 [DEBUG] (DVRSmain.java:567) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 16:04:09,419 [ INFO] (DVRSmain.java:2922) - setTADIGtoMCCMNC execute time :313
2015-03-09 16:04:09,419 [ INFO] (DVRSmain.java:593) - setCostomerNumber...
2015-03-09 16:04:09,419 [DEBUG] (DVRSmain.java:600) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 16:04:09,466 [ INFO] (DVRSmain.java:2927) - setCostomerNumber execute time :47
2015-03-09 16:04:09,466 [ INFO] (DVRSmain.java:703) - setAddonData...
2015-03-09 16:04:09,466 [DEBUG] (DVRSmain.java:709) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 16:04:10,246 [ INFO] (DVRSmain.java:2932) - setAddonData execute time :780
2015-03-09 16:04:10,246 [ INFO] (DVRSmain.java:1236) - charge...
2015-03-09 16:04:10,246 [ INFO] (DVRSmain.java:627) - dataCount...
2015-03-09 16:04:10,278 [DEBUG] (DVRSmain.java:637) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 16:04:10,278 [ INFO] (DVRSmain.java:642) - usage count : 0
2015-03-09 16:04:10,293 [ INFO] (DVRSmain.java:663) - defaultRate...
2015-03-09 16:04:10,293 [ INFO] (DVRSmain.java:692) - defaultRate : 0.011 TWD 
2015-03-09 16:04:10,293 [ INFO] (DVRSmain.java:2937) - charge execute time :47
2015-03-09 16:04:10,293 [ INFO] (DVRSmain.java:1716) - sendAlertSMS...
2015-03-09 16:04:10,309 [DEBUG] (DVRSmain.java:1732) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 16:04:10,340 [ INFO] (DVRSmain.java:1740) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:04:10,340 [ INFO] (DVRSmain.java:1740) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:04:10,340 [ INFO] (DVRSmain.java:1740) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:04:10,340 [ INFO] (DVRSmain.java:1740) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:04:10,340 [ INFO] (DVRSmain.java:1740) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:04:10,340 [ INFO] (DVRSmain.java:1740) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:04:10,356 [DEBUG] (DVRSmain.java:1776) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 16:04:11,061 [DEBUG] (DVRSmain.java:1951) - Total send month alert0 ...
2015-03-09 16:04:11,061 [DEBUG] (DVRSmain.java:1952) - Log to table...executeBatch
2015-03-09 16:04:11,076 [DEBUG] (DVRSmain.java:2247) - Total send volume alert SMS 0 ...
2015-03-09 16:04:11,092 [ INFO] (DVRSmain.java:2942) - sendAlertSMS execute time :799
2015-03-09 16:04:11,092 [ INFO] (DVRSmain.java:1611) - insertCurrentMap...
2015-03-09 16:04:11,092 [ INFO] (DVRSmain.java:1620) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 16:04:11,092 [ INFO] (DVRSmain.java:1658) - insertCurrentMapDay...
2015-03-09 16:04:11,092 [ INFO] (DVRSmain.java:1666) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 16:04:11,108 [ INFO] (DVRSmain.java:1516) - updateCurrentMap...
2015-03-09 16:04:11,108 [ INFO] (DVRSmain.java:1527) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 16:04:11,123 [ INFO] (DVRSmain.java:1555) - Execute updateCurrentMap Batch
2015-03-09 16:04:11,139 [ INFO] (DVRSmain.java:1561) - updateCurrentMapDay...
2015-03-09 16:04:11,139 [ INFO] (DVRSmain.java:1571) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 16:04:11,139 [ INFO] (DVRSmain.java:1598) - Execute updateCurrentMapU Batch
2015-03-09 16:04:11,170 [ INFO] (DVRSmain.java:2968) - insert¡®update execute time :78
2015-03-09 16:04:11,170 [ INFO] (DVRSmain.java:2973) - processSuspendNBR execute time :0
2015-03-09 16:04:11,170 [ INFO] (DVRSmain.java:2978) - Program execute time :224915
2015-03-09 16:04:11,170 [ INFO] (DVRSmain.java:1089) - closeConnect1...
2015-03-09 16:04:11,186 [ INFO] (DVRSmain.java:1106) - closeConnect2...
2015-03-09 16:04:27,914 [ INFO] (DVRSmain.java:2951) - setMsisdnMap execute time :22854
2015-03-09 16:04:27,915 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 16:04:27,978 [ INFO] (DVRSmain.java:2957) - setIPtoMccmncList execute time :64
2015-03-09 16:04:27,978 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 16:04:27,993 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 16:04:41,929 [ INFO] (DVRSmain.java:2962) - setSERVICEIDtoVLN execute time :13951
2015-03-09 16:04:41,929 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 16:04:41,961 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 16:04:44,919 [ INFO] (DVRSmain.java:2967) - setVLNtoTADIG execute time :2990
2015-03-09 16:04:44,919 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 16:04:44,919 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 16:04:45,295 [ INFO] (DVRSmain.java:2972) - setTADIGtoMCCMNC execute time :376
2015-03-09 16:04:45,295 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 16:04:45,310 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 16:04:45,669 [ INFO] (DVRSmain.java:2977) - setCostomerNumber execute time :374
2015-03-09 16:04:45,669 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 16:04:45,669 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 16:04:46,667 [ INFO] (DVRSmain.java:2982) - setAddonData execute time :998
2015-03-09 16:04:46,667 [ INFO] (DVRSmain.java:1264) - charge...
2015-03-09 16:04:46,667 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 16:04:46,668 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 16:04:46,700 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 16:04:46,700 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 16:04:46,700 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 16:04:46,700 [ INFO] (DVRSmain.java:2987) - charge execute time :33
2015-03-09 16:04:46,700 [ INFO] (DVRSmain.java:1745) - sendAlertSMS...
2015-03-09 16:04:46,715 [DEBUG] (DVRSmain.java:1761) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 16:04:46,731 [ INFO] (DVRSmain.java:1769) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:04:46,731 [ INFO] (DVRSmain.java:1769) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:04:46,731 [ INFO] (DVRSmain.java:1769) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:04:46,731 [ INFO] (DVRSmain.java:1769) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:04:46,731 [ INFO] (DVRSmain.java:1769) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:04:46,731 [ INFO] (DVRSmain.java:1769) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:04:46,746 [DEBUG] (DVRSmain.java:1805) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 16:04:46,809 [DEBUG] (DVRSmain.java:1980) - Total send month alert0 ...
2015-03-09 16:04:46,809 [DEBUG] (DVRSmain.java:1981) - Log to table...executeBatch
2015-03-09 16:04:46,809 [ INFO] (DVRSmain.java:2222) - For 40705 send 2.0GB decrease speed  message !
2015-03-09 16:04:46,809 [ INFO] (Jatool.java:67) - get Properites!
2015-03-09 16:04:46,809 [ INFO] (Jatool.java:67) - Connect to Host : 106.186.120.118
2015-03-09 16:04:46,809 [ INFO] (Jatool.java:67) - port : null
2015-03-09 16:04:46,809 [ INFO] (Jatool.java:67) - use authority : true
2015-03-09 16:04:46,809 [DEBUG] (Jatool.java:69) - Creat mail Session!
2015-03-09 16:04:47,418 [DEBUG] (Jatool.java:69) - set mail content!
2015-03-09 16:04:49,557 [ INFO] (Jatool.java:67) - sending mail from HKNet@sim2travel.com to k1988242001@gmail.com
<br>Subject : Notification on FUP 100% 2GB
<br>Content : <html><body>¡iHKNet Oneness SIM ¼Æ¾Ú¥Î¶q³qª¾¡j´L·qªºHKNet Oneness SIM¥Î¤á±z¦n¡A±z¦b­»´ä¤Î¤j³°ªº¼Æ¾Ú¥Î¶q¤w¹F2GB¡A«ö¥»¤½¥qFUP³W½d¼Æ¾Ú¥Î¶q¥H128kbps´£¨ÑªA°È¡A¦Ü¦¸¤ë°_«ì´_¥þ³t¡C·q½Ð¯d·N¡C·PÁÂ±z¨Ï¥ÎHKNet¡A«ÈªA¿Ô¸ß½Ð¬¢+85266404204¡C<br><br>Dear HKNet Oneness SIM customer, please be informed that your HK + China mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact HKNet Oneness SIM service hotline: +85266404204 if any queries.<br><br></body></html>
<br>SendDate: Mon Mar 09 16:04:47 CST 2015
2015-03-09 16:04:49,590 [ERROR] (DVRSmain.java:2285) - At sendDayAlertSMS occur SQLException error!
java.sql.SQLException: ORA-00917: missing comma

	at oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:134)
	at oracle.jdbc.ttc7.TTIoer.processError(TTIoer.java:289)
	at oracle.jdbc.ttc7.Oall7.receive(Oall7.java:573)
	at oracle.jdbc.ttc7.TTC7Protocol.doOall7(TTC7Protocol.java:1891)
	at oracle.jdbc.ttc7.TTC7Protocol.parseExecuteFetch(TTC7Protocol.java:1093)
	at oracle.jdbc.driver.OracleStatement.executeNonQuery(OracleStatement.java:2047)
	at oracle.jdbc.driver.OracleStatement.doExecuteOther(OracleStatement.java:1940)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:2709)
	at oracle.jdbc.driver.OracleStatement.executeUpdate(OracleStatement.java:796)
	at program.DVRSmain.sendAlertSMS(DVRSmain.java:2271)
	at program.DVRSmain.process(DVRSmain.java:2991)
	at program.DVRSmain.execute(DVRSmain.java:2878)
	at org.quartz.core.JobRunShell.run(JobRunShell.java:202)
	at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573)
2015-03-09 16:04:49,605 [ERROR] (DVRSmain.java:2480) - Can't send email without receiver!
2015-03-09 16:04:49,605 [ INFO] (DVRSmain.java:2992) - sendAlertSMS execute time :2905
2015-03-09 16:04:49,621 [ INFO] (DVRSmain.java:1639) - insertCurrentMap...
2015-03-09 16:04:49,621 [ INFO] (DVRSmain.java:1648) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 16:04:49,621 [ INFO] (DVRSmain.java:1686) - insertCurrentMapDay...
2015-03-09 16:04:49,621 [ INFO] (DVRSmain.java:1694) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 16:04:49,621 [ INFO] (DVRSmain.java:1544) - updateCurrentMap...
2015-03-09 16:04:49,621 [ INFO] (DVRSmain.java:1555) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 16:04:49,621 [ INFO] (DVRSmain.java:1583) - Execute updateCurrentMap Batch
2015-03-09 16:04:49,636 [ INFO] (DVRSmain.java:1589) - updateCurrentMapDay...
2015-03-09 16:04:49,636 [ INFO] (DVRSmain.java:1599) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 16:04:49,652 [ INFO] (DVRSmain.java:1626) - Execute updateCurrentMapU Batch
2015-03-09 16:04:49,683 [ INFO] (DVRSmain.java:3018) - insert¡®update execute time :78
2015-03-09 16:04:49,683 [ INFO] (DVRSmain.java:3023) - processSuspendNBR execute time :0
2015-03-09 16:04:49,683 [ INFO] (DVRSmain.java:3028) - Program execute time :249917
2015-03-09 16:04:49,683 [ INFO] (DVRSmain.java:1117) - closeConnect1...
2015-03-09 16:04:49,714 [ INFO] (DVRSmain.java:1134) - closeConnect2...
2015-03-09 16:23:10,949 [ INFO] (DVRSmain.java:2881) - RFP Program Start! Mon Mar 09 16:23:10 CST 2015
2015-03-09 16:23:11,233 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:23:12,260 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:23:12,260 [ INFO] (DVRSmain.java:1045) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 16:23:12,276 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:23:13,056 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:23:13,056 [ INFO] (DVRSmain.java:1086) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 16:23:13,056 [DEBUG] (DVRSmain.java:2889) - connect success!
2015-03-09 16:23:13,056 [ INFO] (DVRSmain.java:1152) - cancelAutoCommit...
2015-03-09 16:23:13,056 [ INFO] (DVRSmain.java:1154) - set AutoCommit false!
2015-03-09 16:23:13,056 [ INFO] (DVRSmain.java:138) - setMonthDate...
2015-03-09 16:23:13,056 [ INFO] (DVRSmain.java:844) - setIMSItoServiceIDMap...
2015-03-09 16:23:13,057 [ INFO] (DVRSmain.java:870) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 16:24:27,156 [ INFO] (DVRSmain.java:2902) - setIMSItoServiceIDMap execute time :74100
2015-03-09 16:24:27,156 [ INFO] (DVRSmain.java:890) - setServiceIDtoImsiMap...
2015-03-09 16:24:27,157 [ INFO] (DVRSmain.java:916) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 16:25:13,785 [ INFO] (DVRSmain.java:2907) - setServiceIDtoImsiMap execute time :46629
2015-03-09 16:25:13,785 [ INFO] (DVRSmain.java:183) - setLastFileID...
2015-03-09 16:25:13,785 [DEBUG] (DVRSmain.java:189) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 16:25:13,849 [ INFO] (DVRSmain.java:195) - Last process file ID :14333
2015-03-09 16:25:13,849 [ INFO] (DVRSmain.java:2912) - setLastFileID execute time :64
2015-03-09 16:25:13,849 [ INFO] (DVRSmain.java:282) - setoldChargeMap...
2015-03-09 16:25:13,849 [ INFO] (DVRSmain.java:2919) - setCurrentMap execute time :0
2015-03-09 16:25:13,849 [ INFO] (DVRSmain.java:457) - setThreshold...
2015-03-09 16:25:13,849 [DEBUG] (DVRSmain.java:464) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 16:25:13,880 [DEBUG] (DVRSmain.java:467) - Set dataRate map...
2015-03-09 16:25:13,974 [ INFO] (DVRSmain.java:2924) - setThreshold execute time :125
2015-03-09 16:25:13,974 [ INFO] (DVRSmain.java:406) - setDataRate...
2015-03-09 16:25:13,974 [DEBUG] (DVRSmain.java:413) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 16:25:13,989 [DEBUG] (DVRSmain.java:416) - Set dataRate map...
2015-03-09 16:25:15,071 [ INFO] (DVRSmain.java:2929) - setDataRate execute time :1097
2015-03-09 16:25:15,071 [ INFO] (DVRSmain.java:785) - setMsisdnMap...
2015-03-09 16:25:15,071 [ INFO] (DVRSmain.java:808) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 16:25:44,908 [ INFO] (DVRSmain.java:2934) - setMsisdnMap execute time :29837
2015-03-09 16:25:44,908 [DEBUG] (DVRSmain.java:747) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 16:25:44,956 [ INFO] (DVRSmain.java:2940) - setIPtoMccmncList execute time :48
2015-03-09 16:25:44,956 [ INFO] (DVRSmain.java:490) - setSERVICEIDtoVLN...
2015-03-09 16:25:44,972 [DEBUG] (DVRSmain.java:498) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 16:25:56,254 [ INFO] (DVRSmain.java:2945) - setSERVICEIDtoVLN execute time :11298
2015-03-09 16:25:56,254 [ INFO] (DVRSmain.java:526) - setVLNtoTADIG...
2015-03-09 16:25:56,254 [DEBUG] (DVRSmain.java:534) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 16:25:58,243 [ INFO] (DVRSmain.java:2950) - setVLNtoTADIG execute time :1989
2015-03-09 16:25:58,243 [ INFO] (DVRSmain.java:560) - setTADIGtoMCCMNC...
2015-03-09 16:25:58,258 [DEBUG] (DVRSmain.java:567) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 16:25:58,540 [ INFO] (DVRSmain.java:2955) - setTADIGtoMCCMNC execute time :297
2015-03-09 16:25:58,540 [ INFO] (DVRSmain.java:593) - setCostomerNumber...
2015-03-09 16:25:58,540 [DEBUG] (DVRSmain.java:600) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 16:25:58,587 [ INFO] (DVRSmain.java:2960) - setCostomerNumber execute time :47
2015-03-09 16:25:58,587 [ INFO] (DVRSmain.java:703) - setAddonData...
2015-03-09 16:25:58,587 [DEBUG] (DVRSmain.java:709) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 16:26:00,232 [ INFO] (DVRSmain.java:2965) - setAddonData execute time :1645
2015-03-09 16:26:00,232 [ INFO] (DVRSmain.java:1263) - charge...
2015-03-09 16:26:00,232 [ INFO] (DVRSmain.java:627) - dataCount...
2015-03-09 16:26:00,264 [DEBUG] (DVRSmain.java:637) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 16:26:00,264 [ INFO] (DVRSmain.java:642) - usage count : 0
2015-03-09 16:26:00,264 [ INFO] (DVRSmain.java:663) - defaultRate...
2015-03-09 16:26:00,264 [ INFO] (DVRSmain.java:692) - defaultRate : 0.011 TWD 
2015-03-09 16:26:00,264 [ INFO] (DVRSmain.java:2970) - charge execute time :32
2015-03-09 16:26:00,264 [ INFO] (DVRSmain.java:1743) - sendAlertSMS...
2015-03-09 16:26:00,280 [DEBUG] (DVRSmain.java:1759) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 16:26:00,295 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:26:00,295 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:26:00,295 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:26:00,295 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:26:00,295 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:26:00,295 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:26:00,311 [DEBUG] (DVRSmain.java:1803) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 16:26:00,373 [DEBUG] (DVRSmain.java:1978) - Total send month alert0 ...
2015-03-09 16:26:00,373 [DEBUG] (DVRSmain.java:1979) - Log to table...executeBatch
2015-03-09 16:26:00,389 [DEBUG] (DVRSmain.java:2275) - Total send volume alert SMS 0 ...
2015-03-09 16:26:00,389 [ INFO] (DVRSmain.java:2975) - sendAlertSMS execute time :125
2015-03-09 16:26:00,405 [ INFO] (DVRSmain.java:1638) - insertCurrentMap...
2015-03-09 16:26:00,405 [ INFO] (DVRSmain.java:1647) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 16:26:00,405 [ INFO] (DVRSmain.java:1685) - insertCurrentMapDay...
2015-03-09 16:26:00,405 [ INFO] (DVRSmain.java:1693) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 16:26:00,405 [ INFO] (DVRSmain.java:1543) - updateCurrentMap...
2015-03-09 16:26:00,405 [ INFO] (DVRSmain.java:1554) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 16:26:00,405 [ INFO] (DVRSmain.java:1582) - Execute updateCurrentMap Batch
2015-03-09 16:26:00,420 [ INFO] (DVRSmain.java:1588) - updateCurrentMapDay...
2015-03-09 16:26:00,420 [ INFO] (DVRSmain.java:1598) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 16:26:00,436 [ INFO] (DVRSmain.java:1625) - Execute updateCurrentMapU Batch
2015-03-09 16:26:00,467 [ INFO] (DVRSmain.java:3001) - insert¡®update execute time :78
2015-03-09 16:26:00,467 [ INFO] (DVRSmain.java:3006) - processSuspendNBR execute time :0
2015-03-09 16:26:00,467 [ INFO] (DVRSmain.java:3011) - Program execute time :167411
2015-03-09 16:26:00,467 [ INFO] (DVRSmain.java:1116) - closeConnect1...
2015-03-09 16:26:00,467 [ INFO] (DVRSmain.java:1133) - closeConnect2...
2015-03-09 16:29:09,869 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 16:29:09,885 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 16:29:10,322 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 16:29:10 CST 2015
2015-03-09 16:29:10,322 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:29:13,768 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:29:13,768 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 16:29:13,768 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:29:14,019 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:29:14,019 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 16:29:14,019 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 16:29:14,019 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 16:29:14,019 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 16:29:14,019 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 16:29:14,050 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 16:29:14,050 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 16:30:41,906 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :87856
2015-03-09 16:30:41,906 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 16:30:41,907 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 16:31:46,985 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :65079
2015-03-09 16:31:46,985 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 16:31:46,985 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 16:31:47,017 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 16:31:47,032 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :47
2015-03-09 16:31:47,032 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 16:31:47,032 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 16:31:47,049 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 16:31:47,085 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 16:31:47,085 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 16:31:47,085 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 16:31:47,132 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :100
2015-03-09 16:31:47,132 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 16:31:47,148 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 16:31:47,163 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 16:31:47,288 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :156
2015-03-09 16:31:47,288 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 16:31:47,304 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 16:31:47,319 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 16:31:48,508 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1220
2015-03-09 16:31:48,508 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 16:31:48,508 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 16:32:12,455 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :23947
2015-03-09 16:32:12,455 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 16:32:12,519 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :64
2015-03-09 16:32:12,519 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 16:32:12,519 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 16:32:23,285 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :10766
2015-03-09 16:32:23,285 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 16:32:23,286 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 16:32:25,208 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :1923
2015-03-09 16:32:25,208 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 16:32:25,208 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 16:32:25,540 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :332
2015-03-09 16:32:25,540 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 16:32:25,556 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 16:32:25,587 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :47
2015-03-09 16:32:25,602 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 16:32:25,602 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 16:32:26,276 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :674
2015-03-09 16:32:26,276 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 16:32:26,276 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 16:32:26,308 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 16:32:26,340 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 16:32:26,340 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 16:32:26,340 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 16:32:26,340 [ INFO] (DVRSmain.java:3003) - charge execute time :64
2015-03-09 16:32:26,340 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 16:32:26,340 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 16:32:26,371 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:32:26,371 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:32:26,371 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:32:26,371 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:32:26,371 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:32:26,371 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:32:26,386 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 16:32:26,433 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 16:32:26,433 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 16:32:26,449 [ERROR] (DVRSmain.java:2496) - Can't send email without receiver!
2015-03-09 16:32:56,272 [ INFO] (DVRSmain.java:2885) - RFP Program Start! Mon Mar 09 16:32:56 CST 2015
2015-03-09 16:32:56,757 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:32:59,745 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:32:59,745 [ INFO] (DVRSmain.java:1045) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 16:32:59,745 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:33:00,106 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:33:00,106 [ INFO] (DVRSmain.java:1086) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 16:33:00,106 [DEBUG] (DVRSmain.java:2893) - connect success!
2015-03-09 16:33:00,106 [ INFO] (DVRSmain.java:1152) - cancelAutoCommit...
2015-03-09 16:33:00,155 [ INFO] (DVRSmain.java:1154) - set AutoCommit false!
2015-03-09 16:33:00,171 [ INFO] (DVRSmain.java:138) - setMonthDate...
2015-03-09 16:33:00,186 [ INFO] (DVRSmain.java:844) - setIMSItoServiceIDMap...
2015-03-09 16:33:00,280 [ INFO] (DVRSmain.java:870) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 16:34:06,544 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 16:34:06,592 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 16:34:06,890 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 16:34:06 CST 2015
2015-03-09 16:34:06,890 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:34:08,268 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:34:08,268 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 16:34:08,268 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:34:08,585 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:34:08,585 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 16:34:08,585 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 16:34:08,585 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 16:34:08,585 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 16:34:08,600 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 16:34:08,632 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 16:34:08,647 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 16:34:34,261 [ INFO] (DVRSmain.java:2906) - setIMSItoServiceIDMap execute time :94075
2015-03-09 16:34:34,261 [ INFO] (DVRSmain.java:890) - setServiceIDtoImsiMap...
2015-03-09 16:34:34,262 [ INFO] (DVRSmain.java:916) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 16:35:03,714 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 16:35:03,714 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 16:35:03,776 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 16:35:03 CST 2015
2015-03-09 16:35:03,792 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:35:04,203 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:35:04,203 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 16:35:04,203 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:35:04,406 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:35:04,406 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 16:35:04,406 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 16:35:04,406 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 16:35:04,406 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 16:35:04,407 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 16:35:04,407 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 16:35:04,438 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 16:35:14,796 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :66164
2015-03-09 16:35:14,796 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 16:35:14,797 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 16:35:24,034 [ INFO] (DVRSmain.java:2911) - setServiceIDtoImsiMap execute time :49773
2015-03-09 16:35:24,050 [ INFO] (DVRSmain.java:183) - setLastFileID...
2015-03-09 16:35:24,050 [DEBUG] (DVRSmain.java:189) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 16:35:24,098 [ INFO] (DVRSmain.java:195) - Last process file ID :14333
2015-03-09 16:35:24,113 [ INFO] (DVRSmain.java:2916) - setLastFileID execute time :63
2015-03-09 16:35:24,113 [ INFO] (DVRSmain.java:282) - setoldChargeMap...
2015-03-09 16:35:24,113 [ INFO] (DVRSmain.java:2923) - setCurrentMap execute time :0
2015-03-09 16:35:24,113 [ INFO] (DVRSmain.java:457) - setThreshold...
2015-03-09 16:35:24,113 [DEBUG] (DVRSmain.java:464) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 16:35:24,129 [DEBUG] (DVRSmain.java:467) - Set dataRate map...
2015-03-09 16:35:24,269 [ INFO] (DVRSmain.java:2928) - setThreshold execute time :156
2015-03-09 16:35:24,269 [ INFO] (DVRSmain.java:406) - setDataRate...
2015-03-09 16:35:24,269 [DEBUG] (DVRSmain.java:413) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 16:35:24,300 [DEBUG] (DVRSmain.java:416) - Set dataRate map...
2015-03-09 16:35:25,487 [ INFO] (DVRSmain.java:2933) - setDataRate execute time :1218
2015-03-09 16:35:25,597 [ INFO] (DVRSmain.java:785) - setMsisdnMap...
2015-03-09 16:35:25,597 [ INFO] (DVRSmain.java:808) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,(CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 16:35:26,273 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 16:35:26,273 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 16:35:26,353 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 16:35:26 CST 2015
2015-03-09 16:35:26,353 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:35:26,920 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:35:26,920 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 16:35:26,920 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:35:27,185 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:35:27,185 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 16:35:27,185 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 16:35:27,185 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 16:35:27,185 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 16:35:27,185 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 16:35:27,185 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 16:35:27,200 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 16:35:49,999 [ INFO] (DVRSmain.java:2938) - setMsisdnMap execute time :24402
2015-03-09 16:35:49,999 [DEBUG] (DVRSmain.java:747) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 16:35:50,063 [ INFO] (DVRSmain.java:2944) - setIPtoMccmncList execute time :64
2015-03-09 16:35:50,063 [ INFO] (DVRSmain.java:490) - setSERVICEIDtoVLN...
2015-03-09 16:35:50,063 [DEBUG] (DVRSmain.java:498) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 16:36:01,483 [ INFO] (DVRSmain.java:2949) - setSERVICEIDtoVLN execute time :11420
2015-03-09 16:36:01,483 [ INFO] (DVRSmain.java:526) - setVLNtoTADIG...
2015-03-09 16:36:01,484 [DEBUG] (DVRSmain.java:534) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 16:36:03,582 [ INFO] (DVRSmain.java:2954) - setVLNtoTADIG execute time :2099
2015-03-09 16:36:03,582 [ INFO] (DVRSmain.java:560) - setTADIGtoMCCMNC...
2015-03-09 16:36:03,582 [DEBUG] (DVRSmain.java:567) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 16:36:03,910 [ INFO] (DVRSmain.java:2959) - setTADIGtoMCCMNC execute time :328
2015-03-09 16:36:03,910 [ INFO] (DVRSmain.java:593) - setCostomerNumber...
2015-03-09 16:36:03,910 [DEBUG] (DVRSmain.java:600) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 16:36:03,941 [ INFO] (DVRSmain.java:2964) - setCostomerNumber execute time :31
2015-03-09 16:36:03,941 [ INFO] (DVRSmain.java:703) - setAddonData...
2015-03-09 16:36:03,957 [DEBUG] (DVRSmain.java:709) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 16:36:04,647 [ INFO] (DVRSmain.java:2969) - setAddonData execute time :706
2015-03-09 16:36:04,647 [ INFO] (DVRSmain.java:1263) - charge...
2015-03-09 16:36:04,647 [ INFO] (DVRSmain.java:627) - dataCount...
2015-03-09 16:36:04,679 [DEBUG] (DVRSmain.java:637) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 16:36:04,679 [ INFO] (DVRSmain.java:642) - usage count : 0
2015-03-09 16:36:04,694 [ INFO] (DVRSmain.java:663) - defaultRate...
2015-03-09 16:36:04,694 [ INFO] (DVRSmain.java:692) - defaultRate : 0.011 TWD 
2015-03-09 16:36:04,694 [ INFO] (DVRSmain.java:2974) - charge execute time :47
2015-03-09 16:36:04,694 [ INFO] (DVRSmain.java:1743) - sendAlertSMS...
2015-03-09 16:36:04,694 [DEBUG] (DVRSmain.java:1759) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 16:36:04,710 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:36:04,710 [ INFO] (DVRSmain.java:1767) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:36:04,710 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:36:04,710 [ INFO] (DVRSmain.java:1767) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:36:04,725 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:36:04,725 [ INFO] (DVRSmain.java:1767) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:36:04,741 [DEBUG] (DVRSmain.java:1803) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 16:36:04,789 [DEBUG] (DVRSmain.java:1978) - Total send month alert0 ...
2015-03-09 16:36:04,789 [DEBUG] (DVRSmain.java:1979) - Log to table...executeBatch
2015-03-09 16:36:04,820 [DEBUG] (DVRSmain.java:2275) - Total send volume alert SMS 0 ...
2015-03-09 16:36:04,820 [ INFO] (DVRSmain.java:2979) - sendAlertSMS execute time :126
2015-03-09 16:36:04,836 [ INFO] (DVRSmain.java:1638) - insertCurrentMap...
2015-03-09 16:36:04,929 [ INFO] (DVRSmain.java:1647) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 16:36:04,929 [ INFO] (DVRSmain.java:1685) - insertCurrentMapDay...
2015-03-09 16:36:04,929 [ INFO] (DVRSmain.java:1693) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 16:36:04,929 [ INFO] (DVRSmain.java:1543) - updateCurrentMap...
2015-03-09 16:36:04,929 [ INFO] (DVRSmain.java:1554) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 16:36:04,929 [ INFO] (DVRSmain.java:1582) - Execute updateCurrentMap Batch
2015-03-09 16:36:04,931 [ INFO] (DVRSmain.java:1588) - updateCurrentMapDay...
2015-03-09 16:36:04,931 [ INFO] (DVRSmain.java:1598) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 16:36:04,965 [ INFO] (DVRSmain.java:1625) - Execute updateCurrentMapU Batch
2015-03-09 16:36:04,997 [ INFO] (DVRSmain.java:3005) - insert¡®update execute time :177
2015-03-09 16:36:04,997 [ INFO] (DVRSmain.java:3010) - processSuspendNBR execute time :0
2015-03-09 16:36:04,997 [ INFO] (DVRSmain.java:3015) - Program execute time :184891
2015-03-09 16:36:04,997 [ INFO] (DVRSmain.java:1116) - closeConnect1...
2015-03-09 16:36:05,012 [ INFO] (DVRSmain.java:1133) - closeConnect2...
2015-03-09 16:36:13,400 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :58604
2015-03-09 16:36:13,400 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 16:36:13,400 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 16:36:13,433 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 16:36:13,448 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :48
2015-03-09 16:36:13,448 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 16:36:13,448 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 16:36:13,479 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 16:36:13,479 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 16:36:13,479 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 16:36:13,479 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 16:36:13,526 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :78
2015-03-09 16:36:13,526 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 16:36:13,542 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 16:36:13,557 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 16:36:13,667 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :141
2015-03-09 16:36:13,667 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 16:36:13,667 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 16:36:13,698 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 16:36:14,731 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1064
2015-03-09 16:36:14,732 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 16:36:14,732 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 16:36:18,677 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :74270
2015-03-09 16:36:18,677 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 16:36:18,677 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 16:36:39,390 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :24659
2015-03-09 16:36:39,397 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 16:36:39,454 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :64
2015-03-09 16:36:39,455 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 16:36:39,462 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 16:36:42,054 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :74869
2015-03-09 16:36:42,055 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 16:36:42,061 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 16:36:50,141 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :10686
2015-03-09 16:36:50,141 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 16:36:50,151 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 16:36:52,281 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :2140
2015-03-09 16:36:52,282 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 16:36:52,289 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 16:36:52,593 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :311
2015-03-09 16:36:52,593 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 16:36:52,598 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 16:36:52,640 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :47
2015-03-09 16:36:52,640 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 16:36:52,647 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 16:36:53,757 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :1117
2015-03-09 16:36:53,757 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 16:36:53,757 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 16:36:53,795 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 16:36:53,801 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 16:36:53,806 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 16:36:53,806 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 16:36:53,806 [ INFO] (DVRSmain.java:3003) - charge execute time :49
2015-03-09 16:36:53,807 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 16:36:53,814 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 16:36:53,837 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:36:53,837 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:36:53,837 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:36:53,838 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:36:53,838 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:36:53,838 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:36:53,860 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 16:36:53,921 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 16:36:53,921 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 16:36:53,932 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 16:36:53,937 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :130
2015-03-09 16:36:53,953 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 16:36:53,953 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 16:36:53,953 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 16:36:53,953 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 16:36:53,953 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 16:36:53,953 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 16:36:53,961 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 16:36:53,976 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 16:36:53,976 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 16:36:53,983 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 16:36:54,078 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :140
2015-03-09 16:36:54,078 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 16:36:54,078 [ INFO] (DVRSmain.java:3044) - Program execute time :165493
2015-03-09 16:36:54,078 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 16:36:54,093 [ INFO] (DVRSmain.java:1135) - closeConnect2...
2015-03-09 16:37:12,305 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :53628
2015-03-09 16:37:12,305 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 16:37:12,305 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 16:37:12,337 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 16:37:12,353 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :48
2015-03-09 16:37:12,353 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 16:37:12,353 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 16:37:12,384 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 16:37:12,400 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 16:37:12,400 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 16:37:12,400 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 16:37:12,478 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :125
2015-03-09 16:37:12,478 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 16:37:12,478 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 16:37:12,493 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 16:37:12,618 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :140
2015-03-09 16:37:12,618 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 16:37:12,618 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 16:37:12,649 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 16:37:13,804 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1186
2015-03-09 16:37:13,804 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 16:37:13,805 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 16:37:37,826 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :24022
2015-03-09 16:37:37,826 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 16:37:37,905 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :79
2015-03-09 16:37:37,905 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 16:37:37,905 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 16:37:48,359 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :10454
2015-03-09 16:37:48,359 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 16:37:48,360 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 16:37:50,373 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :2014
2015-03-09 16:37:50,373 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 16:37:50,373 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 16:37:50,686 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :313
2015-03-09 16:37:50,686 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 16:37:50,686 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 16:37:50,717 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :31
2015-03-09 16:37:50,717 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 16:37:50,732 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 16:37:51,434 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :717
2015-03-09 16:37:51,434 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 16:37:51,434 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 16:37:51,451 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 16:37:51,482 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 16:37:51,482 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 16:37:51,482 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 16:37:51,482 [ INFO] (DVRSmain.java:3003) - charge execute time :48
2015-03-09 16:37:51,482 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 16:37:51,482 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 16:37:51,513 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:37:51,513 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:37:51,513 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:37:51,513 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:37:51,513 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:37:51,513 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:37:51,529 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 16:37:51,576 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 16:37:51,576 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 16:37:51,591 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 16:37:51,591 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :109
2015-03-09 16:37:51,607 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 16:37:51,607 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 16:37:51,607 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 16:37:51,607 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 16:37:51,607 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 16:37:51,607 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 16:37:51,622 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 16:37:51,622 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 16:37:51,622 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 16:37:51,638 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 16:37:51,685 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :94
2015-03-09 16:37:51,685 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 16:37:51,685 [ INFO] (DVRSmain.java:3044) - Program execute time :167279
2015-03-09 16:37:51,685 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 16:37:51,700 [ INFO] (DVRSmain.java:1135) - closeConnect2...
2015-03-09 16:40:57,445 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 16:40:57,445 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 16:40:57,524 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 16:40:57 CST 2015
2015-03-09 16:40:57,524 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:40:58,023 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:40:58,023 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 16:40:58,023 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:40:58,211 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:40:58,211 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 16:40:58,211 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 16:40:58,211 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 16:40:58,211 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 16:40:58,211 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 16:40:58,211 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 16:40:58,226 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 16:42:06,890 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :68679
2015-03-09 16:42:06,890 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 16:42:06,891 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 16:42:54,525 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :47635
2015-03-09 16:42:54,525 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 16:42:54,526 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 16:42:54,573 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 16:42:54,573 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :48
2015-03-09 16:42:54,573 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 16:42:54,573 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 16:42:54,604 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 16:42:54,620 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 16:42:54,620 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 16:42:54,620 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 16:42:54,651 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :78
2015-03-09 16:42:54,651 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 16:42:54,667 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 16:42:54,682 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 16:42:54,776 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :125
2015-03-09 16:42:54,776 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 16:42:54,776 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 16:42:54,823 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 16:42:55,935 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1159
2015-03-09 16:42:55,935 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 16:42:55,951 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 16:43:18,005 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :22070
2015-03-09 16:43:18,005 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 16:43:18,053 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :48
2015-03-09 16:43:18,069 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 16:43:18,069 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 16:43:30,022 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :11953
2015-03-09 16:43:30,022 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 16:43:30,023 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 16:43:32,068 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :2046
2015-03-09 16:43:32,068 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 16:43:32,068 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 16:43:32,381 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :313
2015-03-09 16:43:32,381 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 16:43:32,396 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 16:43:32,428 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :47
2015-03-09 16:43:32,428 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 16:43:32,428 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 16:43:33,176 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :748
2015-03-09 16:43:33,176 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 16:43:33,176 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 16:43:33,521 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 16:43:33,536 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 16:43:33,552 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 16:43:33,552 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 16:43:33,552 [ INFO] (DVRSmain.java:3003) - charge execute time :376
2015-03-09 16:43:33,552 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 16:43:33,567 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 16:43:33,614 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:43:33,614 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:43:33,614 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:43:33,614 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:43:33,614 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:43:33,614 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:43:33,661 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 16:43:33,708 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 16:43:33,708 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 16:43:33,723 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 16:43:33,723 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :171
2015-03-09 16:43:33,739 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 16:43:33,739 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 16:43:33,739 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 16:43:33,739 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 16:43:33,739 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 16:43:33,739 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 16:43:33,739 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 16:43:33,755 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 16:43:33,755 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 16:43:33,770 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 16:43:33,817 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :94
2015-03-09 16:43:33,817 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 16:43:33,817 [ INFO] (DVRSmain.java:3044) - Program execute time :155606
2015-03-09 16:43:33,817 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 16:43:33,833 [ INFO] (DVRSmain.java:1135) - closeConnect2...
2015-03-09 16:44:25,711 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 16:44:25,711 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 16:44:25,805 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 16:44:25 CST 2015
2015-03-09 16:44:25,805 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:44:26,304 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:44:26,304 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 16:44:26,304 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:44:26,804 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:44:26,804 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 16:44:26,804 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 16:44:26,804 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 16:44:26,804 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 16:44:26,820 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 16:44:26,820 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 16:44:26,835 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 16:45:30,248 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :63428
2015-03-09 16:45:30,249 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 16:45:30,259 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 16:46:22,735 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :52486
2015-03-09 16:46:22,735 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 16:46:22,750 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 16:46:22,751 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 16:46:22,751 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :16
2015-03-09 16:46:22,751 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 16:46:22,784 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 16:46:22,846 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 16:46:22,862 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 16:46:22,862 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 16:46:22,862 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 16:46:22,893 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :142
2015-03-09 16:46:22,893 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 16:46:22,908 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 16:46:22,940 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 16:46:23,049 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :156
2015-03-09 16:46:23,049 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 16:46:23,049 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 16:46:23,064 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 16:46:24,485 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1436
2015-03-09 16:46:24,485 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 16:46:24,485 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 16:46:48,201 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :23716
2015-03-09 16:46:48,202 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 16:46:48,281 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :80
2015-03-09 16:46:48,281 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 16:46:48,312 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 16:46:59,413 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :11132
2015-03-09 16:46:59,413 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 16:46:59,428 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 16:47:01,442 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :2029
2015-03-09 16:47:01,442 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 16:47:01,443 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 16:47:01,741 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :299
2015-03-09 16:47:01,741 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 16:47:01,741 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 16:47:01,772 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :31
2015-03-09 16:47:01,772 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 16:47:01,788 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 16:47:02,552 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :780
2015-03-09 16:47:02,552 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 16:47:02,552 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 16:47:02,569 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 16:47:02,600 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 16:47:02,600 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 16:47:02,600 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 16:47:02,600 [ INFO] (DVRSmain.java:3003) - charge execute time :48
2015-03-09 16:47:02,600 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 16:47:02,600 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 16:47:02,631 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:47:02,631 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:47:02,631 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:47:02,631 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:47:02,631 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:47:02,631 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:47:02,647 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 16:47:02,709 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 16:47:02,709 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 16:47:02,756 [ INFO] (DVRSmain.java:2263) - For 40705 send 2.0GB decrease speed  message !
2015-03-09 16:47:02,818 [ INFO] (Jatool.java:67) - get Properites!
2015-03-09 16:47:02,818 [ INFO] (Jatool.java:67) - Connect to Host : 106.186.120.118
2015-03-09 16:47:02,818 [ INFO] (Jatool.java:67) - port : null
2015-03-09 16:47:02,818 [ INFO] (Jatool.java:67) - use authority : true
2015-03-09 16:47:02,818 [DEBUG] (Jatool.java:69) - Creat mail Session!
2015-03-09 16:47:02,865 [DEBUG] (Jatool.java:69) - set mail content!
2015-03-09 16:47:05,582 [ INFO] (Jatool.java:67) - sending mail from HKNet@sim2travel.com to k1988242001@gmail.com
<br>Subject : Notification on FUP 100% 2GB
<br>Content : <html><body>¡iHKNet Oneness SIM ¼Æ¾Ú¥Î¶q³qª¾¡j´L·qªºHKNet Oneness SIM¥Î¤á(89852660000005138929)±z¦n¡A±z¦b­»´ä¤Î¤j³°ªº¼Æ¾Ú¥Î¶q¤w¹F2GB¡A«ö¥»¤½¥qFUP³W½d¼Æ¾Ú¥Î¶q¥H128kbps´£¨ÑªA°È¡A¦Ü¦¸¤ë°_«ì´_¥þ³t¡C·q½Ð¯d·N¡C·PÁÂ±z¨Ï¥ÎHKNet¡A«ÈªA¿Ô¸ß½Ð¬¢+85266404204¡C<br><br>Dear HKNet Oneness SIM customer (89852660000005138929), please be informed that your HK + China mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact HKNet Oneness SIM service hotline: +85266404204 if any queries.</body></html>
<br>SendDate: Mon Mar 09 16:47:02 CST 2015
2015-03-09 16:47:05,598 [DEBUG] (DVRSmain.java:2278) - execute SQL : INSERT INTO HUR_SMS_LOG(ID,SEND_NUMBER,MSG,SEND_DATE,RESULT,CREATE_DATE) VALUES(DVRS_SMS_ID.NEXTVAL,'k1988242001@gmail.com','?iHKNet Oneness SIM ???????q?q???j?L¡Pq??HKNet Oneness SIM????(89852660000005138929)¡Óz?n?A¡Óz?b???????j?¢X?????????q?w?F2GB?A???????qFUP?W?d???????q?H128kbps?????A¢X??A??????¢X_???_???t?C¡Pq??¡Âd¡PN?C¡PP??¡Óz????HKNet?A???A????????%2b85266404204?C<br><br>Dear HKNet Oneness SIM customer (89852660000005138929), please be informed that your HK + China mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact HKNet Oneness SIM service hotline: %2b85266404204 if any queries.',TO_DATE('2015/03/09 16:47:05','yyyy/MM/dd HH24:mi:ss'),'success',SYSDATE)
2015-03-09 16:47:05,599 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 16:47:05,631 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :3031
2015-03-09 16:47:05,662 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 16:47:05,662 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 16:47:05,662 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 16:47:05,662 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 16:47:05,662 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 16:47:05,662 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 16:47:05,677 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 16:47:05,677 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 16:47:05,693 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 16:47:05,693 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 16:47:05,709 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :78
2015-03-09 16:47:05,709 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 16:47:05,724 [ INFO] (DVRSmain.java:3044) - Program execute time :158920
2015-03-09 16:47:05,724 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 16:47:05,724 [ INFO] (DVRSmain.java:1135) - closeConnect2...
2015-03-09 16:50:12,627 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 16:50:12,627 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 16:50:12,705 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 16:50:12 CST 2015
2015-03-09 16:50:12,705 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:50:13,205 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:50:13,205 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 16:50:13,205 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:50:13,376 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:50:13,376 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 16:50:13,376 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 16:50:13,376 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 16:50:13,376 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 16:50:13,377 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 16:50:13,377 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 16:50:13,377 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 16:51:39,122 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :85745
2015-03-09 16:51:39,122 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 16:51:39,138 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 16:52:52,280 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :73158
2015-03-09 16:52:52,280 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 16:52:52,280 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 16:52:52,296 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 16:52:52,296 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :16
2015-03-09 16:52:52,296 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 16:52:52,296 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 16:52:52,343 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 16:52:52,359 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 16:52:52,359 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 16:52:52,359 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 16:52:52,390 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :94
2015-03-09 16:52:52,390 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 16:52:52,405 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 16:52:52,421 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 16:52:52,515 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :125
2015-03-09 16:52:52,515 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 16:52:52,530 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 16:52:52,546 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 16:52:53,622 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1107
2015-03-09 16:52:53,622 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 16:52:53,622 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 16:53:17,716 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :24094
2015-03-09 16:53:17,731 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 16:53:17,779 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :48
2015-03-09 16:53:17,779 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 16:53:17,795 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 16:53:28,906 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :11127
2015-03-09 16:53:28,906 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 16:53:28,922 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 16:53:30,843 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :1937
2015-03-09 16:53:30,843 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 16:53:30,844 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 16:53:31,171 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :328
2015-03-09 16:53:31,171 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 16:53:31,187 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 16:53:31,218 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :47
2015-03-09 16:53:31,218 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 16:53:31,218 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 16:53:31,935 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :717
2015-03-09 16:53:31,935 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 16:53:31,935 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 16:53:31,983 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 16:53:31,983 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 16:53:31,983 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 16:53:31,983 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 16:53:31,983 [ INFO] (DVRSmain.java:3003) - charge execute time :48
2015-03-09 16:53:31,983 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 16:53:31,999 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 16:53:32,030 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:53:32,030 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 16:53:32,030 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:53:32,030 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 16:53:32,030 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:53:32,030 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 16:53:32,046 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 16:53:32,108 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 16:53:32,108 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 16:53:32,108 [ INFO] (DVRSmain.java:2263) - For 40705 send 2.0GB decrease speed  message !
2015-03-09 16:53:32,108 [ INFO] (Jatool.java:67) - get Properites!
2015-03-09 16:53:32,108 [ INFO] (Jatool.java:67) - Connect to Host : 106.186.120.118
2015-03-09 16:53:32,108 [ INFO] (Jatool.java:67) - port : null
2015-03-09 16:53:32,124 [ INFO] (Jatool.java:67) - use authority : true
2015-03-09 16:53:32,124 [DEBUG] (Jatool.java:69) - Creat mail Session!
2015-03-09 16:53:32,155 [DEBUG] (Jatool.java:69) - set mail content!
2015-03-09 16:53:34,045 [ERROR] (DVRSmain.java:2529) - Error at sendErrorMail
javax.mail.SendFailedException: Invalid Addresses;
  nested exception is:
	com.sun.mail.smtp.SMTPAddressFailedException: 550 5.1.1 <Douglas.Chuang>: Recipient address rejected: User unknown in local recipient table
;
  nested exception is:
	com.sun.mail.smtp.SMTPAddressFailedException: 550 5.1.1 <yvonne.lin>: Recipient address rejected: User unknown in local recipient table
;
  nested exception is:
	com.sun.mail.smtp.SMTPAddressFailedException: 550 5.1.1 <yvonne.lin>: Recipient address rejected: User unknown in local recipient table

	at com.sun.mail.smtp.SMTPTransport.rcptTo(SMTPTransport.java:1196)
	at com.sun.mail.smtp.SMTPTransport.sendMessage(SMTPTransport.java:584)
	at javax.mail.Transport.send0(Transport.java:169)
	at javax.mail.Transport.send(Transport.java:98)
	at program.Jatool.sendMail(Jatool.java:180)
	at program.DVRSmain.sendMail(DVRSmain.java:2523)
	at program.DVRSmain.sendAlertSMS(DVRSmain.java:2268)
	at program.DVRSmain.process(DVRSmain.java:3007)
	at program.DVRSmain.execute(DVRSmain.java:2894)
	at org.quartz.core.JobRunShell.run(JobRunShell.java:202)
	at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573)
Caused by: com.sun.mail.smtp.SMTPAddressFailedException: 550 5.1.1 <Douglas.Chuang>: Recipient address rejected: User unknown in local recipient table
;
  nested exception is:
	com.sun.mail.smtp.SMTPAddressFailedException: 550 5.1.1 <yvonne.lin>: Recipient address rejected: User unknown in local recipient table

	at com.sun.mail.smtp.SMTPTransport.rcptTo(SMTPTransport.java:1047)
	... 10 more
Caused by: com.sun.mail.smtp.SMTPAddressFailedException: 550 5.1.1 <yvonne.lin>: Recipient address rejected: User unknown in local recipient table

	... 11 more
2015-03-09 16:53:34,109 [DEBUG] (DVRSmain.java:2278) - execute SQL : INSERT INTO HUR_SMS_LOG(ID,SEND_NUMBER,MSG,SEND_DATE,RESULT,CREATE_DATE) VALUES(DVRS_SMS_ID.NEXTVAL,'k1988242001@gmail.com,Douglas.Chuang,yvonne.lin','?iHKNet Oneness SIM ???????q?q???j?L¡Pq??HKNet Oneness SIM????(89852660000005138929)¡Óz?n?A¡Óz?b???????j?¢X?????????q?w?F2GB?A???????qFUP?W?d???????q?H128kbps?????A¢X??A??????¢X_???_???t?C¡Pq??¡Âd¡PN?C¡PP??¡Óz????HKNet?A???A????????%2b85266404204?C<br><br>Dear HKNet Oneness SIM customer (89852660000005138929), please be informed that your HK + China mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact HKNet Oneness SIM service hotline: %2b85266404204 if any queries.',TO_DATE('2015/03/09 16:53:34','yyyy/MM/dd HH24:mi:ss'),'success',SYSDATE)
2015-03-09 16:53:34,109 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 16:53:34,124 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :2141
2015-03-09 16:53:34,140 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 16:53:34,140 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 16:53:34,140 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 16:53:34,140 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 16:53:34,140 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 16:53:34,140 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 16:53:34,156 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 16:53:34,171 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 16:53:34,171 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 16:53:34,171 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 16:53:34,202 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :78
2015-03-09 16:53:34,202 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 16:53:34,202 [ INFO] (DVRSmain.java:3044) - Program execute time :200826
2015-03-09 16:53:34,202 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 16:53:34,218 [ INFO] (DVRSmain.java:1135) - closeConnect2...
2015-03-09 16:57:39,649 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 16:57:39,649 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 16:57:39,742 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 16:57:39 CST 2015
2015-03-09 16:57:39,742 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:57:40,811 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:57:40,811 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 16:57:40,811 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 16:57:41,093 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 16:57:41,093 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 16:57:41,093 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 16:57:41,093 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 16:57:41,093 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 16:57:41,108 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 16:57:41,108 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 16:57:41,108 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 16:58:36,816 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :55708
2015-03-09 16:58:36,816 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 16:58:36,831 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 16:59:18,193 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :41377
2015-03-09 16:59:18,193 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 16:59:18,209 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 16:59:18,241 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 16:59:18,241 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :48
2015-03-09 16:59:18,241 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 16:59:18,257 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 16:59:18,272 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 16:59:18,288 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 16:59:18,288 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 16:59:18,288 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 16:59:18,335 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :94
2015-03-09 16:59:18,335 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 16:59:18,335 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 16:59:18,350 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 16:59:18,459 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :124
2015-03-09 16:59:18,459 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 16:59:18,475 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 16:59:18,491 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 16:59:19,611 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1152
2015-03-09 16:59:19,611 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 16:59:19,611 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 16:59:44,394 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :24783
2015-03-09 16:59:44,394 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 16:59:44,458 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :64
2015-03-09 16:59:44,458 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 16:59:44,458 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 16:59:57,384 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :12926
2015-03-09 16:59:57,384 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 16:59:57,385 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 16:59:59,747 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :2363
2015-03-09 16:59:59,747 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 16:59:59,748 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 17:00:00,077 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :330
2015-03-09 17:00:00,077 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 17:00:00,092 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 17:00:00,123 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :46
2015-03-09 17:00:00,123 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 17:00:00,139 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 17:00:00,876 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :753
2015-03-09 17:00:00,876 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 17:00:00,876 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 17:00:00,924 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 17:00:00,924 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 17:00:00,924 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 17:00:00,924 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 17:00:00,924 [ INFO] (DVRSmain.java:3003) - charge execute time :48
2015-03-09 17:00:00,924 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 17:00:00,940 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 17:00:00,955 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:00:00,955 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:00:00,955 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:00:00,955 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:00:00,955 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:00:00,955 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:00:00,986 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 17:00:01,049 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 17:00:01,049 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 17:00:01,064 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 17:00:01,064 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :140
2015-03-09 17:00:01,080 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 17:00:01,080 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 17:00:01,080 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 17:00:01,080 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 17:00:01,080 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 17:00:01,080 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 17:00:01,080 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 17:00:01,096 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 17:00:01,096 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 17:00:01,111 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 17:00:01,158 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :94
2015-03-09 17:00:01,158 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 17:00:01,158 [ INFO] (DVRSmain.java:3044) - Program execute time :140065
2015-03-09 17:00:01,158 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 17:00:01,158 [ INFO] (DVRSmain.java:1135) - closeConnect2...
2015-03-09 17:00:22,058 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 17:00:22,058 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 17:00:22,151 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 17:00:22 CST 2015
2015-03-09 17:00:22,151 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:00:22,822 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:00:22,822 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 17:00:22,822 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:00:24,277 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:00:24,277 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 17:00:24,277 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 17:00:24,277 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 17:00:24,277 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 17:00:24,278 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 17:00:24,278 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 17:00:24,309 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 17:02:11,345 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :107067
2015-03-09 17:02:11,345 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 17:02:11,346 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 17:03:09,926 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :58581
2015-03-09 17:03:09,926 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 17:03:09,942 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 17:03:09,974 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 17:03:09,990 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :64
2015-03-09 17:03:09,990 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 17:03:10,005 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 17:03:10,021 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 17:03:10,052 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 17:03:10,052 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 17:03:10,052 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 17:03:10,099 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :109
2015-03-09 17:03:10,099 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 17:03:10,099 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 17:03:10,130 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 17:03:10,239 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :140
2015-03-09 17:03:10,239 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 17:03:10,239 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 17:03:10,271 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 17:03:11,412 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1173
2015-03-09 17:03:11,428 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 17:03:11,429 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 17:04:01,622 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :50194
2015-03-09 17:04:01,623 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 17:04:01,701 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :79
2015-03-09 17:04:01,701 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 17:04:01,717 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 17:04:13,258 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :11557
2015-03-09 17:04:13,258 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 17:04:13,274 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 17:04:15,408 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :2150
2015-03-09 17:04:15,408 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 17:04:15,408 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 17:04:15,743 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :335
2015-03-09 17:04:15,743 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 17:04:15,774 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 17:04:15,836 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :93
2015-03-09 17:04:15,836 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 17:04:15,852 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 17:04:16,528 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :692
2015-03-09 17:04:16,528 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 17:04:16,528 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 17:04:16,607 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 17:04:16,622 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 17:04:16,622 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 17:04:16,622 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 17:04:16,622 [ INFO] (DVRSmain.java:3003) - charge execute time :94
2015-03-09 17:04:16,622 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 17:04:16,622 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 17:04:16,654 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:04:16,654 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:04:16,654 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:04:16,654 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:04:16,654 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:04:16,654 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:04:16,669 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 17:04:16,732 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 17:04:16,732 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 17:04:16,732 [ INFO] (DVRSmain.java:2263) - For 40705 send 2.0GB decrease speed  message !
2015-03-09 17:04:16,810 [ INFO] (Jatool.java:67) - get Properites!
2015-03-09 17:04:16,810 [ INFO] (Jatool.java:67) - Connect to Host : 106.186.120.118
2015-03-09 17:04:16,810 [ INFO] (Jatool.java:67) - port : null
2015-03-09 17:04:16,810 [ INFO] (Jatool.java:67) - use authority : true
2015-03-09 17:04:16,810 [DEBUG] (Jatool.java:69) - Creat mail Session!
2015-03-09 17:04:16,856 [DEBUG] (Jatool.java:69) - set mail content!
2015-03-09 17:04:19,568 [ INFO] (Jatool.java:67) - sending mail from HKNet@sim2travel.com to k1988242001@gmail.com,douglas.chuang@sim2travel.com,yvonne.lin@sim2travel.com
<br>Subject : Notification on FUP 100% 2GB
<br>Content : <html><body>¡iHKNet Oneness SIM ¼Æ¾Ú¥Î¶q³qª¾¡j´L·qªºHKNet Oneness SIM¥Î¤á(89852660000005138929)±z¦n¡A±z¦b­»´ä¤Î¤j³°ªº¼Æ¾Ú¥Î¶q¤w¹F2GB¡A«ö¥»¤½¥qFUP³W½d¼Æ¾Ú¥Î¶q¥H128kbps´£¨ÑªA°È¡A¦Ü¦¸¤ë°_«ì´_¥þ³t¡C·q½Ð¯d·N¡C·PÁÂ±z¨Ï¥ÎHKNet¡A«ÈªA¿Ô¸ß½Ð¬¢+85266404204¡C<br><br>Dear HKNet Oneness SIM customer (89852660000005138929), please be informed that your HK + China mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact HKNet Oneness SIM service hotline: +85266404204 if any queries.</body></html>
<br>SendDate: Mon Mar 09 17:04:16 CST 2015
2015-03-09 17:04:19,585 [DEBUG] (DVRSmain.java:2278) - execute SQL : INSERT INTO HUR_SMS_LOG(ID,SEND_NUMBER,MSG,SEND_DATE,RESULT,CREATE_DATE) VALUES(DVRS_SMS_ID.NEXTVAL,'k1988242001@gmail.com,douglas.chuang@sim2travel.com,yvonne.lin@sim2travel.com','?iHKNet Oneness SIM ???????q?q???j?L¡Pq??HKNet Oneness SIM????(89852660000005138929)¡Óz?n?A¡Óz?b???????j?¢X?????????q?w?F2GB?A???????qFUP?W?d???????q?H128kbps?????A¢X??A??????¢X_???_???t?C¡Pq??¡Âd¡PN?C¡PP??¡Óz????HKNet?A???A????????%2b85266404204?C<br><br>Dear HKNet Oneness SIM customer (89852660000005138929), please be informed that your HK + China mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact HKNet Oneness SIM service hotline: %2b85266404204 if any queries.',TO_DATE('2015/03/09 17:04:19','yyyy/MM/dd HH24:mi:ss'),'success',SYSDATE)
2015-03-09 17:04:19,585 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 17:04:19,616 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :2994
2015-03-09 17:04:19,616 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 17:04:19,616 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 17:04:19,616 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 17:04:19,616 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 17:04:19,616 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 17:04:19,616 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 17:04:19,631 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 17:04:19,647 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 17:04:19,647 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 17:04:19,647 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 17:04:19,678 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :62
2015-03-09 17:04:19,678 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 17:04:19,678 [ INFO] (DVRSmain.java:3044) - Program execute time :235401
2015-03-09 17:04:19,678 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 17:04:19,694 [ INFO] (DVRSmain.java:1135) - closeConnect2...
2015-03-09 17:07:25,508 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 17:07:25,508 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 17:07:25,587 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 17:07:25 CST 2015
2015-03-09 17:07:25,587 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:07:26,055 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:07:26,055 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 17:07:26,055 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:07:26,726 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:07:26,726 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 17:07:26,726 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 17:07:26,726 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 17:07:26,726 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 17:07:26,727 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 17:07:26,727 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 17:07:26,758 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 17:08:36,947 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :70220
2015-03-09 17:08:36,947 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 17:08:36,948 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 17:09:19,587 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :42640
2015-03-09 17:09:19,587 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 17:09:19,587 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 17:09:19,619 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 17:09:19,619 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :32
2015-03-09 17:09:19,619 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 17:09:19,635 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 17:09:19,651 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 17:09:19,666 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 17:09:19,666 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 17:09:19,666 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 17:09:19,713 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :94
2015-03-09 17:09:19,713 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 17:09:19,713 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 17:09:19,729 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 17:09:19,869 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :156
2015-03-09 17:09:19,869 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 17:09:19,869 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 17:09:19,900 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 17:09:20,950 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1081
2015-03-09 17:09:20,950 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 17:09:20,966 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 17:09:45,445 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :24495
2015-03-09 17:09:45,460 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 17:09:45,540 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :95
2015-03-09 17:09:45,540 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 17:09:45,540 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 17:09:56,793 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :11253
2015-03-09 17:09:56,793 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 17:09:56,799 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 17:09:58,910 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :2117
2015-03-09 17:09:58,910 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 17:09:58,927 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 17:09:59,235 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :325
2015-03-09 17:09:59,235 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 17:09:59,248 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 17:09:59,294 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :59
2015-03-09 17:09:59,294 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 17:09:59,312 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 17:10:00,055 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :761
2015-03-09 17:10:00,055 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 17:10:00,055 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 17:10:00,095 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 17:10:00,101 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 17:10:00,106 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 17:10:00,107 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 17:10:00,107 [ INFO] (DVRSmain.java:3003) - charge execute time :52
2015-03-09 17:10:00,107 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 17:10:00,113 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 17:10:00,133 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:10:00,133 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:10:00,133 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:10:00,133 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:10:00,134 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:10:00,134 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:10:00,150 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 17:10:00,208 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 17:10:00,208 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 17:10:00,220 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 17:10:00,226 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :119
2015-03-09 17:10:00,237 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 17:10:00,237 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 17:10:00,237 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 17:10:00,237 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 17:10:00,237 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 17:10:00,237 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 17:10:00,243 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 17:10:00,258 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 17:10:00,259 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 17:10:00,264 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 17:10:00,307 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :81
2015-03-09 17:10:00,307 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 17:10:00,307 [ INFO] (DVRSmain.java:3044) - Program execute time :153581
2015-03-09 17:10:00,307 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 17:10:00,319 [ INFO] (DVRSmain.java:1135) - closeConnect2...
2015-03-09 17:23:25,884 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 17:23:25,884 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 17:23:25,964 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 17:23:25 CST 2015
2015-03-09 17:23:25,964 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:23:26,495 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:23:26,495 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 17:23:26,495 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:23:26,713 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:23:26,713 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 17:23:26,713 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 17:23:26,713 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 17:23:26,713 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 17:23:26,729 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 17:23:26,729 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 17:23:26,744 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 17:24:26,919 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :60190
2015-03-09 17:24:26,935 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 17:24:26,935 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 17:25:09,437 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :42502
2015-03-09 17:25:09,437 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 17:25:09,437 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 17:25:09,469 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 17:25:09,469 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :32
2015-03-09 17:25:09,469 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 17:25:09,485 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 17:25:09,500 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 17:25:09,516 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 17:25:09,516 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 17:25:09,516 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 17:25:09,563 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :94
2015-03-09 17:25:09,563 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 17:25:09,563 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 17:25:09,578 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 17:25:09,672 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :109
2015-03-09 17:25:09,672 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 17:25:09,688 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 17:25:09,703 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 17:25:10,811 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1139
2015-03-09 17:25:10,811 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 17:25:10,811 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 17:25:42,239 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :31428
2015-03-09 17:25:42,240 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 17:25:42,318 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :79
2015-03-09 17:25:42,318 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 17:25:42,318 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 17:25:53,297 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :10979
2015-03-09 17:25:53,297 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 17:25:53,297 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 17:25:55,321 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :2024
2015-03-09 17:25:55,321 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 17:25:55,337 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 17:25:55,634 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :313
2015-03-09 17:25:55,634 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 17:25:55,634 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 17:25:55,681 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :47
2015-03-09 17:25:55,681 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 17:25:55,681 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 17:25:56,429 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :748
2015-03-09 17:25:56,429 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 17:25:56,429 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 17:25:56,477 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 17:25:56,477 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 17:25:56,477 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 17:25:56,477 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 17:25:56,493 [ INFO] (DVRSmain.java:3003) - charge execute time :64
2015-03-09 17:25:56,493 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 17:25:56,493 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 17:25:56,508 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:25:56,508 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:25:56,508 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:25:56,508 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:25:56,508 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:25:56,508 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:25:56,524 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 17:25:56,586 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 17:25:56,586 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 17:25:56,602 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 17:25:56,602 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :109
2015-03-09 17:25:56,618 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 17:25:56,618 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 17:25:56,618 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 17:25:56,618 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 17:25:56,618 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 17:25:56,618 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 17:25:56,618 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 17:25:56,633 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 17:25:56,633 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 17:25:56,633 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 17:25:56,696 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :94
2015-03-09 17:25:56,696 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 17:25:56,696 [ INFO] (DVRSmain.java:3044) - Program execute time :149983
2015-03-09 17:25:56,696 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 17:25:56,711 [ INFO] (DVRSmain.java:1135) - closeConnect2...
2015-03-09 17:26:39,753 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 17:26:39,753 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 17:26:39,846 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 17:26:39 CST 2015
2015-03-09 17:26:39,846 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:26:40,379 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:26:40,379 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 17:26:40,379 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:26:40,738 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:26:40,738 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 17:26:40,738 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 17:26:40,738 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 17:26:40,738 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 17:26:40,738 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 17:26:40,738 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 17:26:40,754 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 17:27:38,942 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :58204
2015-03-09 17:27:38,942 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 17:27:38,958 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 17:28:22,320 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :43378
2015-03-09 17:28:22,320 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 17:28:22,368 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 17:28:22,414 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 17:28:22,430 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :110
2015-03-09 17:28:22,430 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 17:28:22,446 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 17:28:22,477 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 17:28:22,492 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 17:28:22,492 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 17:28:22,492 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 17:28:22,524 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :94
2015-03-09 17:28:22,524 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 17:28:22,539 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 17:28:22,555 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 17:28:22,648 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :124
2015-03-09 17:28:22,648 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 17:28:22,664 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 17:28:22,680 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 17:28:23,853 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1205
2015-03-09 17:28:23,853 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 17:28:23,868 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 17:28:46,492 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :22639
2015-03-09 17:28:46,492 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 17:28:46,541 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :49
2015-03-09 17:28:46,541 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 17:28:46,557 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 17:28:58,760 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :12219
2015-03-09 17:28:58,760 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 17:28:58,776 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 17:29:01,283 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :2523
2015-03-09 17:29:01,283 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 17:29:01,299 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 17:29:01,927 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :644
2015-03-09 17:29:01,927 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 17:29:01,943 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 17:29:02,021 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :94
2015-03-09 17:29:02,021 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 17:29:02,037 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 17:29:02,892 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :871
2015-03-09 17:29:02,892 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 17:29:02,892 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 17:29:02,909 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 17:29:02,909 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 17:29:02,940 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 17:29:02,940 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 17:29:02,940 [ INFO] (DVRSmain.java:3003) - charge execute time :48
2015-03-09 17:29:02,940 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 17:29:02,940 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 17:29:02,971 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:29:02,971 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:29:02,971 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:29:02,971 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:29:02,971 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:29:02,971 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:29:02,987 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 17:29:03,049 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 17:29:03,049 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 17:29:03,065 [ INFO] (DVRSmain.java:2263) - For 40705 send 2.0GB decrease speed  message !
2015-03-09 17:29:03,096 [ INFO] (Jatool.java:67) - get Properites!
2015-03-09 17:29:03,096 [ INFO] (Jatool.java:67) - Connect to Host : 106.186.120.118
2015-03-09 17:29:03,096 [ INFO] (Jatool.java:67) - port : null
2015-03-09 17:29:03,096 [ INFO] (Jatool.java:67) - use authority : true
2015-03-09 17:29:03,096 [DEBUG] (Jatool.java:69) - Creat mail Session!
2015-03-09 17:29:03,159 [DEBUG] (Jatool.java:69) - set mail content!
2015-03-09 17:29:06,753 [ INFO] (Jatool.java:67) - sending mail from HKNet@sim2travel.com to k1988242001@gmail.com
<br>Subject : Notification on FUP 100% 2GB
<br>Content : <html><body>¡iHKNet Oneness SIM¼Æ¾Ú¥Î¶q³qª¾¡j´L·qªºHKNet Oneness SIM¥Î¤á(89852660000005138929)±z¦n¡A±z¦b­»´äªº¼Æ¾Ú¥Î¶q¤w¹F2GB¡A«ö¥»¤½¥qFUP³W½d¼Æ¾Ú¥Î¶q¥H128kbps´£¨ÑªA°È¡A¦Ü¦¸¤ë°_«ì´_¥þ³t¡C·q½Ð¯d·N¡C·PÁÂ±z¨Ï¥ÎHKNet¡A¦p¦³ºÃ°Ý½ÐÁpµ¸ +852-37930860¡C<br><br>Dear HKNet Oneness SIM customer (89852660000005138929), please be informed that your HK mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact  +852-37930860 if any queries.</body></html>
<br>SendDate: Mon Mar 09 17:29:03 CST 2015
2015-03-09 17:29:06,764 [DEBUG] (DVRSmain.java:2278) - execute SQL : INSERT INTO HUR_SMS_LOG(ID,SEND_NUMBER,MSG,SEND_DATE,RESULT,CREATE_DATE) VALUES(DVRS_SMS_ID.NEXTVAL,'k1988242001@gmail.com','?iHKNet Oneness SIM???????q?q???j?L¡Pq??HKNet Oneness SIM????(89852660000005138929)¡Óz?n?A¡Óz?b?????????????q?w?F2GB?A???????qFUP?W?d???????q?H128kbps?????A¢X??A??????¢X_???_???t?C¡Pq??¡Âd¡PN?C¡PP??¡Óz????HKNet?A?p????¢X????p?? +852-37930860?C<br><br>Dear HKNet Oneness SIM customer (89852660000005138929), please be informed that your HK mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact  +852-37930860 if any queries.',TO_DATE('2015/03/09 17:29:06','yyyy/MM/dd HH24:mi:ss'),'success',SYSDATE)
2015-03-09 17:29:06,764 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 17:29:06,804 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :3864
2015-03-09 17:29:06,820 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 17:29:06,820 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 17:29:06,820 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 17:29:06,820 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 17:29:06,820 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 17:29:06,820 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 17:29:06,835 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 17:29:06,866 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 17:29:06,866 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 17:29:06,866 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 17:29:06,960 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :156
2015-03-09 17:29:06,960 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 17:29:06,960 [ INFO] (DVRSmain.java:3044) - Program execute time :146222
2015-03-09 17:29:06,960 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 17:29:06,977 [ INFO] (DVRSmain.java:1135) - closeConnect2...
2015-03-09 17:29:49,311 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 17:29:49,311 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 17:29:49,389 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 17:29:49 CST 2015
2015-03-09 17:29:49,389 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:29:50,076 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:29:50,076 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 17:29:50,076 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:29:50,435 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:29:50,435 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 17:29:50,435 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 17:29:50,435 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 17:29:50,435 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 17:29:50,451 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 17:29:50,451 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 17:29:50,466 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 17:31:31,353 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :100902
2015-03-09 17:31:31,353 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 17:31:31,354 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 17:32:53,204 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :81851
2015-03-09 17:32:53,204 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 17:32:53,205 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 17:32:53,236 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 17:32:53,251 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :47
2015-03-09 17:32:53,251 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 17:32:53,251 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 17:32:53,298 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 17:32:53,314 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 17:32:53,314 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 17:32:53,314 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 17:32:53,407 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :156
2015-03-09 17:32:53,407 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 17:32:53,423 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 17:32:53,470 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 17:32:53,673 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :266
2015-03-09 17:32:53,673 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 17:32:53,673 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 17:32:53,688 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 17:32:54,831 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1158
2015-03-09 17:32:54,831 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 17:32:54,831 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 17:33:17,844 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :23013
2015-03-09 17:33:17,859 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 17:33:17,907 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :63
2015-03-09 17:33:17,907 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 17:33:17,923 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 17:33:32,796 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :14889
2015-03-09 17:33:32,796 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 17:33:32,812 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 17:33:34,767 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :1971
2015-03-09 17:33:34,767 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 17:33:34,767 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 17:33:35,111 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :344
2015-03-09 17:33:35,111 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 17:33:35,111 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 17:33:35,158 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :47
2015-03-09 17:33:35,158 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 17:33:35,158 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 17:33:35,907 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :749
2015-03-09 17:33:35,907 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 17:33:35,907 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 17:33:35,923 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 17:33:35,923 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 17:33:35,956 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 17:33:35,956 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 17:33:35,956 [ INFO] (DVRSmain.java:3003) - charge execute time :49
2015-03-09 17:33:35,956 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 17:33:35,956 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 17:33:35,971 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:33:35,971 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:33:35,971 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:33:35,971 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:33:35,971 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:33:35,971 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:33:36,002 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 17:33:36,049 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 17:33:36,049 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 17:33:36,065 [ INFO] (DVRSmain.java:2263) - For 40705 send 2.0GB decrease speed  message !
2015-03-09 17:33:36,065 [ INFO] (Jatool.java:67) - get Properites!
2015-03-09 17:33:36,065 [ INFO] (Jatool.java:67) - Connect to Host : 106.186.120.118
2015-03-09 17:33:36,065 [ INFO] (Jatool.java:67) - port : null
2015-03-09 17:33:36,065 [ INFO] (Jatool.java:67) - use authority : true
2015-03-09 17:33:36,065 [DEBUG] (Jatool.java:69) - Creat mail Session!
2015-03-09 17:33:36,112 [DEBUG] (Jatool.java:69) - set mail content!
2015-03-09 17:33:37,593 [ INFO] (Jatool.java:67) - sending mail from HKNet@sim2travel.com to k1988242001@gmail.com,douglas.chuang@sim2travel.com,yvonne.lin@sim2travel.com
<br>Subject : Notification on FUP 100% 2GB
<br>Content : <html><body>¡iHKNet Oneness SIM¼Æ¾Ú¥Î¶q³qª¾¡j´L·qªºHKNet Oneness SIM¥Î¤á(89852660000005138929)±z¦n¡A±z¦b­»´äªº¼Æ¾Ú¥Î¶q¤w¹F2GB¡A«ö¥»¤½¥qFUP³W½d¼Æ¾Ú¥Î¶q¥H128kbps´£¨ÑªA°È¡A¦Ü¦¸¤ë°_«ì´_¥þ³t¡C·q½Ð¯d·N¡C·PÁÂ±z¨Ï¥ÎHKNet¡A¦p¦³ºÃ°Ý½ÐÁpµ¸ +852-37930860¡C<br><br>Dear HKNet Oneness SIM customer (89852660000005138929), please be informed that your HK mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact  +852-37930860 if any queries.</body></html>
<br>SendDate: Mon Mar 09 17:33:36 CST 2015
2015-03-09 17:33:37,610 [DEBUG] (DVRSmain.java:2278) - execute SQL : INSERT INTO HUR_SMS_LOG(ID,SEND_NUMBER,MSG,SEND_DATE,RESULT,CREATE_DATE) VALUES(DVRS_SMS_ID.NEXTVAL,'k1988242001@gmail.com,douglas.chuang@sim2travel.com,yvonne.lin@sim2travel.com','?iHKNet Oneness SIM???????q?q???j?L¡Pq??HKNet Oneness SIM????(89852660000005138929)¡Óz?n?A¡Óz?b?????????????q?w?F2GB?A???????qFUP?W?d???????q?H128kbps?????A¢X??A??????¢X_???_???t?C¡Pq??¡Âd¡PN?C¡PP??¡Óz????HKNet?A?p????¢X????p?? +852-37930860?C<br><br>Dear HKNet Oneness SIM customer (89852660000005138929), please be informed that your HK mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact  +852-37930860 if any queries.',TO_DATE('2015/03/09 17:33:37','yyyy/MM/dd HH24:mi:ss'),'success',SYSDATE)
2015-03-09 17:33:37,610 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 17:33:37,610 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :1654
2015-03-09 17:33:37,641 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 17:33:37,641 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 17:33:37,641 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 17:33:37,641 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 17:33:37,641 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 17:33:37,641 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 17:33:37,641 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 17:33:37,657 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 17:33:37,657 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 17:33:37,672 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 17:33:37,688 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :78
2015-03-09 17:33:37,688 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 17:33:37,688 [ INFO] (DVRSmain.java:3044) - Program execute time :227253
2015-03-09 17:33:37,688 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 17:33:37,704 [ INFO] (DVRSmain.java:1135) - closeConnect2...
2015-03-09 17:34:07,308 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 17:34:07 CST 2015
2015-03-09 17:34:07,792 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:34:08,182 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:34:08,182 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 17:34:08,182 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:34:08,432 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:34:08,432 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 17:34:08,432 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 17:34:08,432 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 17:34:08,432 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 17:34:08,432 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 17:34:08,432 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 17:34:08,432 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 17:35:04,260 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 17:35:04 CST 2015
2015-03-09 17:35:04,751 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:35:05,344 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:35:05,344 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 17:35:05,344 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:35:05,629 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:35:05,629 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 17:35:05,629 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 17:35:05,629 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 17:35:05,629 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 17:35:05,629 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 17:35:05,644 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 17:35:05,660 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 17:35:12,127 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :63695
2015-03-09 17:35:12,127 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 17:35:12,127 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 17:36:35,583 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :83456
2015-03-09 17:36:35,583 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 17:36:35,599 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 17:36:35,630 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 17:36:35,630 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :47
2015-03-09 17:36:35,630 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 17:36:35,630 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :0
2015-03-09 17:36:35,630 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 17:36:35,646 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 17:36:35,661 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 17:36:35,770 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :140
2015-03-09 17:36:35,770 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 17:36:35,770 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 17:36:35,787 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 17:36:36,896 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1126
2015-03-09 17:36:36,896 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 17:36:36,911 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 17:36:40,716 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :95072
2015-03-09 17:36:40,716 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 17:36:40,731 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 17:36:59,192 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :22296
2015-03-09 17:36:59,192 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 17:36:59,254 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :62
2015-03-09 17:36:59,254 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 17:36:59,254 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 17:37:09,878 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :10624
2015-03-09 17:37:09,878 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 17:37:09,894 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 17:37:11,787 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :1909
2015-03-09 17:37:11,787 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 17:37:11,787 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 17:37:12,099 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :312
2015-03-09 17:37:12,099 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 17:37:12,115 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 17:37:12,146 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :47
2015-03-09 17:37:12,146 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 17:37:12,162 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 17:37:12,991 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :845
2015-03-09 17:37:12,991 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 17:37:12,991 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 17:37:13,022 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 17:37:13,022 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 17:37:13,022 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 17:37:13,022 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 17:37:13,022 [ INFO] (DVRSmain.java:3003) - charge execute time :31
2015-03-09 17:37:13,022 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 17:37:13,038 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 17:37:13,053 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:37:13,053 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:37:13,053 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:37:13,053 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:37:13,053 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:37:13,053 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:37:13,069 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 17:37:13,131 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 17:37:13,131 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 17:37:13,147 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 17:37:13,147 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :125
2015-03-09 17:37:13,148 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 17:37:13,148 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 17:37:13,148 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 17:37:13,148 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 17:37:13,148 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 17:37:13,148 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 17:37:13,148 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 17:37:13,179 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 17:37:13,179 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 17:37:13,492 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 17:37:13,523 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :376
2015-03-09 17:37:13,523 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 17:37:13,523 [ INFO] (DVRSmain.java:3044) - Program execute time :185091
2015-03-09 17:37:13,523 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 17:37:13,523 [ INFO] (DVRSmain.java:1135) - closeConnect2...
2015-03-09 17:37:26,892 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :46176
2015-03-09 17:37:26,892 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 17:37:26,908 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 17:37:26,970 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 17:37:26,986 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :94
2015-03-09 17:37:26,986 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 17:37:26,986 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :0
2015-03-09 17:37:26,986 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 17:37:26,986 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 17:37:27,017 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 17:37:27,110 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :124
2015-03-09 17:37:27,110 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 17:37:27,110 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 17:37:27,142 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 17:37:28,220 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1110
2015-03-09 17:37:28,220 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 17:37:28,220 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 17:37:50,350 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :22130
2015-03-09 17:37:50,350 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 17:37:50,413 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :63
2015-03-09 17:37:50,413 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 17:37:50,428 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 17:38:00,565 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :10152
2015-03-09 17:38:00,565 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 17:38:00,580 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 17:38:02,485 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :1920
2015-03-09 17:38:02,485 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 17:38:02,485 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 17:38:02,766 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :281
2015-03-09 17:38:02,766 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 17:38:02,766 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 17:38:02,812 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :46
2015-03-09 17:38:02,812 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 17:38:02,812 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 17:38:03,565 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :753
2015-03-09 17:38:03,565 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 17:38:03,565 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 17:38:03,597 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 17:38:03,597 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 17:38:03,597 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 17:38:03,597 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 17:38:03,597 [ INFO] (DVRSmain.java:3003) - charge execute time :32
2015-03-09 17:38:03,597 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 17:38:03,613 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 17:38:03,629 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:38:03,629 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:38:03,629 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:38:03,629 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:38:03,629 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:38:03,629 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:38:03,644 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 17:38:03,707 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 17:38:03,707 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 17:38:03,707 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 17:38:03,722 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :125
2015-03-09 17:38:03,722 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 17:38:03,722 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 17:38:03,722 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 17:38:03,722 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 17:38:03,722 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 17:38:03,722 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 17:38:03,738 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 17:38:03,753 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 17:38:03,753 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 17:38:03,753 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 17:38:03,800 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :78
2015-03-09 17:38:03,800 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 17:38:03,800 [ INFO] (DVRSmain.java:3044) - Program execute time :178171
2015-03-09 17:38:03,800 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 17:38:03,800 [ INFO] (DVRSmain.java:1135) - closeConnect2...
2015-03-09 17:40:45,874 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 17:40:45,889 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 17:40:46,062 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 17:40:46 CST 2015
2015-03-09 17:40:46,062 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:40:47,014 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:40:47,014 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 17:40:47,014 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:40:47,186 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:40:47,186 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 17:40:47,186 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 17:40:47,186 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 17:40:47,186 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 17:40:47,202 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 17:40:47,264 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 17:40:47,264 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 17:41:45,499 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :58235
2015-03-09 17:41:45,499 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 17:41:45,499 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 17:42:29,701 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :44202
2015-03-09 17:42:29,701 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 17:42:29,702 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 17:42:29,734 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 17:42:29,734 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :33
2015-03-09 17:42:29,749 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 17:42:29,749 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 17:42:29,765 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 17:42:29,780 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 17:42:29,780 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 17:42:29,780 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 17:42:29,843 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :94
2015-03-09 17:42:29,843 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 17:42:29,843 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 17:42:29,858 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 17:42:29,968 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :125
2015-03-09 17:42:29,968 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 17:42:29,968 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 17:42:29,983 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 17:42:31,046 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1078
2015-03-09 17:42:31,046 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 17:42:31,046 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 17:42:57,056 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :26010
2015-03-09 17:42:57,088 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 17:42:57,151 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :95
2015-03-09 17:42:57,151 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 17:42:57,151 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 17:43:08,284 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :11133
2015-03-09 17:43:08,284 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 17:43:08,285 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 17:43:10,291 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :2007
2015-03-09 17:43:10,291 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 17:43:10,292 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 17:43:10,589 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :298
2015-03-09 17:43:10,589 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 17:43:10,604 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 17:43:10,635 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :46
2015-03-09 17:43:10,635 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 17:43:10,635 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 17:43:11,322 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :687
2015-03-09 17:43:11,322 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 17:43:11,322 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 17:43:11,354 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 17:43:11,370 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 17:43:11,370 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 17:43:11,370 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 17:43:11,370 [ INFO] (DVRSmain.java:3003) - charge execute time :48
2015-03-09 17:43:11,370 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 17:43:11,370 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 17:43:11,401 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:43:11,401 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:43:11,401 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:43:11,401 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:43:11,401 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:43:11,401 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:43:11,416 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 17:43:11,479 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 17:43:11,479 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 17:43:11,480 [ INFO] (DVRSmain.java:2263) - For 40705 send 2.0GB decrease speed  message !
2015-03-09 17:43:11,480 [ INFO] (Jatool.java:67) - get Properites!
2015-03-09 17:43:11,480 [ INFO] (Jatool.java:67) - Connect to Host : 106.186.120.118
2015-03-09 17:43:11,480 [ INFO] (Jatool.java:67) - port : null
2015-03-09 17:43:11,480 [ INFO] (Jatool.java:67) - use authority : true
2015-03-09 17:43:11,480 [DEBUG] (Jatool.java:69) - Creat mail Session!
2015-03-09 17:43:11,527 [DEBUG] (Jatool.java:69) - set mail content!
2015-03-09 17:43:13,710 [ INFO] (Jatool.java:67) - sending mail from HKNet@sim2travel.com to k1988242001@gmail.com,douglas.chuang@sim2travel.com,yvonne.lin@sim2travel.com
<br>Subject : Notification on FUP 100% 2GB
<br>Content : <html><body>¡iHKNet Oneness SIM¼Æ¾Ú¥Î¶q³qª¾¡j´L·qªºHKNet Oneness SIM¥Î¤á(89852660000005138929)±z¦n¡A±z¦b­»´äªº¼Æ¾Ú¥Î¶q¤w¹F2GB¡A«ö¥»¤½¥qFUP³W½d¼Æ¾Ú¥Î¶q¥H128kbps´£¨ÑªA°È¡A¦Ü¦¸¤ë°_«ì´_¥þ³t¡C·q½Ð¯d·N¡C·PÁÂ±z¨Ï¥ÎHKNet¡A¦p¦³ºÃ°Ý½ÐÁpµ¸ +852-37930860¡C<br><br>Dear HKNet Oneness SIM customer (89852660000005138929), please be informed that your HK mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact  +852-37930860 if any queries.</body></html>
<br>SendDate: Mon Mar 09 17:43:11 CST 2015
2015-03-09 17:43:13,711 [DEBUG] (DVRSmain.java:2278) - execute SQL : INSERT INTO HUR_SMS_LOG(ID,SEND_NUMBER,MSG,SEND_DATE,RESULT,CREATE_DATE) VALUES(DVRS_SMS_ID.NEXTVAL,'k1988242001@gmail.com,douglas.chuang@sim2travel.com,yvonne.lin@sim2travel.com','?iHKNet Oneness SIM???????q?q???j?L¡Pq??HKNet Oneness SIM????(89852660000005138929)¡Óz?n?A¡Óz?b?????????????q?w?F2GB?A???????qFUP?W?d???????q?H128kbps?????A¢X??A??????¢X_???_???t?C¡Pq??¡Âd¡PN?C¡PP??¡Óz????HKNet?A?p????¢X????p?? +852-37930860?C<br><br>Dear HKNet Oneness SIM customer (89852660000005138929), please be informed that your HK mobile data usage has reached 2GB. When reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact  +852-37930860 if any queries.',TO_DATE('2015/03/09 17:43:13','yyyy/MM/dd HH24:mi:ss'),'success',SYSDATE)
2015-03-09 17:43:13,727 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 17:43:13,743 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :2373
2015-03-09 17:43:13,743 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 17:43:13,743 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 17:43:13,743 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 17:43:13,758 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 17:43:13,758 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 17:43:13,758 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 17:43:13,758 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 17:43:13,774 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 17:43:13,774 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 17:43:13,774 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 17:43:13,805 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :62
2015-03-09 17:43:13,805 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 17:43:13,805 [ INFO] (DVRSmain.java:3044) - Program execute time :146619
2015-03-09 17:43:13,805 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 17:43:13,805 [ INFO] (DVRSmain.java:1135) - closeConnect2...
2015-03-09 17:44:26,112 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 17:44:26 CST 2015
2015-03-09 17:44:26,241 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:44:26,694 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:44:26,694 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 17:44:26,694 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:44:27,006 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:44:27,006 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 17:44:27,006 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 17:44:27,006 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 17:44:27,006 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 17:44:27,006 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 17:44:27,006 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 17:44:27,022 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 17:45:25,387 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :58381
2015-03-09 17:45:25,387 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 17:45:25,387 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 17:46:05,925 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 17:46:05,987 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 17:46:06,114 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 17:46:06 CST 2015
2015-03-09 17:46:06,114 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:46:06,863 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:46:06,863 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 17:46:06,863 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:46:07,113 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:46:07,113 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 17:46:07,113 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 17:46:07,113 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 17:46:07,113 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 17:46:07,113 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 17:46:07,113 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 17:46:07,129 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 17:46:17,306 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :51919
2015-03-09 17:46:17,306 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 17:46:17,307 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 17:46:17,339 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 17:46:17,339 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :33
2015-03-09 17:46:17,339 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 17:46:17,354 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :15
2015-03-09 17:46:17,354 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 17:46:17,370 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 17:46:17,385 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 17:46:17,495 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :141
2015-03-09 17:46:17,495 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 17:46:17,495 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 17:46:17,510 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 17:46:18,524 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1029
2015-03-09 17:46:18,524 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 17:46:18,524 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 17:46:51,391 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :32867
2015-03-09 17:46:51,407 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 17:46:51,455 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :64
2015-03-09 17:46:51,455 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 17:46:51,470 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 17:47:02,095 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :10640
2015-03-09 17:47:02,095 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 17:47:02,110 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 17:47:04,094 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :1999
2015-03-09 17:47:04,094 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 17:47:04,110 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 17:47:04,423 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :329
2015-03-09 17:47:04,423 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 17:47:04,423 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 17:47:04,454 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :31
2015-03-09 17:47:04,454 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 17:47:04,470 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 17:47:05,187 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :733
2015-03-09 17:47:05,187 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 17:47:05,187 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 17:47:05,204 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 17:47:05,220 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 17:47:05,220 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 17:47:05,220 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 17:47:05,220 [ INFO] (DVRSmain.java:3003) - charge execute time :33
2015-03-09 17:47:05,220 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 17:47:05,235 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 17:47:05,251 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:47:05,251 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:47:05,251 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:47:05,251 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:47:05,251 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:47:05,251 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:47:05,266 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 17:47:05,344 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 17:47:05,344 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 17:47:05,360 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 17:47:05,360 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :140
2015-03-09 17:47:05,376 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 17:47:05,376 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 17:47:05,376 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 17:47:05,376 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 17:47:05,376 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 17:47:05,376 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 17:47:05,376 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 17:47:05,391 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 17:47:05,391 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 17:47:05,407 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 17:47:05,422 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :62
2015-03-09 17:47:05,422 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 17:47:05,422 [ INFO] (DVRSmain.java:3044) - Program execute time :158416
2015-03-09 17:47:05,422 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 17:47:05,438 [ INFO] (DVRSmain.java:1135) - closeConnect2...
2015-03-09 17:47:20,364 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :73251
2015-03-09 17:47:20,364 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 17:47:20,380 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 17:48:10,809 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :50445
2015-03-09 17:48:10,809 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 17:48:10,810 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 17:48:10,872 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 17:48:10,888 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :79
2015-03-09 17:48:10,888 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 17:48:10,919 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 17:48:10,950 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 17:48:10,981 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 17:48:10,981 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 17:48:10,981 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 17:48:11,044 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :156
2015-03-09 17:48:11,044 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 17:48:11,044 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 17:48:11,075 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 17:48:11,184 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :140
2015-03-09 17:48:11,184 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 17:48:11,184 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 17:48:11,215 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 17:48:12,340 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1156
2015-03-09 17:48:12,340 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 17:48:12,341 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 17:48:34,695 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :22355
2015-03-09 17:48:34,696 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 17:48:34,759 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :64
2015-03-09 17:48:34,774 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 17:48:34,774 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 17:48:45,428 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :10654
2015-03-09 17:48:45,428 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 17:48:45,444 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 17:48:47,348 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :1920
2015-03-09 17:48:47,348 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 17:48:47,349 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 17:48:47,661 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :313
2015-03-09 17:48:47,661 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 17:48:47,676 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 17:48:47,708 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :47
2015-03-09 17:48:47,708 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 17:48:47,708 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 17:48:48,474 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :766
2015-03-09 17:48:48,474 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 17:48:48,474 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 17:48:48,506 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 17:48:48,506 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 17:48:48,522 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 17:48:48,522 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 17:48:48,522 [ INFO] (DVRSmain.java:3003) - charge execute time :48
2015-03-09 17:48:48,522 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 17:48:48,522 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 17:48:48,553 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:48:48,553 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:48:48,553 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:48:48,553 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:48:48,553 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:48:48,553 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:48:48,569 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 17:48:48,615 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 17:48:48,615 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 17:50:02,779 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 17:50:02,795 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1572864.0
DEFAULT_VOLUME_THRESHOLD2 : 2097152.0
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 17:50:03,030 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 17:50:03 CST 2015
2015-03-09 17:50:03,030 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:50:03,872 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:50:03,872 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 17:50:03,872 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:50:04,185 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:50:04,185 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 17:50:04,185 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 17:50:04,185 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 17:50:04,185 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 17:50:04,201 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 17:50:04,201 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 17:50:04,201 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 17:50:14,308 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 17:50:14 CST 2015
2015-03-09 17:50:14,527 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:50:15,693 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:50:15,693 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 17:50:15,693 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:50:16,058 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:50:16,058 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 17:50:16,058 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 17:50:16,058 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 17:50:16,058 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 17:50:16,058 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 17:50:16,089 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 17:50:16,089 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 17:51:05,470 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :61269
2015-03-09 17:51:05,486 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 17:51:05,486 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 17:51:20,626 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :64568
2015-03-09 17:51:20,626 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 17:51:20,627 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 17:51:49,999 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :44513
2015-03-09 17:51:49,999 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 17:51:50,000 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 17:51:50,047 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 17:51:50,047 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :48
2015-03-09 17:51:50,047 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 17:51:50,047 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 17:51:50,078 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 17:51:50,094 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 17:51:50,094 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 17:51:50,094 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 17:51:50,125 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :78
2015-03-09 17:51:50,125 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 17:51:50,140 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 17:51:50,204 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 17:51:50,313 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :188
2015-03-09 17:51:50,313 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 17:51:50,313 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 17:51:50,360 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 17:51:51,487 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1174
2015-03-09 17:51:51,487 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 17:51:51,487 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 17:52:09,153 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :48527
2015-03-09 17:52:09,153 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 17:52:09,154 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 17:52:09,185 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 17:52:09,201 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :48
2015-03-09 17:52:09,201 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 17:52:09,326 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :125
2015-03-09 17:52:09,326 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 17:52:09,326 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 17:52:09,357 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 17:52:09,497 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :171
2015-03-09 17:52:09,497 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 17:52:09,497 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 17:52:09,528 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 17:52:11,185 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1688
2015-03-09 17:52:11,185 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 17:52:11,185 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 17:52:14,198 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :22711
2015-03-09 17:52:14,198 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 17:52:14,261 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :63
2015-03-09 17:52:14,261 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 17:52:14,339 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 17:52:27,528 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :13267
2015-03-09 17:52:27,528 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 17:52:27,529 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 17:52:29,808 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :2280
2015-03-09 17:52:29,808 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 17:52:29,809 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 17:52:30,183 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :375
2015-03-09 17:52:30,183 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 17:52:30,199 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 17:52:30,245 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :62
2015-03-09 17:52:30,245 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 17:52:30,245 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 17:52:31,072 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :827
2015-03-09 17:52:31,072 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 17:52:31,072 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 17:52:31,104 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 17:52:31,104 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 17:52:31,120 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 17:52:31,120 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 17:52:31,120 [ INFO] (DVRSmain.java:3003) - charge execute time :48
2015-03-09 17:52:31,120 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 17:52:31,120 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 17:52:31,151 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:52:31,151 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:52:31,151 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:52:31,151 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:52:31,151 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:52:31,151 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:52:31,167 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 17:52:31,229 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 17:52:31,229 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 17:52:35,981 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :24796
2015-03-09 17:52:35,982 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 17:52:36,044 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :63
2015-03-09 17:52:36,044 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 17:52:36,044 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 17:52:46,389 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :10345
2015-03-09 17:52:46,389 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 17:52:46,390 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 17:52:48,329 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :1940
2015-03-09 17:52:48,329 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 17:52:48,330 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 17:52:48,642 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :313
2015-03-09 17:52:48,642 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 17:52:48,657 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 17:52:48,688 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :46
2015-03-09 17:52:48,688 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 17:52:48,704 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 17:52:49,422 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :734
2015-03-09 17:52:49,422 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 17:52:49,422 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 17:52:49,469 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 17:52:49,485 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 17:52:49,485 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 17:52:49,485 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 17:52:49,485 [ INFO] (DVRSmain.java:3003) - charge execute time :63
2015-03-09 17:52:49,485 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 17:52:49,501 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 17:52:49,516 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:52:49,516 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:52:49,516 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:52:49,516 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:52:49,516 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:52:49,516 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:52:49,532 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 17:52:49,594 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 17:52:49,594 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 17:52:49,610 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 17:52:49,610 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :125
2015-03-09 17:52:49,625 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 17:52:49,625 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 17:52:49,625 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 17:52:49,625 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 17:52:49,625 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 17:52:49,625 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 17:52:49,625 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 17:52:49,641 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 17:52:49,641 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 17:52:49,657 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 17:52:49,672 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :62
2015-03-09 17:52:49,672 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 17:52:49,672 [ INFO] (DVRSmain.java:3044) - Program execute time :153614
2015-03-09 17:52:49,672 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 17:52:49,688 [ INFO] (DVRSmain.java:1135) - closeConnect2...
2015-03-09 17:55:21,700 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 17:55:21,715 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1.610612736E9
DEFAULT_VOLUME_THRESHOLD2 : 2.147483648E9
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 17:55:21,859 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 17:55:21 CST 2015
2015-03-09 17:55:21,859 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:55:22,639 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:55:22,639 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 17:55:22,639 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:55:23,719 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:55:23,719 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 17:55:23,719 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 17:55:23,719 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 17:55:23,719 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 17:55:23,736 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 17:55:23,829 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 17:55:23,829 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 17:55:30,018 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 17:55:30,034 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1.610612736E9
DEFAULT_VOLUME_THRESHOLD2 : 2.147483648E9
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 17:55:30,192 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 17:55:30 CST 2015
2015-03-09 17:55:30,192 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:55:30,692 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:55:30,692 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 17:55:30,692 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:55:30,910 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:55:30,910 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 17:55:30,910 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 17:55:30,910 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 17:55:30,910 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 17:55:30,910 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 17:55:30,910 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 17:55:30,910 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 17:56:29,406 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :58496
2015-03-09 17:56:29,406 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 17:56:29,421 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 17:57:14,247 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :44841
2015-03-09 17:57:14,247 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 17:57:14,263 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 17:57:14,264 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 17:57:14,264 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :17
2015-03-09 17:57:14,264 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 17:57:14,311 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 17:57:14,358 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 17:57:14,373 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 17:57:14,373 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 17:57:14,373 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 17:57:14,420 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :156
2015-03-09 17:57:14,420 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 17:57:14,436 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 17:57:14,451 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 17:57:14,545 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :125
2015-03-09 17:57:14,545 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 17:57:14,560 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 17:57:14,576 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 17:57:15,609 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1064
2015-03-09 17:57:15,609 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 17:57:15,609 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 17:57:46,172 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :30563
2015-03-09 17:57:46,173 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 17:57:46,235 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :63
2015-03-09 17:57:46,235 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 17:57:46,251 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 17:57:57,132 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :10897
2015-03-09 17:57:57,132 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 17:57:57,132 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 17:57:59,098 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :1966
2015-03-09 17:57:59,098 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 17:57:59,099 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 17:57:59,411 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :313
2015-03-09 17:57:59,411 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 17:57:59,411 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 17:57:59,458 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :47
2015-03-09 17:57:59,458 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 17:57:59,458 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 17:58:00,207 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :749
2015-03-09 17:58:00,207 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 17:58:00,207 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 17:58:00,254 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 17:58:00,254 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 17:58:00,270 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 17:58:00,270 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 17:58:00,270 [ INFO] (DVRSmain.java:3003) - charge execute time :63
2015-03-09 17:58:00,270 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 17:58:00,270 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 17:58:00,286 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:58:00,286 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 17:58:00,286 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:58:00,286 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 17:58:00,286 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:58:00,286 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 17:58:00,301 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 17:58:00,364 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 17:58:00,364 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 17:58:59,868 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 17:58:59,884 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :59614
2015-03-09 17:58:59,884 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 17:58:59,899 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 17:58:59,899 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 17:58:59,899 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 17:58:59,899 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 17:58:59,899 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 17:58:59,899 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 17:58:59,900 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 17:58:59,900 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 17:58:59,900 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 17:58:59,947 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :63
2015-03-09 17:58:59,947 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 17:58:59,947 [ INFO] (DVRSmain.java:3044) - Program execute time :209037
2015-03-09 17:58:59,947 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 17:58:59,963 [ INFO] (DVRSmain.java:1135) - closeConnect2...
2015-03-09 17:59:23,823 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 17:59:23,823 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1.610612736E9
DEFAULT_VOLUME_THRESHOLD2 : 2.147483648E9
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 17:59:23,903 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 17:59:23 CST 2015
2015-03-09 17:59:23,903 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:59:24,418 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:59:24,418 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 17:59:24,418 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 17:59:24,652 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 17:59:24,652 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 17:59:24,652 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 17:59:24,652 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 17:59:24,652 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 17:59:24,652 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 17:59:24,652 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 17:59:24,667 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 18:00:22,522 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :57870
2015-03-09 18:00:22,522 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 18:00:22,538 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 18:01:29,278 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :66756
2015-03-09 18:01:29,278 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 18:01:29,278 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 18:01:29,310 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 18:01:29,310 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :32
2015-03-09 18:01:29,310 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 18:01:29,325 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 18:01:29,341 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 18:01:29,357 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 18:01:29,357 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 18:01:29,357 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 18:01:29,435 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :125
2015-03-09 18:01:29,435 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 18:01:29,450 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 18:01:29,466 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 18:01:29,577 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :142
2015-03-09 18:01:29,577 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 18:01:29,593 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 18:01:29,608 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 18:01:30,673 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1096
2015-03-09 18:01:30,673 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 18:01:30,674 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 18:01:57,738 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :27065
2015-03-09 18:01:57,738 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 18:01:57,786 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :48
2015-03-09 18:01:57,786 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 18:01:57,801 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 18:02:08,358 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :10572
2015-03-09 18:02:08,358 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 18:02:08,359 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 18:02:10,321 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :1963
2015-03-09 18:02:10,321 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 18:02:10,322 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 18:02:10,621 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :300
2015-03-09 18:02:10,621 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 18:02:10,621 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 18:02:10,652 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :31
2015-03-09 18:02:10,652 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 18:02:10,667 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 18:02:11,416 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :764
2015-03-09 18:02:11,416 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 18:02:11,416 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 18:02:11,448 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 18:02:11,464 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 18:02:11,464 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 18:02:11,464 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 18:02:11,464 [ INFO] (DVRSmain.java:3003) - charge execute time :48
2015-03-09 18:02:11,464 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 18:02:11,464 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 18:02:11,495 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 18:02:11,495 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 18:02:11,495 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 18:02:11,495 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 18:02:11,495 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 18:02:11,495 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 18:02:11,511 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 18:02:11,558 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 18:02:11,558 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 18:02:37,887 [ INFO] (DVRSmain.java:976) - Logger Load Success!
2015-03-09 18:02:37,887 [ INFO] (DVRSmain.java:993) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1.610612736E9
DEFAULT_VOLUME_THRESHOLD2 : 2.147483648E9
DEFAULT_PHONE : 886972713897
RUN_INTERVAL : 3600
TEST_MODE : true
dataThreshold : 800
exchangeRate : 4.0
kByte : 9.765625E-4

2015-03-09 18:02:37,967 [ INFO] (DVRSmain.java:2914) - RFP Program Start! Mon Mar 09 18:02:37 CST 2015
2015-03-09 18:02:37,967 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 18:02:38,482 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 18:02:38,482 [ INFO] (DVRSmain.java:1047) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-03-09 18:02:38,482 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-03-09 18:02:38,763 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-03-09 18:02:38,763 [ INFO] (DVRSmain.java:1088) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-03-09 18:02:38,763 [DEBUG] (DVRSmain.java:2922) - connect success!
2015-03-09 18:02:38,763 [ INFO] (DVRSmain.java:1154) - cancelAutoCommit...
2015-03-09 18:02:38,763 [ INFO] (DVRSmain.java:1156) - set AutoCommit false!
2015-03-09 18:02:38,778 [ INFO] (DVRSmain.java:139) - setMonthDate...
2015-03-09 18:02:38,778 [ INFO] (DVRSmain.java:846) - setIMSItoServiceIDMap...
2015-03-09 18:02:38,778 [ INFO] (DVRSmain.java:872) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-03-09 18:03:47,796 [ INFO] (DVRSmain.java:2935) - setIMSItoServiceIDMap execute time :69018
2015-03-09 18:03:47,796 [ INFO] (DVRSmain.java:892) - setServiceIDtoImsiMap...
2015-03-09 18:03:47,796 [ INFO] (DVRSmain.java:918) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-03-09 18:04:32,591 [ INFO] (DVRSmain.java:2940) - setServiceIDtoImsiMap execute time :44795
2015-03-09 18:04:32,591 [ INFO] (DVRSmain.java:184) - setLastFileID...
2015-03-09 18:04:32,595 [DEBUG] (DVRSmain.java:190) - Execute SQL : SELECT MAX(A.LAST_FILEID) id FROM HUR_CURRENT A
2015-03-09 18:04:32,651 [ INFO] (DVRSmain.java:196) - Last process file ID :14333
2015-03-09 18:04:32,651 [ INFO] (DVRSmain.java:2945) - setLastFileID execute time :60
2015-03-09 18:04:32,651 [ INFO] (DVRSmain.java:219) - setCurrentMap...
2015-03-09 18:04:32,651 [DEBUG] (DVRSmain.java:228) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201503','201502') 
2015-03-09 18:04:32,667 [DEBUG] (DVRSmain.java:230) - Set current map...
2015-03-09 18:04:32,699 [ INFO] (DVRSmain.java:283) - setoldChargeMap...
2015-03-09 18:04:32,699 [ INFO] (DVRSmain.java:332) - setCurrentMapDay...
2015-03-09 18:04:32,699 [DEBUG] (DVRSmain.java:338) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201503','201502') 
2015-03-09 18:04:32,745 [ INFO] (DVRSmain.java:2952) - setCurrentMap execute time :94
2015-03-09 18:04:32,745 [ INFO] (DVRSmain.java:458) - setThreshold...
2015-03-09 18:04:32,745 [DEBUG] (DVRSmain.java:465) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-03-09 18:04:32,761 [DEBUG] (DVRSmain.java:468) - Set dataRate map...
2015-03-09 18:04:32,855 [ INFO] (DVRSmain.java:2957) - setThreshold execute time :110
2015-03-09 18:04:32,855 [ INFO] (DVRSmain.java:407) - setDataRate...
2015-03-09 18:04:32,870 [DEBUG] (DVRSmain.java:414) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP FROM HUR_DATA_RATE A 
2015-03-09 18:04:32,886 [DEBUG] (DVRSmain.java:417) - Set dataRate map...
2015-03-09 18:04:33,978 [ INFO] (DVRSmain.java:2962) - setDataRate execute time :1123
2015-03-09 18:04:33,978 [ INFO] (DVRSmain.java:786) - setMsisdnMap...
2015-03-09 18:04:33,978 [ INFO] (DVRSmain.java:809) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-03-09 18:04:57,983 [ INFO] (DVRSmain.java:2967) - setMsisdnMap execute time :24005
2015-03-09 18:04:57,984 [DEBUG] (DVRSmain.java:748) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-03-09 18:04:58,046 [ INFO] (DVRSmain.java:2973) - setIPtoMccmncList execute time :63
2015-03-09 18:04:58,046 [ INFO] (DVRSmain.java:491) - setSERVICEIDtoVLN...
2015-03-09 18:04:58,046 [DEBUG] (DVRSmain.java:499) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-03-09 18:05:09,475 [ INFO] (DVRSmain.java:2978) - setSERVICEIDtoVLN execute time :11429
2015-03-09 18:05:09,475 [ INFO] (DVRSmain.java:527) - setVLNtoTADIG...
2015-03-09 18:05:09,475 [DEBUG] (DVRSmain.java:535) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-03-09 18:05:11,490 [ INFO] (DVRSmain.java:2983) - setVLNtoTADIG execute time :2015
2015-03-09 18:05:11,490 [ INFO] (DVRSmain.java:561) - setTADIGtoMCCMNC...
2015-03-09 18:05:11,490 [DEBUG] (DVRSmain.java:568) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-03-09 18:05:11,819 [ INFO] (DVRSmain.java:2988) - setTADIGtoMCCMNC execute time :329
2015-03-09 18:05:11,819 [ INFO] (DVRSmain.java:594) - setCostomerNumber...
2015-03-09 18:05:11,819 [DEBUG] (DVRSmain.java:601) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-03-09 18:05:11,850 [ INFO] (DVRSmain.java:2993) - setCostomerNumber execute time :31
2015-03-09 18:05:11,850 [ INFO] (DVRSmain.java:704) - setAddonData...
2015-03-09 18:05:11,865 [DEBUG] (DVRSmain.java:710) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-03-09 18:05:12,567 [ INFO] (DVRSmain.java:2998) - setAddonData execute time :717
2015-03-09 18:05:12,567 [ INFO] (DVRSmain.java:1265) - charge...
2015-03-09 18:05:12,567 [ INFO] (DVRSmain.java:628) - dataCount...
2015-03-09 18:05:12,600 [DEBUG] (DVRSmain.java:638) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.FILEID>= ? AND A.CHARGE is null 
2015-03-09 18:05:12,600 [ INFO] (DVRSmain.java:643) - usage count : 0
2015-03-09 18:05:12,615 [ INFO] (DVRSmain.java:664) - defaultRate...
2015-03-09 18:05:12,615 [ INFO] (DVRSmain.java:693) - defaultRate : 0.011 TWD 
2015-03-09 18:05:12,615 [ INFO] (DVRSmain.java:3003) - charge execute time :48
2015-03-09 18:05:12,615 [ INFO] (DVRSmain.java:1746) - sendAlertSMS...
2015-03-09 18:05:12,615 [DEBUG] (DVRSmain.java:1762) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-03-09 18:05:12,631 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 18:05:12,631 [ INFO] (DVRSmain.java:1770) - times:3,bracket:1.0,msg:2,suspend:1
2015-03-09 18:05:12,631 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 18:05:12,631 [ INFO] (DVRSmain.java:1770) - times:2,bracket:0.8,msg:1,suspend:0
2015-03-09 18:05:12,631 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 18:05:12,631 [ INFO] (DVRSmain.java:1770) - times:1,bracket:0.6,msg:1,suspend:0
2015-03-09 18:05:12,646 [DEBUG] (DVRSmain.java:1806) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-03-09 18:05:12,709 [DEBUG] (DVRSmain.java:1981) - Total send month alert0 ...
2015-03-09 18:05:12,709 [DEBUG] (DVRSmain.java:1982) - Log to table...executeBatch
2015-03-09 18:05:12,724 [ INFO] (DVRSmain.java:2258) - For 40705 send 1.5GB decrease speed  message !
2015-03-09 18:05:12,740 [ INFO] (Jatool.java:67) - get Properites!
2015-03-09 18:05:12,740 [ INFO] (Jatool.java:67) - Connect to Host : 106.186.120.118
2015-03-09 18:05:12,740 [ INFO] (Jatool.java:67) - port : null
2015-03-09 18:05:12,740 [ INFO] (Jatool.java:67) - use authority : true
2015-03-09 18:05:12,740 [DEBUG] (Jatool.java:69) - Creat mail Session!
2015-03-09 18:05:12,787 [DEBUG] (Jatool.java:69) - set mail content!
2015-03-09 18:05:17,999 [ INFO] (Jatool.java:67) - sending mail from HKNet@sim2travel.com to k1988242001@gmail.com,douglas.chuang@sim2travel.com,yvonne.lin@sim2travel.com
<br>Subject : Notification on FUP 75% 1.5GB
<br>Content : <html><body>¡iHKNet Oneness SIM¼Æ¾Ú¥Î¶q³qª¾¡j´L·qªºHKNet Oneness SIM¥Î¤á(89852660000005138929)±z¦n¡A±z¦b­»´äªº¼Æ¾Ú¥Î¶q¤w¹F1.5GB¡A«ö¥»¤½¥qFUP³W½d¼Æ¾Ú¥Î¶q¹F2GB®É±N·|¥H128kbps´£¨ÑªA°È¡A¦Ü¦¸¤ë°_«ì´_¥þ³t¡C·q½Ð¯d·N¡C·PÁÂ±z¨Ï¥ÎHKNet¡A¦p¦³ºÃ°Ý½ÐÁpµ¸ +852-37930860¡C<br><br>Dear HKNet Oneness SIM customer (89852660000005138929), please be informed that your HK mobile data usage has reached 1.5GB. After reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact  +852-37930860 if any queries.</body></html>
<br>SendDate: Mon Mar 09 18:05:12 CST 2015
2015-03-09 18:05:18,063 [DEBUG] (DVRSmain.java:2278) - execute SQL : INSERT INTO HUR_SMS_LOG(ID,SEND_NUMBER,MSG,SEND_DATE,RESULT,CREATE_DATE) VALUES(DVRS_SMS_ID.NEXTVAL,'k1988242001@gmail.com,douglas.chuang@sim2travel.com,yvonne.lin@sim2travel.com','?iHKNet Oneness SIM???????q?q???j?L¡Pq??HKNet Oneness SIM????(89852660000005138929)¡Óz?n?A¡Óz?b?????????????q?w?F1.5GB?A???????qFUP?W?d???????q?F2GB??¡ÓN¡P|?H128kbps?????A¢X??A??????¢X_???_???t?C¡Pq??¡Âd¡PN?C¡PP??¡Óz????HKNet?A?p????¢X????p?? +852-37930860?C<br><br>Dear HKNet Oneness SIM customer (89852660000005138929), please be informed that your HK mobile data usage has reached 1.5GB. After reaching 2GB monthly mobile data usage allowance, fair usage policy will be triggered for the remainder of this monthly service period with data access speed no less than 128kbps. Thank you for your attention and please contact  +852-37930860 if any queries.',TO_DATE('2015/03/09 18:05:17','yyyy/MM/dd HH24:mi:ss'),'success',SYSDATE)
2015-03-09 18:05:18,063 [DEBUG] (DVRSmain.java:2286) - Total send volume alert SMS 0 ...
2015-03-09 18:05:18,078 [ INFO] (DVRSmain.java:3008) - sendAlertSMS execute time :5463
2015-03-09 18:05:18,078 [ INFO] (DVRSmain.java:1640) - insertCurrentMap...
2015-03-09 18:05:18,078 [ INFO] (DVRSmain.java:1649) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-03-09 18:05:18,078 [ INFO] (DVRSmain.java:1687) - insertCurrentMapDay...
2015-03-09 18:05:18,078 [ INFO] (DVRSmain.java:1695) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-03-09 18:05:18,078 [ INFO] (DVRSmain.java:1545) - updateCurrentMap...
2015-03-09 18:05:18,078 [ INFO] (DVRSmain.java:1556) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-03-09 18:05:18,094 [ INFO] (DVRSmain.java:1584) - Execute updateCurrentMap Batch
2015-03-09 18:05:18,109 [ INFO] (DVRSmain.java:1590) - updateCurrentMapDay...
2015-03-09 18:05:18,109 [ INFO] (DVRSmain.java:1600) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-03-09 18:05:18,109 [ INFO] (DVRSmain.java:1627) - Execute updateCurrentMapU Batch
2015-03-09 18:05:18,141 [ INFO] (DVRSmain.java:3034) - insert¡®update execute time :63
2015-03-09 18:05:18,141 [ INFO] (DVRSmain.java:3039) - processSuspendNBR execute time :0
2015-03-09 18:05:18,141 [ INFO] (DVRSmain.java:3044) - Program execute time :159378
2015-03-09 18:05:18,141 [ INFO] (DVRSmain.java:1118) - closeConnect1...
2015-03-09 18:05:18,141 [ INFO] (DVRSmain.java:1135) - closeConnect2...
