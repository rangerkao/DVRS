2015-05-05 10:27:59,877 [ INFO] (DVRSmain.java:1187) - Logger Load Success!
2015-05-05 10:27:59,942 [ INFO] (DVRSmain.java:1205) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1.610612736E9
DEFAULT_VOLUME_THRESHOLD2 : 2.147483648E9
DEFAULT_PHONE : 886989235253
RUN_INTERVAL : 3600
HKNetReceiver : k1988242001@gmail.com
TEST_MODE : true
dataThreshold : 1500
exchangeRate : 4.0
kByte : 9.765625E-4

2015-05-05 10:28:00,599 [ INFO] (StdSchedulerFactory.java:1184) - Using default implementation for ThreadExecutor
2015-05-05 10:28:00,716 [ INFO] (SimpleThreadPool.java:268) - Job execution threads will use class loader of thread: main
2015-05-05 10:28:01,563 [ INFO] (SchedulerSignalerImpl.java:61) - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
2015-05-05 10:28:02,882 [ INFO] (QuartzScheduler.java:240) - Quartz Scheduler v.2.2.1 created.
2015-05-05 10:28:03,696 [ INFO] (RAMJobStore.java:155) - RAMJobStore initialized.
2015-05-05 10:28:03,697 [ INFO] (QuartzScheduler.java:305) - Scheduler meta-data: Quartz Scheduler (v2.2.1) 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

2015-05-05 10:28:03,697 [ INFO] (StdSchedulerFactory.java:1339) - Quartz scheduler 'DefaultQuartzScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
2015-05-05 10:28:03,697 [ INFO] (StdSchedulerFactory.java:1343) - Quartz scheduler version: 2.2.1
2015-05-05 10:28:03,882 [DEBUG] (UpdateChecker.java:54) - Checking for available updated version of Quartz...
2015-05-05 10:28:04,708 [ INFO] (QuartzScheduler.java:575) - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2015-05-05 10:28:05,842 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 1 triggers
2015-05-05 10:28:05,845 [DEBUG] (SimpleJobFactory.java:51) - Producing instance of Job 'group1.job1', class=program.DVRSmain
2015-05-05 10:28:05,846 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
2015-05-05 10:28:06,569 [DEBUG] (JobRunShell.java:201) - Calling execute on job group1.job1
2015-05-05 10:28:06,603 [ INFO] (DVRSmain.java:3253) - RFP Program Start! Tue May 05 10:28:06 CST 2015
2015-05-05 10:28:06,603 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-05-05 10:28:26,181 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-05-05 10:28:26,181 [ INFO] (DVRSmain.java:1257) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-05-05 10:28:26,181 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-05-05 10:28:26,398 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-05-05 10:28:26,398 [ INFO] (DVRSmain.java:1298) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-05-05 10:28:26,398 [DEBUG] (DVRSmain.java:3261) - connect success!
2015-05-05 10:28:26,398 [ INFO] (DVRSmain.java:1364) - cancelAutoCommit...
2015-05-05 10:28:26,398 [ INFO] (DVRSmain.java:1366) - set AutoCommit false!
2015-05-05 10:28:26,399 [ INFO] (DVRSmain.java:193) - setMonthDate...
2015-05-05 10:28:26,422 [ INFO] (DVRSmain.java:208) - execute time :23
2015-05-05 10:28:26,422 [ INFO] (DVRSmain.java:1031) - setIMSItoServiceIDMap...
2015-05-05 10:28:26,422 [ INFO] (DVRSmain.java:1060) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-05-05 10:28:32,563 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
2015-05-05 10:28:58,349 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
2015-05-05 10:29:24,568 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
2015-05-05 10:29:33,693 [ INFO] (DVRSmain.java:1085) - execute time :67271
2015-05-05 10:29:33,693 [ INFO] (DVRSmain.java:1090) - setServiceIDtoImsiMap...
2015-05-05 10:29:33,693 [ INFO] (DVRSmain.java:1119) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-05-05 10:29:48,028 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
2015-05-05 10:30:13,124 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
2015-05-05 10:30:21,649 [ INFO] (DVRSmain.java:1144) - execute time :47956
2015-05-05 10:30:21,649 [ INFO] (DVRSmain.java:560) - setThreshold...
2015-05-05 10:30:21,649 [DEBUG] (DVRSmain.java:572) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-05-05 10:30:21,786 [ INFO] (DVRSmain.java:597) - execute time :137
2015-05-05 10:30:21,786 [ INFO] (DVRSmain.java:485) - setDataRate...
2015-05-05 10:30:21,786 [DEBUG] (DVRSmain.java:498) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP,B.NETWORK,       to_Date(A.START_TIME,'yyyy/MM/dd') START_TIME,       Case when A.END_TIME is null then null else to_date(A.END_TIME,'yyyy/MM/dd') END END_TIME FROM HUR_DATA_RATE A,HUR_MCCMNC B where A.MCCMNC=B.MCCMNC
2015-05-05 10:30:23,790 [ INFO] (DVRSmain.java:550) - execute time :2004
2015-05-05 10:30:23,790 [ INFO] (DVRSmain.java:970) - setMsisdnMap...
2015-05-05 10:30:23,790 [ INFO] (DVRSmain.java:984) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-05-05 10:30:37,055 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
2015-05-05 10:30:54,765 [ INFO] (DVRSmain.java:1018) - execute time :30975
2015-05-05 10:30:54,765 [ INFO] (DVRSmain.java:917) - setIPtoMccmncList...
2015-05-05 10:30:54,765 [DEBUG] (DVRSmain.java:929) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-05-05 10:30:54,822 [ INFO] (DVRSmain.java:959) - execute time :57
2015-05-05 10:30:54,822 [ INFO] (DVRSmain.java:606) - setSERVICEIDtoVLN...
2015-05-05 10:30:54,822 [DEBUG] (DVRSmain.java:619) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-05-05 10:31:03,896 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
2015-05-05 10:31:09,241 [ INFO] (DVRSmain.java:644) - execute time :14419
2015-05-05 10:31:09,241 [ INFO] (DVRSmain.java:657) - setVLNtoTADIG...
2015-05-05 10:31:09,241 [DEBUG] (DVRSmain.java:669) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-05-05 10:31:11,269 [ INFO] (DVRSmain.java:695) - execute time :2028
2015-05-05 10:31:11,269 [ INFO] (DVRSmain.java:706) - setTADIGtoMCCMNC...
2015-05-05 10:31:11,270 [DEBUG] (DVRSmain.java:718) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-05-05 10:31:11,607 [ INFO] (DVRSmain.java:743) - execute time :337
2015-05-05 10:31:11,607 [ INFO] (DVRSmain.java:755) - setCostomerNumber...
2015-05-05 10:31:11,607 [DEBUG] (DVRSmain.java:767) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-05-05 10:31:11,663 [ INFO] (DVRSmain.java:795) - execute time :56
2015-05-05 10:31:11,663 [ INFO] (DVRSmain.java:866) - setAddonData...
2015-05-05 10:31:11,663 [DEBUG] (DVRSmain.java:877) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-05-05 10:31:12,418 [ INFO] (DVRSmain.java:908) - execute time :755
2015-05-05 10:31:12,418 [ INFO] (DVRSmain.java:292) - setCurrentMap...
2015-05-05 10:31:12,418 [DEBUG] (DVRSmain.java:307) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201505','201504') 
2015-05-05 10:31:12,955 [ INFO] (DVRSmain.java:362) - execute time :537
2015-05-05 10:31:12,955 [ INFO] (DVRSmain.java:370) - setoldChargeMap...
2015-05-05 10:31:12,955 [ INFO] (DVRSmain.java:378) - execute time :0
2015-05-05 10:31:12,955 [ INFO] (DVRSmain.java:392) - setCurrentMapDay...
2015-05-05 10:31:12,955 [DEBUG] (DVRSmain.java:405) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201505','201504') 
2015-05-05 10:31:14,544 [ INFO] (DVRSmain.java:474) - execute time :1589
2015-05-05 10:31:14,545 [ INFO] (DVRSmain.java:1476) - charge...
2015-05-05 10:31:14,545 [ INFO] (DVRSmain.java:804) - dataCount...
2015-05-05 10:31:14,579 [DEBUG] (DVRSmain.java:816) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.CHARGE is null 
2015-05-05 10:31:14,630 [ INFO] (DVRSmain.java:823) - usage count : 0
2015-05-05 10:31:14,636 [ INFO] (DVRSmain.java:842) - execute time :91
2015-05-05 10:31:14,636 [ INFO] (DVRSmain.java:851) - defaultRate...
2015-05-05 10:31:14,636 [ INFO] (DVRSmain.java:855) - defaultRate : 0.011 TWD 
2015-05-05 10:31:14,636 [ INFO] (DVRSmain.java:856) - execute time :0
2015-05-05 10:31:14,636 [ INFO] (DVRSmain.java:217) - setQosData...
2015-05-05 10:31:14,637 [ INFO] (DVRSmain.java:229) - execute time :0
2015-05-05 10:31:14,637 [ INFO] (DVRSmain.java:1799) - execute time :92
2015-05-05 10:31:14,637 [ INFO] (DVRSmain.java:2167) - sendAlertSMS...
2015-05-05 10:31:14,642 [DEBUG] (DVRSmain.java:2187) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-05-05 10:31:14,663 [ INFO] (DVRSmain.java:2195) - times:3,bracket:1.0,msg:2,suspend:1
2015-05-05 10:31:14,663 [ INFO] (DVRSmain.java:2195) - times:3,bracket:1.0,msg:2,suspend:1
2015-05-05 10:31:14,664 [ INFO] (DVRSmain.java:2195) - times:2,bracket:0.8,msg:1,suspend:0
2015-05-05 10:31:14,665 [ INFO] (DVRSmain.java:2195) - times:2,bracket:0.8,msg:1,suspend:0
2015-05-05 10:31:14,665 [ INFO] (DVRSmain.java:2195) - times:1,bracket:0.6,msg:1,suspend:0
2015-05-05 10:31:14,665 [ INFO] (DVRSmain.java:2195) - times:1,bracket:0.6,msg:1,suspend:0
2015-05-05 10:31:14,684 [DEBUG] (DVRSmain.java:2234) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-05-05 10:31:14,755 [DEBUG] (DVRSmain.java:2730) - Total send volume alert SMS 0 ...
2015-05-05 10:31:14,762 [ INFO] (DVRSmain.java:2766) - execute time :125
2015-05-05 10:31:14,762 [ INFO] (DVRSmain.java:1806) - updateCdr...
2015-05-05 10:31:14,776 [ INFO] (DVRSmain.java:1851) - execute time :14
2015-05-05 10:31:14,776 [ INFO] (DVRSmain.java:2016) - insertCurrentMap...
2015-05-05 10:31:14,776 [ INFO] (DVRSmain.java:2026) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-05-05 10:31:14,788 [ INFO] (DVRSmain.java:2081) - execute time :12
2015-05-05 10:31:14,789 [ INFO] (DVRSmain.java:2086) - insertCurrentMapDay...
2015-05-05 10:31:14,789 [ INFO] (DVRSmain.java:2096) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-05-05 10:31:14,801 [ INFO] (DVRSmain.java:2155) - execute time :12
2015-05-05 10:31:14,802 [ INFO] (DVRSmain.java:1860) - updateCurrentMap...
2015-05-05 10:31:14,802 [ INFO] (DVRSmain.java:1871) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-05-05 10:31:14,813 [ INFO] (DVRSmain.java:1943) - execute time :11
2015-05-05 10:31:14,813 [ INFO] (DVRSmain.java:1947) - updateCurrentMapDay...
2015-05-05 10:31:14,813 [ INFO] (DVRSmain.java:1957) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-05-05 10:31:14,846 [ INFO] (DVRSmain.java:2006) - execute time :33
2015-05-05 10:31:14,846 [ INFO] (DVRSmain.java:3323) - Program execute time :168448
2015-05-05 10:31:14,846 [ INFO] (DVRSmain.java:1328) - closeConnect1...
2015-05-05 10:31:14,847 [ INFO] (DVRSmain.java:1345) - closeConnect2...
2015-05-05 10:31:33,407 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
2015-05-05 10:34:49,517 [ INFO] (DVRSmain.java:1187) - Logger Load Success!
2015-05-05 10:34:49,518 [ INFO] (DVRSmain.java:1205) - DEFAULT_MCCMNC : default
DEFAULT_THRESHOLD : 5000.0
DEFAULT_DAY_THRESHOLD : 500.0
DEFAULT_DAYCAP : 300.0
DEFAULT_VOLUME_THRESHOLD : 1.610612736E9
DEFAULT_VOLUME_THRESHOLD2 : 2.147483648E9
DEFAULT_PHONE : 886989235253
RUN_INTERVAL : 3600
HKNetReceiver : k1988242001@gmail.com
TEST_MODE : true
dataThreshold : 1500
exchangeRate : 4.0
kByte : 9.765625E-4

2015-05-05 10:34:49,552 [ INFO] (StdSchedulerFactory.java:1184) - Using default implementation for ThreadExecutor
2015-05-05 10:34:49,556 [ INFO] (SimpleThreadPool.java:268) - Job execution threads will use class loader of thread: main
2015-05-05 10:34:49,601 [ INFO] (SchedulerSignalerImpl.java:61) - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
2015-05-05 10:34:49,601 [ INFO] (QuartzScheduler.java:240) - Quartz Scheduler v.2.2.1 created.
2015-05-05 10:34:49,601 [ INFO] (RAMJobStore.java:155) - RAMJobStore initialized.
2015-05-05 10:34:49,601 [ INFO] (QuartzScheduler.java:305) - Scheduler meta-data: Quartz Scheduler (v2.2.1) 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

2015-05-05 10:34:49,601 [ INFO] (StdSchedulerFactory.java:1339) - Quartz scheduler 'DefaultQuartzScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
2015-05-05 10:34:49,601 [ INFO] (StdSchedulerFactory.java:1343) - Quartz scheduler version: 2.2.1
2015-05-05 10:34:49,608 [ INFO] (QuartzScheduler.java:575) - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2015-05-05 10:34:49,609 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 1 triggers
2015-05-05 10:34:49,612 [DEBUG] (SimpleJobFactory.java:51) - Producing instance of Job 'group1.job1', class=program.DVRSmain
2015-05-05 10:34:49,614 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
2015-05-05 10:34:49,615 [DEBUG] (JobRunShell.java:201) - Calling execute on job group1.job1
2015-05-05 10:34:49,617 [ INFO] (DVRSmain.java:3253) - RFP Program Start! Tue May 05 10:34:49 CST 2015
2015-05-05 10:34:49,619 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-05-05 10:34:50,136 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-05-05 10:34:50,136 [ INFO] (DVRSmain.java:1257) - Connect to jdbc:oracle:thin:@10.42.1.101:1521:S2TBSDEV  
2015-05-05 10:34:50,136 [DEBUG] (Jatool.java:69) - Start to connect DB 
2015-05-05 10:34:50,336 [DEBUG] (Jatool.java:69) - Finished to connect DB 
2015-05-05 10:34:50,336 [ INFO] (DVRSmain.java:1298) - Connrct to jdbc:oracle:thin:@10.42.1.10:1521:orcl
2015-05-05 10:34:50,336 [DEBUG] (DVRSmain.java:3261) - connect success!
2015-05-05 10:34:50,336 [ INFO] (DVRSmain.java:1364) - cancelAutoCommit...
2015-05-05 10:34:50,336 [ INFO] (DVRSmain.java:1366) - set AutoCommit false!
2015-05-05 10:34:50,337 [ INFO] (DVRSmain.java:193) - setMonthDate...
2015-05-05 10:34:50,337 [ INFO] (DVRSmain.java:208) - execute time :0
2015-05-05 10:34:50,337 [ INFO] (DVRSmain.java:1031) - setIMSItoServiceIDMap...
2015-05-05 10:34:50,337 [ INFO] (DVRSmain.java:1060) - Execute SQL :SELECT A.SERVICEID,A.IMSI		FROM(			SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE			FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B		    WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713		    UNION		    SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE		    FROM SERVICEORDER A,NEWSERVICEORDERINFO B		    WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A,		    	(SELECT IMSI,MAX(COMPLETEDATE) COMPLETEDATE				from(SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE             		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B                     WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713                     UNION                     SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE                     FROM SERVICEORDER A,NEWSERVICEORDERINFO B                     WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713)                     GROUP BY IMSI )B		WHERE A.IMSI=B.IMSI AND A.COMPLETEDATE =B.COMPLETEDATE
2015-05-05 10:34:50,601 [DEBUG] (UpdateChecker.java:54) - Checking for available updated version of Quartz...
2015-05-05 10:35:14,396 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
2015-05-05 10:35:42,028 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
2015-05-05 10:35:54,910 [ INFO] (DVRSmain.java:1085) - execute time :64573
2015-05-05 10:35:54,910 [ INFO] (DVRSmain.java:1090) - setServiceIDtoImsiMap...
2015-05-05 10:35:54,910 [ INFO] (DVRSmain.java:1119) - Execute SQL : SELECT A.SERVICEID,A.IMSI FROM( 		SELECT A.SERVICEID,B.NEWVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 		WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 		UNION 		SELECT A.SERVICEID,B.FIELDVALUE IMSI,A.COMPLETEDATE 		FROM SERVICEORDER A,NEWSERVICEORDERINFO B 		WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713 )A, 		(	SELECT SERVICEID,MAX(COMPLETEDATE) COMPLETEDATE 			from(	SELECT A.SERVICEID,B.NEWVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,SERVICEINFOCHANGEORDER B 					WHERE A.ORDERID =B.ORDERID AND  B.FIELDID=3713 					UNION 					SELECT A.SERVICEID,B.FIELDVALUE,A.COMPLETEDATE 					FROM SERVICEORDER A,NEWSERVICEORDERINFO B 					WHERE A.ORDERID =B.ORDERID AND   B.FIELDID=3713) 			GROUP BY SERVICEID )B 		WHERE A.SERVICEID=B.SERVICEID AND A.COMPLETEDATE =B.COMPLETEDATE 
2015-05-05 10:36:07,627 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
2015-05-05 10:36:32,825 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
2015-05-05 10:36:52,727 [ INFO] (DVRSmain.java:1144) - execute time :57817
2015-05-05 10:36:52,737 [ INFO] (DVRSmain.java:560) - setThreshold...
2015-05-05 10:36:52,737 [DEBUG] (DVRSmain.java:572) - Execute SQL : SELECT A.SERVICEID,A.THRESHOLD FROM HUR_GPRS_THRESHOLD A 
2015-05-05 10:36:52,875 [ INFO] (DVRSmain.java:597) - execute time :138
2015-05-05 10:36:52,875 [ INFO] (DVRSmain.java:485) - setDataRate...
2015-05-05 10:36:52,875 [DEBUG] (DVRSmain.java:498) - Execute SQL : SELECT A.MCCMNC,A.RATE,A.CHARGEUNIT,A.CURRENCY,A.PRICEPLANID,A.DAYCAP,B.NETWORK,       to_Date(A.START_TIME,'yyyy/MM/dd') START_TIME,       Case when A.END_TIME is null then null else to_date(A.END_TIME,'yyyy/MM/dd') END END_TIME FROM HUR_DATA_RATE A,HUR_MCCMNC B where A.MCCMNC=B.MCCMNC
2015-05-05 10:36:54,814 [ INFO] (DVRSmain.java:550) - execute time :1939
2015-05-05 10:36:54,814 [ INFO] (DVRSmain.java:970) - setMsisdnMap...
2015-05-05 10:36:54,814 [ INFO] (DVRSmain.java:984) - Execute SQL :SELECT B.IMSI,A.SERVICECODE,A.PRICEPLANID,A.SUBSIDIARYID,A.SERVICEID,B.ICCID, (CASE A. STATUS WHEN '1' then to_char(C.value) when '3' then to_char( C.value) when '10' then to_char(C.value) else null end) NCODE FROM SERVICE A,IMSI B,PARAMETERVALUE C WHERE A.SERVICEID=B.SERVICEID AND A.SERVICECODE IS NOT NULL AND B.SERVICEID=C.SERVICEID(+) AND C.PARAMETERVALUEID(+)=3748
2015-05-05 10:36:59,669 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
2015-05-05 10:37:19,804 [ INFO] (DVRSmain.java:1018) - execute time :24990
2015-05-05 10:37:19,804 [ INFO] (DVRSmain.java:917) - setIPtoMccmncList...
2015-05-05 10:37:19,804 [DEBUG] (DVRSmain.java:929) - Query AddonData SQL : SELECT A.START_NUM,A.END_NUM,A.MCCMNC FROM HUR_IP_RANGE A ORDER BY A.START_NUM 
2015-05-05 10:37:19,870 [ INFO] (DVRSmain.java:959) - execute time :66
2015-05-05 10:37:19,870 [ INFO] (DVRSmain.java:606) - setSERVICEIDtoVLN...
2015-05-05 10:37:19,870 [DEBUG] (DVRSmain.java:619) - Execute SQL : SELECT A.VLR_NUMBER,A.SERVICEID FROM UTCN.BASICPROFILE A WHERE A.VLR_NUMBER is not null 
2015-05-05 10:37:22,738 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
2015-05-05 10:37:33,560 [ INFO] (DVRSmain.java:644) - execute time :13690
2015-05-05 10:37:33,560 [ INFO] (DVRSmain.java:657) - setVLNtoTADIG...
2015-05-05 10:37:33,561 [DEBUG] (DVRSmain.java:669) - Execute SQL : SELECT B.REALMNAME TADIG, A.CHARGEAREACODE VLR FROM CHARGEAREACONFIG A, REALM B WHERE A.AREAREFERENCE=B.AREAREFERENCE
2015-05-05 10:37:35,506 [ INFO] (DVRSmain.java:695) - execute time :1946
2015-05-05 10:37:35,506 [ INFO] (DVRSmain.java:706) - setTADIGtoMCCMNC...
2015-05-05 10:37:35,506 [DEBUG] (DVRSmain.java:718) - Execute SQL : SELECT A.TADIG,A.MCCMNC FROM HUR_MCCMNC A 
2015-05-05 10:37:35,838 [ INFO] (DVRSmain.java:743) - execute time :332
2015-05-05 10:37:35,839 [ INFO] (DVRSmain.java:755) - setCostomerNumber...
2015-05-05 10:37:35,839 [DEBUG] (DVRSmain.java:767) - Execute SQL : SELECT A.CODE,A.PHONE,A.NAME FROM HUR_CUSTOMER_SERVICE_PHONE A
2015-05-05 10:37:35,887 [ INFO] (DVRSmain.java:795) - execute time :48
2015-05-05 10:37:35,887 [ INFO] (DVRSmain.java:866) - setAddonData...
2015-05-05 10:37:35,887 [DEBUG] (DVRSmain.java:877) - Execute SQL : SELECT A.S2TIMSI IMSI,A.S2TMSISDN MSISDN,A.SERVICECODE,A.STARTDATE,A.ENDDATE FROM ADDONSERVICE_N A 
2015-05-05 10:37:36,640 [ INFO] (DVRSmain.java:908) - execute time :753
2015-05-05 10:37:36,640 [ INFO] (DVRSmain.java:292) - setCurrentMap...
2015-05-05 10:37:36,640 [DEBUG] (DVRSmain.java:307) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.SMS_TIMES,A.LAST_DATA_TIME,A.VOLUME,A.MONTH,A.EVER_SUSPEND,A.LAST_ALERN_THRESHOLD,A.LAST_ALERN_VOLUME FROM HUR_CURRENT A WHERE A.MONTH IN ('201505','201504') 
2015-05-05 10:37:37,122 [ INFO] (DVRSmain.java:362) - execute time :482
2015-05-05 10:37:37,122 [ INFO] (DVRSmain.java:370) - setoldChargeMap...
2015-05-05 10:37:37,122 [ INFO] (DVRSmain.java:378) - execute time :0
2015-05-05 10:37:37,122 [ INFO] (DVRSmain.java:392) - setCurrentMapDay...
2015-05-05 10:37:37,123 [DEBUG] (DVRSmain.java:405) - Execute SQL : SELECT A.SERVICEID,A.CHARGE,A.LAST_FILEID,A.LAST_DATA_TIME,A.VOLUME,A.UPDATE_DATE,A.CREATE_DATE,A.MCCMNC,A.DAY,A.ALERT FROM HUR_CURRENT_DAY A WHERE SUBSTR(A.DAY,0,6) IN ('201505','201504') 
2015-05-05 10:37:37,724 [ INFO] (DVRSmain.java:474) - execute time :601
2015-05-05 10:37:37,725 [ INFO] (DVRSmain.java:1476) - charge...
2015-05-05 10:37:37,735 [ INFO] (DVRSmain.java:804) - dataCount...
2015-05-05 10:37:37,751 [DEBUG] (DVRSmain.java:816) - Execute SQL : SELECT COUNT(1) count  FROM HUR_DATA_USAGE A WHERE A.CHARGE is null 
2015-05-05 10:37:37,784 [ INFO] (DVRSmain.java:823) - usage count : 4
2015-05-05 10:37:37,792 [ INFO] (DVRSmain.java:842) - execute time :57
2015-05-05 10:37:37,792 [ INFO] (DVRSmain.java:851) - defaultRate...
2015-05-05 10:37:37,792 [ INFO] (DVRSmain.java:855) - defaultRate : 0.011 TWD 
2015-05-05 10:37:37,792 [ INFO] (DVRSmain.java:856) - execute time :0
2015-05-05 10:37:37,792 [ INFO] (DVRSmain.java:217) - setQosData...
2015-05-05 10:37:37,792 [ INFO] (DVRSmain.java:229) - execute time :0
2015-05-05 10:37:37,793 [DEBUG] (DVRSmain.java:1508) - Execute SQL : SELECT USAGEID,IMSI,MCCMNC,DATAVOLUME,FILEID,CALLTIME,SGSNADDRESS FROM ( SELECT USAGEID,IMSI,MCCMNC,DATAVOLUME,FILEID,to_date(CALLTIME,'yyyy/MM/dd hh24:mi:ss') CALLTIME,SGSNADDRESS FROM HUR_DATA_USAGE A WHERE ROWNUM <= 1500 AND A.CHARGE is null ORDER BY A.USAGEID,A.FILEID) MINUS SELECT USAGEID,IMSI,MCCMNC,DATAVOLUME,FILEID,CALLTIME,SGSNADDRESS FROM ( SELECT USAGEID,IMSI,MCCMNC,DATAVOLUME,FILEID,to_date(CALLTIME,'yyyy/MM/dd hh24:mi:ss') CALLTIME,SGSNADDRESS FROM HUR_DATA_USAGE A WHERE ROWNUM <= 0 AND A.CHARGE is null ORDER BY A.USAGEID,A.FILEID) 
2015-05-05 10:37:37,793 [DEBUG] (DVRSmain.java:1510) - Round 1 Procsess ...
2015-05-05 10:37:37,873 [DEBUG] (DVRSmain.java:1779) - UsageId 19454542 ,IMSI 454120260245973 ,MCCMNC 302022 charge result is 39064.0. The old Daily charge is 39704.0. The final Daily charge is 78768.0. The old month charge is 460.02. The final month charge is 39524.02. 
2015-05-05 10:37:37,873 [ERROR] (DVRSmain.java:1626) - usageId:19454548,IMSI:454120200107706 can't charge correctly without mccmnc or mccmnc is not in Data_Rate table ! 
2015-05-05 10:37:37,873 [ERROR] (DVRSmain.java:2956) - Can't send email without receiver!
2015-05-05 10:37:37,895 [DEBUG] (DVRSmain.java:1779) - UsageId 19454548 ,IMSI 454120200107706 ,MCCMNC 310026 charge result is 8.855. The final Daily charge is 8.855. The old month charge is 121.869. The final month charge is 130.724. 
2015-05-05 10:37:37,895 [ERROR] (DVRSmain.java:1626) - usageId:19457694,IMSI:454120200107706 can't charge correctly without mccmnc or mccmnc is not in Data_Rate table ! 
2015-05-05 10:37:37,895 [ERROR] (DVRSmain.java:2956) - Can't send email without receiver!
2015-05-05 10:37:37,895 [DEBUG] (DVRSmain.java:1779) - UsageId 19457694 ,IMSI 454120200107706 ,MCCMNC 310026 charge result is 0.077. The old Daily charge is 8.855. The final Daily charge is 8.932. The old month charge is 130.724. The final month charge is 130.801. 
2015-05-05 10:37:37,895 [ERROR] (DVRSmain.java:1626) - usageId:19459143,IMSI:454120200107706 can't charge correctly without mccmnc or mccmnc is not in Data_Rate table ! 
2015-05-05 10:37:37,895 [ERROR] (DVRSmain.java:2956) - Can't send email without receiver!
2015-05-05 10:37:37,895 [DEBUG] (DVRSmain.java:1779) - UsageId 19459143 ,IMSI 454120200107706 ,MCCMNC 310026 charge result is 0.187. The old Daily charge is 8.932. The final Daily charge is 9.119. The old month charge is 130.801. The final month charge is 130.988. 
2015-05-05 10:37:37,928 [ INFO] (DVRSmain.java:1799) - execute time :203
2015-05-05 10:37:37,928 [ INFO] (DVRSmain.java:2167) - sendAlertSMS...
2015-05-05 10:37:37,928 [DEBUG] (DVRSmain.java:2187) - Execute SQL:SELECT A.ID,A.BRACKET,A.MEGID,A.SUSPEND FROM HUR_SMS_SETTING A ORDER BY ID DESC
2015-05-05 10:37:37,948 [ INFO] (DVRSmain.java:2195) - times:3,bracket:1.0,msg:2,suspend:1
2015-05-05 10:37:37,948 [ INFO] (DVRSmain.java:2195) - times:3,bracket:1.0,msg:2,suspend:1
2015-05-05 10:37:37,948 [ INFO] (DVRSmain.java:2195) - times:2,bracket:0.8,msg:1,suspend:0
2015-05-05 10:37:37,948 [ INFO] (DVRSmain.java:2195) - times:2,bracket:0.8,msg:1,suspend:0
2015-05-05 10:37:37,948 [ INFO] (DVRSmain.java:2195) - times:1,bracket:0.6,msg:1,suspend:0
2015-05-05 10:37:37,948 [ INFO] (DVRSmain.java:2195) - times:1,bracket:0.6,msg:1,suspend:0
2015-05-05 10:37:37,954 [DEBUG] (DVRSmain.java:2234) - Execute SQL:SELECT A.ID,A.CONTENT,A.CHARSET FROM HUR_SMS_CONTENT A 
2015-05-05 10:37:38,029 [DEBUG] (DVRSmain.java:2730) - Total send volume alert SMS 0 ...
2015-05-05 10:37:38,030 [ INFO] (DVRSmain.java:2766) - execute time :102
2015-05-05 10:37:38,030 [ INFO] (DVRSmain.java:1806) - updateCdr...
2015-05-05 10:37:38,069 [ INFO] (DVRSmain.java:1851) - execute time :39
2015-05-05 10:37:38,069 [ INFO] (DVRSmain.java:2016) - insertCurrentMap...
2015-05-05 10:37:38,069 [ INFO] (DVRSmain.java:2026) - Execute SQL :INSERT INTO HUR_CURRENT (SERVICEID,MONTH,CREATE_DATE) VALUES(?,?,SYSDATE)
2015-05-05 10:37:38,082 [ INFO] (DVRSmain.java:2081) - execute time :13
2015-05-05 10:37:38,082 [ INFO] (DVRSmain.java:2086) - insertCurrentMapDay...
2015-05-05 10:37:38,082 [ INFO] (DVRSmain.java:2096) - Execute SQL :INSERT INTO HUR_CURRENT_DAY (SERVICEID,CREATE_DATE,MCCMNC,DAY) VALUES(?,SYSDATE,?,?)
2015-05-05 10:37:38,095 [ INFO] (DVRSmain.java:2155) - execute time :13
2015-05-05 10:37:38,095 [ INFO] (DVRSmain.java:1860) - updateCurrentMap...
2015-05-05 10:37:38,095 [ INFO] (DVRSmain.java:1871) - Execute SQL :UPDATE HUR_CURRENT A SET A.CHARGE=?,A.LAST_FILEID=?,A.SMS_TIMES=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.EVER_SUSPEND=?,A.LAST_ALERN_THRESHOLD=?,A.LAST_ALERN_VOLUME=?,A.UPDATE_DATE=SYSDATE WHERE A.MONTH=? AND A.SERVICEID=? 
2015-05-05 10:37:38,101 [ INFO] (DVRSmain.java:1922) - Execute updateCurrentMap Batch
2015-05-05 10:37:38,118 [ INFO] (DVRSmain.java:1943) - execute time :23
2015-05-05 10:37:38,118 [ INFO] (DVRSmain.java:1947) - updateCurrentMapDay...
2015-05-05 10:37:38,118 [ INFO] (DVRSmain.java:1957) - Execute SQL :UPDATE HUR_CURRENT_DAY A SET A.CHARGE=?,A.LAST_FILEID=?,A.LAST_DATA_TIME=TO_DATE(?,'yyyy/MM/dd hh24:mi:ss'),A.VOLUME=?,A.ALERT=?,A.UPDATE_DATE=SYSDATE WHERE A.DAY=? AND A.SERVICEID=? AND A.MCCMNC=? 
2015-05-05 10:37:38,126 [ INFO] (DVRSmain.java:1986) - Execute updateCurrentMapU Batch
2015-05-05 10:37:38,144 [ INFO] (DVRSmain.java:2006) - execute time :26
2015-05-05 10:37:38,181 [ INFO] (DVRSmain.java:3323) - Program execute time :167845
2015-05-05 10:37:38,181 [ INFO] (DVRSmain.java:1328) - closeConnect1...
2015-05-05 10:37:38,192 [ INFO] (DVRSmain.java:1345) - closeConnect2...
2015-05-05 10:37:46,728 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
2015-05-05 10:38:11,584 [DEBUG] (QuartzSchedulerThread.java:276) - batch acquisition of 0 triggers
